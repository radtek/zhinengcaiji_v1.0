<?xml version="1.0" encoding="utf-8" ?>
<config>
	<include>
       <property name="mapping">mapping.xml</property>
       <property name="loop">false</property>
    </include>
	<!-- 100: db 200:file(200:local file , 201: ftp file) 300:socket 400:others -->
			<ds id="1" type="100">
		<property name="url">jdbc:oracle:thin:@132.228.39.91:1521:noap1</property>
		<property name="driver">oracle.jdbc.driver.OracleDriver</property>
		<property name="username">noap</property>
		<property name="password">uwaysoft2009</property>
	</ds>

	<!-- to 与  resolve 是一对多关系, package为可选标签 -->


	<to id="1">
		<resolve dsid="1">		
			<!--场景do省接口-->
    <mapping name="${province_en}_PERF_SCENE_DO_%%Y%%M%%D.csv" templet="场景上报DO省接口_三期.ftl"   >  
				<sql>
select SCENE_LEVEL as "场景级别",to_char(START_TIME,'YYYY-MM-DD HH24:MI:SS') as "数据时间点", GROUP_NAME as "场景名称", '${province_cn}' as "省份",CITY_NAME as "城市", Round( PC1 ,4) "MD1.6", Round( (decode( PC3 ,0,1, PC2  /  PC3 ))  *  100 ,4) "MD1.10", Round( PC4 ,4) "MD1.11", Round( (decode( PC6 ,0,1, PC5  /  PC6 ))  *  100 ,4) "MD2.1", Round( (decode( PC8 ,0,1, PC7  /  PC8 ))  *  100 ,4) "MD2.2", Round( (decode( PC10 ,0,1, PC9  /  PC10 ))  *  100 ,4) "MD2.3", Round( PC11 ,4) "MD2.4", Round( PC12 ,4) "MD2.5", Round( PC13 ,4) "MD2.6", Round( PC14 ,4) "MD2.7", Round( (decode( PC16 ,0,1, PC15  /  PC16 ))  *  100 ,4) "MD2.8", Round( PC17 ,4) "MD2.9", Round( PC18 ,4) "MD2.10", Round( PC19 ,4) "MD2.13", Round( PC20 ,4) "MD2.14", Round( PC21 ,4) "MD2.15", Round( PC22 ,4) "MD2.16", Round( PC23 ,4) "MD2.17", Round( PC24 ,4) "MD2.18", Round( PC25 ,4) "MD2.19", Round( PC26 ,4) "MD2.20", Round( PC27 ,4) "MD2.21", Round( (decode( PC29 ,0,1, PC28  /  PC29 ))  *  100 ,4) "MD2.22", Round( (decode( PC31 ,0,1, PC30  /  PC31 ))  *  100 ,4) "MD2.23", Round( PC32 ,4) "MD2.26", Round( PC33 ,4) "MD2.27", Round( PC34 ,4) "MD2.28", Round( (decode( PC36 ,0,1, PC35  /  PC36 ))  *  100 ,4) "MD3.1", Round( PC37 ,4) "MD3.2", Round( PC38 ,4) "MD3.3", Round( PC39 ,4) "MD3.4", Round( PC40 ,4) "MD5.1", Round( PC41 ,4) "MD5.2", Round( PC42 ,4) "MD5.3", Round( PC43 ,4) "MD5.4", Round( (decode( PC45 ,0,1, PC44  /  PC45 ))  *  100 ,4) "MD5.5", Round( PC46 ,4) "MD6.9", Round( (decode( PC48 ,0,1, PC47  /  PC48 ))  *  100 ,4) "MD6.10", Round( PC49 ,4) "MD6.11", Round( (decode( PC51 ,0,1, PC50  /  PC51 ))  *  100 ,4) "MD6.12", Round( PC52 ,4) "MD6.13", Round( PC53 ,4) "MD6.14", Round( PC54 ,4) "MD6.15", Round( PC55 ,4) "MD6.16", Round( (decode( PC57 ,0,1, PC56  /  PC57 ))  *  100 ,4) "MD6.17", Round( (decode( PC59 ,0,1, PC58  /  PC59 ))  *  100 ,4) "MD6.18", Round( (decode( PC61 ,0,1, PC60  /  PC61 ))  *  100 ,4) "MD6.19", Round( (decode( PC63 ,0,1, PC62  /  PC63 ))  *  100 ,4) "MD7.4", Round( PC64 ,4) "MD7.5", Round( PC65 ,4) "MD7.6", Round( (decode( PC67 ,0,1, PC66  /  PC67 ))  *  100 ,4) "MD7.7", Round( PC68 ,4) "MD7.8", Round( PC69 ,4) "MD7.9", Round( (decode( PC71 ,0,1, PC70  /  PC71 ))  *  100 ,4) "MD7.10", Round( PC72 ,4) "MD7.11", Round( PC73 ,4) "MD7.12", Round( (decode( PC75 ,0,1, PC74  /  PC75 ))  *  100 ,4) "MD7.13", Round( PC76 ,4) "MD7.14", Round( PC77 ,4) "MD7.15", 
Round( PC78 ,4) "MD9.1", Round( PC79 ,4) "MD9.2", Round( PC80 ,4) "MD9.3", Round( PC81 ,4) "MD9.4",
Round( PC82 ,4) "MD9.5", Round( PC83 ,4) "MD9.6", Round( PC84 ,4) "MD9.7",
Round( PC85 ,4) "MD9.8", Round( PC86 ,4) "MD9.9", Round( PC87 ,4) "MD9.10", Round( PC88 ,4) "MD9.11", 
Round( PC89 ,4) "MD10.4", Round( PC90 ,4) "MD10.5", Round( PC91 ,4) "MD10.6", Round( PC92 ,4) "MD10.7", Round( PC93 ,4) "MD10.10", Round( PC94 ,4) "MD10.11", Round( PC95 ,4) "MD10.12", Round( PC96 ,4) "MD10.13", Round( PC97 ,4) "MD10.14", Round( PC98 ,4) "MD10.15", Round( PC99 ,4) "MD10.16", Round( PC100 ,4) "MD10.17", Round( PC101 ,4) "MD11.1", Round( PC102 ,4) "MD11.2", Round( PC103 ,4) "MD11.3", Round( PC104 ,4) "MD11.4", Round( PC105 ,4) "MD11.5"
from ( 
  select '城市' as SCENE_LEVEL,START_TIME, GROUP_NAME, CITY_NAME, SUM(PC1) "PC1", SUM(PC2) "PC2", SUM(PC3) "PC3", SUM(PC4) "PC4", SUM(PC5) "PC5", SUM(PC6) "PC6", SUM(PC7) "PC7", SUM(PC8) "PC8", SUM(PC9) "PC9", SUM(PC10) "PC10", SUM(PC11) "PC11", SUM(PC12) "PC12", SUM(PC13) "PC13", SUM(PC14) "PC14", SUM(PC15) "PC15", SUM(PC16) "PC16", SUM(PC17) "PC17", SUM(PC18) "PC18", SUM(PC19) "PC19", SUM(PC20) "PC20", SUM(PC21) "PC21", SUM(PC22) "PC22", SUM(PC23) "PC23", SUM(PC24) "PC24", SUM(PC25) "PC25", SUM(PC26) "PC26", SUM(PC27) "PC27", SUM(PC28) "PC28", SUM(PC29) "PC29", SUM(PC30) "PC30", SUM(PC31) "PC31", SUM(PC32) "PC32", SUM(PC33) "PC33", SUM(PC34) "PC34", SUM(PC35) "PC35", SUM(PC36) "PC36", SUM(PC37) "PC37", SUM(PC38) "PC38", SUM(PC39) "PC39", SUM(PC40) "PC40", SUM(PC41) "PC41", SUM(PC42) "PC42", SUM(PC43) "PC43", SUM(PC44) "PC44", SUM(PC45) "PC45", SUM(PC46) "PC46", SUM(PC47) "PC47", SUM(PC48) "PC48", SUM(PC49) "PC49", SUM(PC50) "PC50", SUM(PC51) "PC51", SUM(PC52) "PC52", SUM(PC53) "PC53", SUM(PC54) "PC54", SUM(PC55) "PC55", SUM(PC56) "PC56", SUM(PC57) "PC57", SUM(PC58) "PC58", SUM(PC59) "PC59", SUM(PC60) "PC60", SUM(PC61) "PC61", SUM(PC62) "PC62", SUM(PC63) "PC63", SUM(PC64) "PC64", SUM(PC65) "PC65", SUM(PC66) "PC66", SUM(PC67) "PC67", SUM(PC68) "PC68", SUM(PC69) "PC69", SUM(PC70) "PC70", SUM(PC71) "PC71", SUM(PC72) "PC72", SUM(PC73) "PC73", SUM(PC74) "PC74", SUM(PC75) "PC75", SUM(PC76) "PC76", SUM(PC77) "PC77", SUM(PC78) "PC78", SUM(PC79) "PC79", SUM(PC80) "PC80", SUM(PC81) "PC81", SUM(PC82) "PC82", SUM(PC83) "PC83", SUM(PC84) "PC84", SUM(PC85) "PC85", SUM(PC86) "PC86", SUM(PC87) "PC87", SUM(PC88) "PC88", SUM(PC89) "PC89", SUM(PC90) "PC90", SUM(PC91) "PC91", SUM(PC92) "PC92", SUM(PC93) "PC93", SUM(PC94) "PC94", SUM(PC95) "PC95", SUM(PC96) "PC96", SUM(PC97) "PC97", SUM(PC98) "PC98", SUM(PC99) "PC99", SUM(PC100) "PC100", SUM(PC101) "PC101", SUM(PC102) "PC102", SUM(PC103) "PC103", SUM(PC104) "PC104", SUM(PC105) "PC105"
  from ( 
      --中兴MD
     select "START_TIME_DAY", "START_TIME_H", "COUNTER"."CITY_ID", "COUNTER"."CITY_NAME", "GROUP_NAME", "GROUP_ID",COUNT(1) "PC1", Round( ( SUM(C1) ) ,4) "PC2", Round( ( 0 ) ,4) "PC3", Round( SUM(C1) ,4) "PC4", Round( ( SUM(C2)  +  SUM(C3)  +  SUM(C4)  +  SUM(C5)  +  SUM(C6)  +  SUM(C7) ) ,4) "PC5", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C10)  +  SUM(C11)  +  SUM(C12)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C15)  +  SUM(C16)  +  SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20)  +  SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,4) "PC6", Round( ( SUM(C2)  +  SUM(C3) ) ,4) "PC7", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C10)  +  SUM(C11)  +  SUM(C12)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C15)  +  SUM(C16)  +  SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ,4) "PC8", Round( ( SUM(C4)  +  SUM(C5)  +  SUM(C6)  +  SUM(C7) ) ,4) "PC9", Round( ( SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,4) "PC10", Round( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C10)  +  SUM(C11)  +  SUM(C12)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C15)  +  SUM(C16)  +  SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ,4) "PC11", Round( SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ,4) "PC12", Round( SUM(C2)  +  SUM(C3) ,4) "PC13", Round( SUM(C4)  +  SUM(C5)  +  SUM(C6)  +  SUM(C7) ,4) "PC14", Round( ( SUM(C47)  +  SUM(C48)  +  SUM(C49)  +  SUM(C50) ) ,4) "PC15", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C12)  +  SUM(C10)  +  SUM(C11)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C17)  +  SUM(C15)  +  SUM(C16)  +  SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C25)  +  SUM(C23)  +  SUM(C24)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C30)  +  SUM(C28)  +  SUM(C29)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C38)  +  SUM(C36)  +  SUM(C37)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C43)  +  SUM(C41)  +  SUM(C42) ) ,4) "PC16", Round( ( SUM(C47)  +  SUM(C48)  +  SUM(C49)  +  SUM(C50) ) ,4) "PC17", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C12)  +  SUM(C10)  +  SUM(C11)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C17)  +  SUM(C15)  +  SUM(C16)  +  SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C25)  +  SUM(C23)  +  SUM(C24)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C30)  +  SUM(C28)  +  SUM(C29)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C38)  +  SUM(C36)  +  SUM(C37)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C43)  +  SUM(C41)  +  SUM(C42) ) ,4) "PC18", Round( SUM(C9)  +  SUM(C14)  +  SUM(C19)  +  SUM(C22)  +  SUM(C27)  +  SUM(C32)  +  SUM(C35)  +  SUM(C40)  +  SUM(C45) ,4) "PC19", Round( SUM(C10)  +  SUM(C15)  +  SUM(C23)  +  SUM(C28)  +  SUM(C36)  +  SUM(C41) ,4) "PC20", Round( SUM(C11)  +  SUM(C16)  +  SUM(C24)  +  SUM(C29)  +  SUM(C37)  +  SUM(C42) ,4) "PC21", Round( ( SUM(C51)  +  SUM(C52) ) ,4) "PC22", Round( ( SUM(C51)  +  SUM(C52)  -  SUM(C52) ) ,4) "PC23", Round( ( SUM(C52) ) ,4) "PC24", Round( ( SUM(C53) ) ,4) "PC25", Round( ( SUM(C54) ) ,4) "PC26", Round( ( SUM(C55) ) ,4) "PC27", Round( ( SUM(C53)  +  SUM(C54)  +  SUM(C55) ) ,4) "PC28", Round( ( SUM(C53)  +  SUM(C54)  +  SUM(C55)  +  SUM(C51)  +  SUM(C52) ) ,4) "PC29", Round( ( ( SUM(C52)  +  SUM(C53)  +  SUM(C54)  +  SUM(C55) ) ) ,4) "PC30", Round( ( ( SUM(C51)  +  SUM(C52)  +  SUM(C53)  +  SUM(C54)  +  SUM(C55) ) ) ,4) "PC31", Round( ( 100  *  (decode( ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) ,0,1, SUM(C56)  /  ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) )) ) ,4) "PC32", Round( ( ( 100  * decode( ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) ,0,1, ( SUM(C57)  +  SUM(C58) )  /  ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) )) ) ,4) "PC33", Round( ( 100  *  (decode( ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) ,0,1, SUM(C59)  /  ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) )) ) ,4) "PC34", Round( ( SUM(C60) ) ,4) "PC35", Round( ( SUM(C61) ) ,4) "PC36", Round( ( SUM(C61) ) ,4) "PC37", Round( ( SUM(C60) ) ,4) "PC38", Round( SUM(C61)  -  SUM(C60) ,4) "PC39", Round( ( SUM(C62) ) ,4) "PC40", Round( ( SUM(C63)  /  3600 ) ,4) "PC41", Round( ( ( SUM(C63)  +  SUM(C64) )  /  3600 ) ,4) "PC42", Round( ( ( SUM(C63)  +  SUM(C64) )  /  3600 )  -  ( SUM(C63)  /  3600 ) ,4) "PC43", Round( ( ( ( SUM(C63)  +  SUM(C64) )  /  3600 )  -  ( SUM(C63)  /  3600 ) ) ,4) "PC44", Round( ( ( SUM(C63)  /  3600 ) ) ,4) "PC45", Round( ( ( ( SUM(C65)  +  SUM(C66) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC46", Round( ( SUM(C66) ) ,4) "PC47", Round( ( SUM(C65)  -  SUM(C66)  +  SUM(C66) ) ,4) "PC48", Round( ( ( ( SUM(C67)  +  SUM(C68)  -  SUM(C69)  +  SUM(C69) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC49", Round( ( SUM(C69) ) ,4) "PC50", Round( ( SUM(C67)  +  SUM(C68)  -  SUM(C69)  +  SUM(C69) ) ,4) "PC51", Round( ( ( SUM(C70)  +  SUM(C71) )  *  ( 8  /  1000 )  /  3600 ) ,4) "PC52", Round( ( SUM(C70)  +  SUM(C71) )  *  (decode( ( ( AVG(C72)  +  AVG(C73) )  *  1.667 ) ,0,1, 8  /  ( ( AVG(C72)  +  AVG(C73) )  *  1.667 ) )) ,4) "PC53", Round( ( ( SUM(C74)  +  SUM(C75) )  *  ( 8  /  1000 )  /  3600 ) ,4) "PC54", Round( ( (decode( ( AVG(C76)  *  1.667  /  1000 ) ,0,1, ( ( SUM(C74)  +  SUM(C75) )  *  8 )  /  ( AVG(C76)  *  1.667  /  1000 ) ))  /  1000 ) ,4) "PC55", Round( ( ( AVG(C72)  +  AVG(C73) )  *  ( 1.667  /  3600000 )  *  100 ) ,4) "PC56", Round( 100 ,4) "PC57", Round( ( 100  *  ( AVG(C77)  *  ( 1.667  /  1000 )  /  3600 ) ) ,4) "PC58", Round( 100 ,4) "PC59", Round( ( 100  *  ( AVG(C78)  +  AVG(C79) )  *  ( 16  *  ( 1.667  /  1000 )  /  3600 ) ) ,4) "PC60", Round( 100 ,4) "PC61", Round( ( SUM(C80)  +  SUM(C81)  +  SUM(C82) ) ,4) "PC62", Round( ( SUM(C83)  +  SUM(C84)  +  SUM(C85) ) ,4) "PC63", Round( ( SUM(C83)  +  SUM(C84)  +  SUM(C85) ) ,4) "PC64", Round( ( SUM(C80)  +  SUM(C81)  +  SUM(C82) ) ,4) "PC65", Round( ( SUM(C86)  +  SUM(C87) ) ,4) "PC66", Round( ( SUM(C88)  +  SUM(C89) ) ,4) "PC67", Round( ( SUM(C88)  +  SUM(C89) ) ,4) "PC68", Round( ( SUM(C86)  +  SUM(C87) ) ,4) "PC69", Round( ( SUM(C90) ) ,4) "PC70", Round( ( SUM(C91) ) ,4) "PC71", Round( ( SUM(C91) ) ,4) "PC72", Round( ( SUM(C90) ) ,4) "PC73", Round( ( SUM(C92) ) ,4) "PC74", Round( ( SUM(C93) ) ,4) "PC75", Round( ( SUM(C93) ) ,4) "PC76", Round( ( SUM(C92) ) ,4) "PC77",
     SUM(CARR_37_NUM) "PC78", SUM(CARR_78_NUM) "PC79", SUM(CARR_119_NUM) "PC80", SUM(DO_CELL_TOTAL_NUM) "PC81",
     Round( 0 ,4) "PC82", Round( 0 ,4) "PC83", Round( 0 ,4) "PC84",
    SUM(DO_1CARR_CELL_NUM) "PC85", SUM(DO_2CARR_CELL_NUM) "PC86", SUM(DO_3CARR_CELL_NUM) "PC87", COUNT(1) "PC88",
     Round( SUM(C66) ,4) "PC89", Round( SUM(C66)  +  SUM(C65) ,4) "PC90", Round( SUM(C69) ,4) "PC91", Round( SUM(C67)  +  SUM(C68) ,4) "PC92", Round( 0 ,4) "PC93", Round( SUM(C56) ,4) "PC94", Round( SUM(C57)  +  SUM(C58) ,4) "PC95", Round( SUM(C59) ,4) "PC96", Round( ( SUM(C70)  +  SUM(C71) )  *  8 ,4) "PC97", Round( ( AVG(C72)  +  AVG(C73) )  *  ( 1.667  /  1000 ) ,4) "PC98", Round( ( SUM(C74)  +  SUM(C75) )  *  8 ,4) "PC99", Round( AVG(C76)  *  ( 1.667  /  1000 ) ,4) "PC100", Round( 0 ,4) "PC101", Round( 0 ,4) "PC102", Round( 0 ,4) "PC103", Round( 0 ,4) "PC104", Round( 0 ,4) "PC105", "START_TIME" 
     from (
       select "S1"."START_TIME", to_char(S1.START_TIME,'YYYY-MM-DD') "START_TIME_DAY", to_char(S1.START_TIME,'HH24') "START_TIME_H", "S1"."CITY_ID", "S1"."CITY_NAME", "GROUP_NAME", "GROUP_ID", "S1"."P821_USERNUM" "C1", "S1"."P801_CMO_CALLSNUM" "C2", "S1"."P819_CMO_CALLSUCCESSNUM" "C3", "S1"."P801_CMT_CALLSNUM" "C4", "S1"."P819_CMT_CALLSUCCESSNUM" "C5", "S1"."P801_FMT_CALLSNUM" "C6", "S1"."P819_FMT_CALLSUCCESSNUM" "C7", "S1"."P801_CMO_EXTINTERRUPTNUM" "C8", "S1"."P801_CMO_BLOCKFNUM" "C9", "S1"."P801_CMO_RTCHCAPFNUM" "C10", "S1"."P801_CMO_TCCTIMEOUTFNUM" "C11", "S1"."P801_CMO_OTHERFNUM" "C12", "S1"."P819_CMO_EXTINTERRUPTNUM" "C13", "S1"."P819_CMO_BLOCKFAILURENUM" "C14", "S1"."P819_CMO_RTCHCAPFNUM" "C15", "S1"."P819_CMO_TCCTIMEOUTFNUM" "C16", "S1"."P819_CMO_OTHERFAILURENUM" "C17", "S1"."P822_CMO_EXTINTERRUPTNUM" "C18", "S1"."P822_CMO_BLOCKFAILURENUM" "C19", "S1"."P822_CMO_OTHERFAILURENUM" "C20", "S1"."P801_CMT_EXTINTERRUPTNUM" "C21", "S1"."P801_CMT_BLOCKFNUM" "C22", "S1"."P801_CMT_RTCHCAPFNUM" "C23", "S1"."P801_CMT_TCCTIMEOUTFNUM" "C24", "S1"."P801_CMT_OTHERFNUM" "C25", "S1"."P819_CMT_EXTINTERRUPTNUM" "C26", "S1"."P819_CMT_BLOCKFAILURENUM" "C27", "S1"."P819_CMT_RTCHCAPFNUM" "C28", "S1"."P819_CMT_TCCTIMEOUTFNUM" "C29", "S1"."P819_CMT_OTHERFAILURENUM" "C30", "S1"."P822_CMT_EXTINTERRUPTNUM" "C31", "S1"."P822_CMT_BLOCKFAILURENUM" "C32", "S1"."P822_CMT_OTHERFAILURENUM" "C33", "S1"."P801_FMT_EXTINTERRUPTNUM" "C34", "S1"."P801_FMT_BLOCKFNUM" "C35", "S1"."P801_FMT_RTCHCAPFNUM" "C36", "S1"."P801_FMT_TCCTIMEOUTFNUM" "C37", "S1"."P801_FMT_OTHERFNUM" "C38", "S1"."P819_FMT_EXTINTERRUPTNUM" "C39", "S1"."P819_FMT_BLOCKFAILURENUM" "C40", "S1"."P819_FMT_RTCHCAPFNUM" "C41", "S1"."P819_FMT_TCCTIMEOUTFNUM" "C42", "S1"."P819_FMT_OTHERFAILURENUM" "C43", "S1"."P822_FMT_EXTINTERRUPTNUM" "C44", "S1"."P822_FMT_BLOCKFAILURENUM" "C45", "S1"."P822_FMT_OTHERFAILURENUM" "C46", "S1"."P801_MO_WIRENETCALLSUCNUM" "C47", "S1"."P801_MT_WIRENETSUCNUM" "C48", "S1"."P819_MO_WIRENETCALLSUCNUM" "C49", "S1"."P819_MT_WIRENETSUCNUM" "C50", "S1"."P803_RLSSNUM" "C51", "S1"."P803_PDSNRELEASENUM" "C52", "S1"."P803_AIRLINKLOSTDROPNUM" "C53", "S1"."P803_HHODROPNUM" "C54", "S1"."P803_OTHERDROPNUM" "C55", "S1"."P840_RANGE1REQNUM" "C56", "S1"."P840_RANGE2REQNUM" "C57", "S1"."P840_RANGE3REQNUM" "C58", "S1"."P840_RANGE4REQNUM" "C59", "S1"."P820_SETUPSUCCESSNUM" "C60", "S1"."P820_SETUPATTEMPTNUM" "C61", "S1"."P815_EQUUSERNUM" "C62", "S1"."P804_CALLDURATION" "C63", "S1"."P804_SHODURATION" "C64", "S1"."P821_TXBYTENUM" "C65", "S1"."P821_RETXBYTENUM" "C66", "S1"."P807_REVAREVTCHMACBYTES" "C67", "S1"."P807_RLS0REVTCHMACBYTES" "C68", "S1"."P821_REREBYTENUM" "C69", "S1"."P806_REVAFWDTCHPHYBYTES" "C70", "S1"."P806_RLS0FWDTCHPHYBYTES" "C71", "S1"."P806_REVAFWDTCHSENDSLOTNUM" "C72", "S1"."P806_RLS0FWDTCHSENDSLOTNUM" "C73", "S1"."P807_REVAREVTCHPHYBYTES" "C74", "S1"."P807_RLS0REVTCHPHYBYTES" "C75", "S1"."P815_REVSLOTNUM" "C76", "S1"."P806_FWDCCHSENDSLOTNUM" "C77", "S1"."P815_SUCCESSCAPSULENUM" "C78", "S1"."P815_FAILURECAPSULENUM" "C79", "S1"."P802_SRCANTGTHO_SFTSUCCESSNUM" "C80", "S1"."P802_SRCANTGTHO_SFRSUCCESSNUM" "C81", "S1"."P802_SRCANTGTHO_AFRSUCCESSNUM" "C82", "S1"."P802_SRCANTGTHO_SFTREQUESTNUM" "C83", "S1"."P802_SRCANTGTHO_SFRREQUESTNUM" "C84", "S1"."P802_SRCANTGTHO_AFRREQESTNUM" "C85", "S1"."P802_INTERANSRCHOOUT_SUCCESSNU" "C86", "S1"."P826_INTERANTGTHOIN_SUCCESSNUM" "C87", "S1"."P802_INTERANSRCHOOUT_REQUESTNU" "C88", "S1"."P826_INTERANTGTHOIN_REQESTNUM" "C89", "S1"."P802_SRCANTGTHO_IFRSUCCESSNUM" "C90", "S1"."P802_SRCANTGTHO_IFRREQUESTNUM" "C91", "S1"."P825_HARDHOADD_SUCCESSNUM" "C92", "S1"."P825_HARDHOADD_REQESTNUM" "C93",
       R.CARR_37_NUM, R.CARR_78_NUM, R.CARR_119_NUM, R.DO_CELL_TOTAL_NUM,R.DO_1CARR_CELL_NUM, R.DO_2CARR_CELL_NUM, R.DO_3CARR_CELL_NUM
       from "DS_COUNTER_GROUP_ZTE_TC_DO_1" "S1" inner join ( select distinct g.group_id,g.group_name,ne.CITY_ID , n.ne_sys_id, n.china_name, n.vendor from (select * from mod_negroup_group g where  Group_name LIKE 'HQ_%' and city_id != 0  ) g,mod_negroup_ne n,NE_CELL_C ne where n.group_id = g.group_id and n.ne_sys_id = ne.ne_sys_id ) "NEGROUP" on ("S1"."NE_SYS_ID" = "NEGROUP"."NE_SYS_ID" and "S1"."CITY_ID" = "NEGROUP"."CITY_ID")  inner join ( SELECT T.NE_CELL_ID,CELL_NAME,T.CITY_ID, CITY_NAME,  CELL_283_NUM, CELL_201_NUM,  CELL_242_NUM,
                           CELL_160_NUM,ONEX_CELL_TOTAL_NUM, ONEX_1CARR_CELL_NUM, ONEX_2CARR_CELL_NUM, ONEX_3CARR_CELL_NUM, ONEX_4CARR_CELL_NUM, 0 WIRELESS_CAPACITY,
                           CARR_37_NUM, CARR_78_NUM,  CARR_119_NUM, DO_1CARR_CELL_NUM,  DO_2CARR_CELL_NUM, DO_3CARR_CELL_NUM, DO_CELL_TOTAL_NUM
                      FROM (SELECT CELL,  CITY_ID, SUM(DECODE(CELL_283, 0, 0, 1)) CELL_283_NUM, SUM(DECODE(CELL_201, 0, 0, 1)) CELL_201_NUM, SUM(DECODE(CELL_242, 0, 0, 1)) CELL_242_NUM,
                                   SUM(DECODE(CELL_160, 0, 0, 1)) CELL_160_NUM
                              FROM (SELECT DISTINCT RELATED_CELL CELL, CITY_ID, BUSTYPE, DECODE(CARRIER_ID, 283, RELATED_CELL, 0) CELL_283, DECODE(CARRIER_ID, 201, RELATED_CELL, 0) CELL_201, DECODE(CARRIER_ID, 242, RELATED_CELL, 0) CELL_242, DECODE(CARRIER_ID, 160, RELATED_CELL, 0) CELL_160
                                      FROM NE_CARRIER_C T
                                     WHERE T.BUSTYPE = '1X')
                             GROUP BY CELL, CITY_ID) T3,
                           (SELECT RELATED_CELL CELL, CITY_ID,SUM(DECODE(CARRIER_ID, 37, 1, 0)) CARR_37_NUM,SUM(DECODE(CARRIER_ID, 78, 1, 0)) CARR_78_NUM, SUM(DECODE(CARRIER_ID, 119, 1, 0)) CARR_119_NUM
                              FROM NE_CARRIER_C T
                             WHERE T.BUSTYPE = 'DO'
                             GROUP BY RELATED_CELL, CITY_ID) T4,
                           (SELECT CELL, CITY_ID,
                                   SUM(DECODE(BUSTYPE, '1X', 1, 0)) ONEX_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', 1, 0)) DO_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 1, 1, 0), 0)) ONEX_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 2, 1, 0), 0)) ONEX_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 3, 1, 0), 0)) ONEX_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 4, 1, 0), 0)) ONEX_4CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 1, 1, 0), 0)) DO_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 2, 1, 0), 0)) DO_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 3, 1, 0), 0)) DO_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 4, 1, 0), 0)) DO_4CARR_CELL_NUM
                              FROM (SELECT RELATED_BSC BSC,RELATED_BTS BTS, RELATED_CELL CELL,CITY_ID, BUSTYPE, COUNT(DISTINCT CARRIER_ID) CNT
                                      FROM NE_CARRIER_C T
                                     GROUP BY RELATED_BTS,
                                              T.RELATED_BSC,
                                              RELATED_CELL,
                                              CITY_ID,
                                              BUSTYPE)
                             GROUP BY CELL, CITY_ID) T5,
                           (SELECT DISTINCT NE_CELL_ID, CELL_NAME, CITY_ID, CITY_NAME
                              FROM CFG_MAP_DEV_TO_NE) T
                     WHERE T.NE_CELL_ID = T3.CELL(+)
                       AND T.NE_CELL_ID = T4.CELL(+)
                       AND T.NE_CELL_ID = T5.CELL(+) 
                       AND T.CITY_ID = T3.CITY_ID(+)
                       AND T.CITY_ID = T4.CITY_ID(+)
                       AND T.CITY_ID = T5.CITY_ID(+) ) R  On (S1.NE_SYS_ID = R.NE_CELL_ID) 
       where  S1.START_TIME&gt;=TO_DATE('%%Y-%%M-%%D 00:00:00','YYYY-MM-DD HH24:MI:SS') AND  S1.START_TIME&lt;=TO_DATE('%%Y-%%M-%%D 23:59:59','YYYY-MM-DD HH24:MI:SS')  ) "COUNTER" 
     group by "START_TIME_H", "START_TIME_DAY", "CITY_ID", "CITY_NAME", "GROUP_NAME", "GROUP_ID", "START_TIME" 
     union all --华为MD
     select "START_TIME_DAY", "START_TIME_H", "COUNTER"."CITY_ID", "COUNTER"."CITY_NAME", "GROUP_NAME", "GROUP_ID", COUNT(1) "PC1", Round( ( SUM(C1)  +  SUM(C2) ) ,4) "PC2", Round( ( SUM(C3) ) ,4) "PC3", Round( SUM(C1)  +  SUM(C2) ,4) "PC4", Round( ( (decode( ( SUM(C6)  +  SUM(C7) ) ,0,1, ( SUM(C4)  +  SUM(C5) )  /  ( SUM(C6)  +  SUM(C7) ) ))  *  100 ) ,4) "PC5", Round( 1 ,4) "PC6", Round( ( (decode( SUM(C6) ,0,1, SUM(C4)  /  SUM(C6) )) )  *  100 ,4) "PC7", Round( 1 ,4) "PC8", Round( ( (decode( SUM(C7) ,0,1, SUM(C5)  /  SUM(C7) )) )  *  100 ,4) "PC9", Round( 1 ,4) "PC10", Round( SUM(C6) ,4) "PC11", Round( SUM(C7) ,4) "PC12", Round( SUM(C4) ,4) "PC13", Round( SUM(C5) ,4) "PC14", Round( ( SUM(C8) ) ,4) "PC15", Round( ( SUM(C9) ) ,4) "PC16", Round( ( SUM(C8) ) ,4) "PC17", Round( ( SUM(C9) ) ,4) "PC18", Round( SUM(C10)  +  SUM(C11) ,4) "PC19", Round( SUM(C12)  +  SUM(C13) ,4) "PC20", Round( SUM(C14)  +  SUM(C15) ,4) "PC21", Round( ( SUM(C16) ) ,4) "PC22", Round( ( SUM(C16)  -  SUM(C17) ) ,4) "PC23", Round( ( SUM(C17) ) ,4) "PC24", Round( ( SUM(C18) ) ,4) "PC25", Round( ( SUM(C19) ) ,4) "PC26", Round( ( SUM(C20) ) ,4) "PC27", Round( ( SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ,4) "PC28", Round( ( SUM(C18)  +  SUM(C19)  +  SUM(C20)  +  SUM(C16) ) ,4) "PC29", Round( ( ( SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ) ,4) "PC30", Round( ( ( SUM(C16)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ) ,4) "PC31", Round( ( ( 100  * decode( ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,0,1, ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26) )  /  ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) )) ) ,4) "PC32", Round( ( ( 100  * decode( ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,0,1, ( SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40) )  /  ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) )) ) ,4) "PC33", Round( ( ( 100  * decode( ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,0,1, ( SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) )  /  ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) )) ) ,4) "PC34", Round( ( SUM(C47) ) ,4) "PC35", Round( ( SUM(C48) ) ,4) "PC36", Round( ( SUM(C48) ) ,4) "PC37", Round( ( SUM(C47) ) ,4) "PC38", Round( SUM(C49)  +  SUM(C50)  +  SUM(C51)  +  SUM(C52) ,4) "PC39", Round( ( SUM(C53)  *  ( 0.001667  /  3600 ) ) ,4) "PC40", Round( ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ,4) "PC41", Round( ( ( ( SUM(C88)  +  ( SUM(C89)  /  2 )  +  ( ( SUM(C57)  +  SUM(C61)  +  SUM(C90)  +  SUM(C91) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C92)  +  SUM(C93) )  /  4 )  +  ( ( SUM(C94)  +  SUM(C95) )  /  5 )  +  ( SUM(C96)  /  6 ) )  +  ( SUM(C97)  +  ( SUM(C98)  /  2 )  +  ( ( SUM(C69)  +  SUM(C73)  +  SUM(C99)  +  SUM(C100) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C101)  +  SUM(C102) )  /  4 )  +  ( ( SUM(C103)  +  SUM(C104) )  /  5 )  +  ( SUM(C105)  /  6 ) )  +  ( SUM(C106)  /  30 ) )  /  3600 ) ,4) "PC42", Round( ( ( ( SUM(C88)  +  ( SUM(C89)  /  2 )  +  ( ( SUM(C57)  +  SUM(C61)  +  SUM(C90)  +  SUM(C91) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C92)  +  SUM(C93) )  /  4 )  +  ( ( SUM(C94)  +  SUM(C95) )  /  5 )  +  ( SUM(C96)  /  6 ) )  +  ( SUM(C97)  +  ( SUM(C98)  /  2 )  +  ( ( SUM(C69)  +  SUM(C73)  +  SUM(C99)  +  SUM(C100) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C101)  +  SUM(C102) )  /  4 )  +  ( ( SUM(C103)  +  SUM(C104) )  /  5 )  +  ( SUM(C105)  /  6 ) )  +  ( SUM(C106)  /  30 ) )  /  3600 )  -  ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ,4) "PC43", Round( ( ( ( ( SUM(C88)  +  ( SUM(C89)  /  2 )  +  ( ( SUM(C57)  +  SUM(C61)  +  SUM(C90)  +  SUM(C91) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C92)  +  SUM(C93) )  /  4 )  +  ( ( SUM(C94)  +  SUM(C95) )  /  5 )  +  ( SUM(C96)  /  6 ) )  +  ( SUM(C97)  +  ( SUM(C98)  /  2 )  +  ( ( SUM(C69)  +  SUM(C73)  +  SUM(C99)  +  SUM(C100) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C101)  +  SUM(C102) )  /  4 )  +  ( ( SUM(C103)  +  SUM(C104) )  /  5 )  +  ( SUM(C105)  /  6 ) )  +  ( SUM(C106)  /  30 ) )  /  3600 )  -  ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ) ,4) "PC44", Round( ( ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ) ,4) "PC45", Round( ( ( ( SUM(C107)  +  SUM(C108) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC46", Round( ( SUM(C108) ) ,4) "PC47", Round( ( SUM(C107)  +  SUM(C108) ) ,4) "PC48", Round( ( ( ( SUM(C109)  *  1024  -  SUM(C110)  +  SUM(C110) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC49", Round( ( SUM(C110) ) ,4) "PC50", Round( ( SUM(C109)  *  1024  -  SUM(C110)  +  SUM(C110) ) ,4) "PC51", Round( ( SUM(C111)  /  3600 ) ,4) "PC52", Round( (decode( ( 0.001667  *  SUM(C112) ) ,0,1, SUM(C111)  /  ( 0.001667  *  SUM(C112) ) )) ,4) "PC53", Round( (decode( ( 1000  *  3600 ) ,0,1, ( ( SUM(C113)  +  SUM(C114)  +  SUM(C115)  +  SUM(C116) )  *  256  +  ( SUM(C117)  +  SUM(C118)  +  SUM(C119)  +  SUM(C120) )  *  512  +  ( SUM(C121)  +  SUM(C122)  +  SUM(C123)  +  SUM(C124) )  *  1024  +  ( SUM(C125)  +  SUM(C126)  +  SUM(C127)  +  SUM(C128) )  *  2048  +  ( SUM(C129)  +  SUM(C130)  +  SUM(C131)  +  SUM(C132) )  *  4096  +  SUM(C133)  *  128  +  SUM(C134)  *  256  +  SUM(C135)  *  512  +  SUM(C136)  *  768  +  SUM(C137)  *  1024  +  SUM(C138)  *  1536  +  SUM(C139)  *  2048  +  SUM(C140)  *  3072  +  SUM(C141)  *  4096  +  SUM(C142)  *  6144  +  SUM(C143)  *  8192  +  SUM(C144)  *  12288  +  SUM(C145)  *  128  +  SUM(C146)  *  256  +  SUM(C147)  *  512  +  SUM(C148)  *  768  +  SUM(C149)  *  1024  +  SUM(C150)  *  1536  +  SUM(C151)  *  2048  +  SUM(C152)  *  3072  +  SUM(C153)  *  4096  +  SUM(C154)  *  6144  +  SUM(C155)  *  8192  +  SUM(C156)  *  12288 )  /  ( 1000  *  3600 ) )) ,4) "PC54", Round( (decode( ( 1000  *  SUM(C157) ) ,0,1, ( ( SUM(C113)  +  SUM(C114)  +  SUM(C115)  +  SUM(C116) )  *  256  +  ( SUM(C117)  +  SUM(C118)  +  SUM(C119)  +  SUM(C120) )  *  512  +  ( SUM(C121)  +  SUM(C122)  +  SUM(C123)  +  SUM(C124) )  *  1024  +  ( SUM(C125)  +  SUM(C126)  +  SUM(C127)  +  SUM(C128) )  *  2048  +  ( SUM(C129)  +  SUM(C130)  +  SUM(C131)  +  SUM(C132) )  *  4096  +  SUM(C133)  *  128  +  SUM(C134)  *  256  +  SUM(C135)  *  512  +  SUM(C136)  *  768  +  SUM(C137)  *  1024  +  SUM(C138)  *  1536  +  SUM(C139)  *  2048  +  SUM(C140)  *  3072  +  SUM(C141)  *  4096  +  SUM(C142)  *  6144  +  SUM(C143)  *  8192  +  SUM(C144)  *  12288  +  SUM(C145)  *  128  +  SUM(C146)  *  256  +  SUM(C147)  *  512  +  SUM(C148)  *  768  +  SUM(C149)  *  1024  +  SUM(C150)  *  1536  +  SUM(C151)  *  2048  +  SUM(C152)  *  3072  +  SUM(C153)  *  4096  +  SUM(C154)  *  6144  +  SUM(C155)  *  8192  +  SUM(C156)  *  12288 )  /  ( 1000  *  SUM(C157) ) )) ,4) "PC55", Round( ( ( AVG(C158)  /  100 ) ) ,4) "PC56", Round( 100 ,4) "PC57", Round( ( AVG(C159)  +  AVG(C160) ) ,4) "PC58", Round( 100 ,4) "PC59", Round( ( AVG(C161) ) ,4) "PC60", Round( 100 ,4) "PC61", Round( ( SUM(C162) ) ,4) "PC62", Round( ( SUM(C163) ) ,4) "PC63", Round( ( SUM(C163) ) ,4) "PC64", Round( ( SUM(C162) ) ,4) "PC65", Round( ( SUM(C164)  +  SUM(C165) ) ,4) "PC66", Round( ( SUM(C166)  +  SUM(C167) ) ,4) "PC67", Round( ( SUM(C166)  +  SUM(C167) ) ,4) "PC68", Round( ( SUM(C164)  +  SUM(C165) ) ,4) "PC69", Round( ( SUM(C168) ) ,4) "PC70", Round( ( SUM(C169) ) ,4) "PC71", Round( ( SUM(C169) ) ,4) "PC72", Round( ( SUM(C168) ) ,4) "PC73", Round( ( SUM(C170)  +  SUM(C171) ) ,4) "PC74", Round( ( SUM(C172)  +  SUM(C173) ) ,4) "PC75", Round( ( SUM(C172)  +  SUM(C173) ) ,4) "PC76", Round( ( SUM(C170)  +  SUM(C171) ) ,4) "PC77",
     SUM(CARR_37_NUM) "PC78", SUM(CARR_78_NUM) "PC79", SUM(CARR_119_NUM) "PC80", SUM(DO_CELL_TOTAL_NUM) "PC81",
     Round( 0 ,4) "PC82", Round( 0 ,4) "PC83", Round( 0 ,4) "PC84",
    SUM(DO_1CARR_CELL_NUM) "PC85", SUM(DO_2CARR_CELL_NUM) "PC86", SUM(DO_3CARR_CELL_NUM) "PC87", COUNT(1) "PC88",
     Round( SUM(C108) ,4) "PC89", Round( SUM(C107)  +  SUM(C108) ,4) "PC90", Round( SUM(C174) ,4) "PC91", Round( SUM(C109)  *  1024 ,4) "PC92", Round( SUM(C3) ,4) "PC93", Round( SUM(C21)  +  SUM(C22)  +  SUM(C23) ,4) "PC94", Round( SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33) ,4) "PC95", Round( SUM(C41)  +  SUM(C42) ,4) "PC96", Round( SUM(C111) ,4) "PC97", Round( 0.001667  *  SUM(C112) ,4) "PC98", Round( ( SUM(C113)  +  SUM(C114)  +  SUM(C115)  +  SUM(C116) )  *  256  +  ( SUM(C117)  +  SUM(C118)  +  SUM(C119)  +  SUM(C120) )  *  512  +  ( SUM(C121)  +  SUM(C122)  +  SUM(C123)  +  SUM(C124) )  *  1024  +  ( SUM(C125)  +  SUM(C126)  +  SUM(C127)  +  SUM(C128) )  *  2048  +  ( SUM(C129)  +  SUM(C130)  +  SUM(C131)  +  SUM(C132) )  *  4096  +  SUM(C133)  *  128  +  SUM(C134)  *  256  +  SUM(C135)  *  512  +  SUM(C136)  *  768  +  SUM(C137)  *  1024  +  SUM(C138)  *  1536  +  SUM(C139)  *  2048  +  SUM(C140)  *  3072  +  SUM(C141)  *  4096  +  SUM(C142)  *  6144  +  SUM(C143)  *  8192  +  SUM(C144)  *  12288  +  SUM(C145)  *  128  +  SUM(C146)  *  256  +  SUM(C147)  *  512  +  SUM(C148)  *  768  +  SUM(C149)  *  1024  +  SUM(C150)  *  1536  +  SUM(C151)  *  2048  +  SUM(C152)  *  3072  +  SUM(C153)  *  4096  +  SUM(C154)  *  6144  +  SUM(C155)  *  8192  +  SUM(C156)  *  12288 ,4) "PC99", Round( 1000  *  SUM(C157) ,4) "PC100", Round( 0 ,4) "PC101", Round( 0 ,4) "PC102", Round( 0 ,4) "PC103", Round( 0 ,4) "PC104", Round( 0 ,4) "PC105", "START_TIME"
     from ( 
       select "S1"."START_TIME", to_char(S1.START_TIME,'YYYY-MM-DD') "START_TIME_DAY", to_char(S1.START_TIME,'HH24') "START_TIME_H", "S1"."CITY_ID", "S1"."CITY_NAME", "GROUP_NAME", "GROUP_ID", "S1"."COUNTER_1166017335" "C1", "S1"."COUNTER_1166017337" "C2", "S1"."COUNTER_1166017334" "C3", "S1"."COUNTER_1157633256" "C4", "S1"."COUNTER_1157633257" "C5", "S1"."COUNTER_1157631096" "C6", "S1"."COUNTER_1157631102" "C7", "S1"."COUNTER_1157631249" "C8", "S1"."COUNTER_1157631248" "C9", "S1"."COUNTER_1157631098" "C10", "S1"."COUNTER_1157631104" "C11", "S1"."COUNTER_1157631099" "C12", "S1"."COUNTER_1157631105" "C13", "S1"."COUNTER_1157631100" "C14", "S1"."COUNTER_1157631106" "C15", "S1"."COUNTER_1157633262" "C16", "S1"."COUNTER_1157633259" "C17", "S1"."COUNTER_1157633261" "C18", "S1"."COUNTER_1157631124" "C19", "S1"."COUNTER_1157633260" "C20", "S1"."COUNTER_1166017251" "C21", "S1"."COUNTER_1166017252" "C22", "S1"."COUNTER_1166017253" "C23", "S1"."COUNTER_1166017514" "C24", "S1"."COUNTER_1166017515" "C25", "S1"."COUNTER_1166017516" "C26", "S1"."COUNTER_1166017254" "C27", "S1"."COUNTER_1166017255" "C28", "S1"."COUNTER_1166017256" "C29", "S1"."COUNTER_1166017257" "C30", "S1"."COUNTER_1166017258" "C31", "S1"."COUNTER_1166017259" "C32", "S1"."COUNTER_1166017260" "C33", "S1"."COUNTER_1166017517" "C34", "S1"."COUNTER_1166017518" "C35", "S1"."COUNTER_1166017519" "C36", "S1"."COUNTER_1166017520" "C37", "S1"."COUNTER_1166017521" "C38", "S1"."COUNTER_1166017522" "C39", "S1"."COUNTER_1166017523" "C40", "S1"."COUNTER_1166017261" "C41", "S1"."COUNTER_1166017262" "C42", "S1"."COUNTER_1166017524" "C43", "S1"."COUNTER_1166017525" "C44", "S1"."COUNTER_1166017526" "C45", "S1"."COUNTER_1166017527" "C46", "S1"."COUNTER_1157629100" "C47", "S1"."COUNTER_1157629099" "C48", "S1"."COUNTER_1157629101" "C49", "S1"."COUNTER_1157629102" "C50", "S1"."COUNTER_1157629103" "C51", "S1"."COUNTER_1157629104" "C52", "S1"."COUNTER_1166017533" "C53", "S1"."COUNTER_1157630435" "C54", "S1"."COUNTER_1157630436" "C55", "S1"."COUNTER_1157630441" "C56", "S1"."COUNTER_1157630437" "C57", "S1"."COUNTER_1157630442" "C58", "S1"."COUNTER_1157630446" "C59", "S1"."COUNTER_1157630438" "C60", "S1"."COUNTER_1157630443" "C61", "S1"."COUNTER_1157630447" "C62", "S1"."COUNTER_1157630450" "C63", "S1"."COUNTER_1157631898" "C64", "S1"."COUNTER_1157631899" "C65", "S1"."COUNTER_1157630456" "C66", "S1"."COUNTER_1157630457" "C67", "S1"."COUNTER_1157630462" "C68", "S1"."COUNTER_1157630458" "C69", "S1"."COUNTER_1157630463" "C70", "S1"."COUNTER_1157630467" "C71", "S1"."COUNTER_1157630459" "C72", "S1"."COUNTER_1157630464" "C73", "S1"."COUNTER_1157630468" "C74", "S1"."COUNTER_1157630471" "C75", "S1"."COUNTER_1157631902" "C76", "S1"."COUNTER_1157631903" "C77", "S1"."COUNTER_1157632844" "C78", "S1"."COUNTER_1157632728" "C79", "S1"."COUNTER_1157632729" "C80", "S1"."COUNTER_1157632730" "C81", "S1"."COUNTER_1157632731" "C82", "S1"."COUNTER_1157632732" "C83", "S1"."COUNTER_1157632733" "C84", "S1"."COUNTER_1157632734" "C85", "S1"."COUNTER_1157632735" "C86", "S1"."COUNTER_1157632736" "C87", "S1"."COUNTER_1157631896" "C88", "S1"."COUNTER_1157631897" "C89", "S1"."COUNTER_1157630448" "C90", "S1"."COUNTER_1157630452" "C91", "S1"."COUNTER_1157630444" "C92", "S1"."COUNTER_1157630449" "C93", "S1"."COUNTER_1157630439" "C94", "S1"."COUNTER_1157630445" "C95", "S1"."COUNTER_1157630440" "C96", "S1"."COUNTER_1157631900" "C97", "S1"."COUNTER_1157631901" "C98", "S1"."COUNTER_1157630469" "C99", "S1"."COUNTER_1157630472" "C100", "S1"."COUNTER_1157630465" "C101", "S1"."COUNTER_1157630470" "C102", "S1"."COUNTER_1157630460" "C103", "S1"."COUNTER_1157630466" "C104", "S1"."COUNTER_1157630461" "C105", "S1"."COUNTER_1157632680" "C106", "S1"."COUNTER_1166017164" "C107", "S1"."COUNTER_1166017165" "C108", "S1"."COUNTER_1157631494" "C109", "S1"."COUNTER_1157631496" "C110", "S2"."COUNTER_1166022435" "C111", "S1"."COUNTER_1166017534" "C112", "S2"."COUNTER_1166016809" "C113", "S2"."COUNTER_1166016813" "C114", "S2"."COUNTER_1166016815" "C115", "S2"."COUNTER_1166016819" "C116", "S2"."COUNTER_1166016821" "C117", "S2"."COUNTER_1166016825" "C118", "S2"."COUNTER_1166016827" "C119", "S2"."COUNTER_1166016831" "C120", "S2"."COUNTER_1166016833" "C121", "S2"."COUNTER_1166016837" "C122", "S2"."COUNTER_1166016839" "C123", "S2"."COUNTER_1166016843" "C124", "S2"."COUNTER_1166016845" "C125", "S2"."COUNTER_1166016849" "C126", "S2"."COUNTER_1166016851" "C127", "S2"."COUNTER_1166016855" "C128", "S2"."COUNTER_1166016857" "C129", "S2"."COUNTER_1166016861" "C130", "S2"."COUNTER_1166016863" "C131", "S2"."COUNTER_1166016867" "C132", "S2"."COUNTER_1166017269" "C133", "S2"."COUNTER_1166017271" "C134", "S2"."COUNTER_1166017273" "C135", "S2"."COUNTER_1166017275" "C136", "S2"."COUNTER_1166017277" "C137", "S2"."COUNTER_1166017279" "C138", "S2"."COUNTER_1166017281" "C139", "S2"."COUNTER_1166017283" "C140", "S2"."COUNTER_1166017285" "C141", "S2"."COUNTER_1166017287" "C142", "S2"."COUNTER_1166017289" "C143", "S2"."COUNTER_1166017291" "C144", "S2"."COUNTER_1166022231" "C145", "S2"."COUNTER_1166022233" "C146", "S2"."COUNTER_1166022235" "C147", "S2"."COUNTER_1166022237" "C148", "S2"."COUNTER_1166022239" "C149", "S2"."COUNTER_1166022241" "C150", "S2"."COUNTER_1166022243" "C151", "S2"."COUNTER_1166022245" "C152", "S2"."COUNTER_1166022247" "C153", "S2"."COUNTER_1166022249" "C154", "S2"."COUNTER_1166022251" "C155", "S2"."COUNTER_1166022253" "C156", "S1"."COUNTER_1166022267" "C157", "S1"."COUNTER_1166017182" "C158", "S1"."COUNTER_1166017219" "C159", "S1"."COUNTER_1166017225" "C160", "S1"."COUNTER_1166017341" "C161", "S1"."COUNTER_1157629162" "C162", "S1"."COUNTER_1157629161" "C163", "S1"."COUNTER_1157632248" "C164", "S1"."COUNTER_1157632249" "C165", "S1"."COUNTER_1157632246" "C166", "S1"."COUNTER_1157632247" "C167", "S1"."COUNTER_1157632127" "C168", "S1"."COUNTER_1157632126" "C169", "S1"."COUNTER_1157631536" "C170", "S1"."COUNTER_1157631541" "C171", "S1"."COUNTER_1157631540" "C172", "S1"."COUNTER_1157631535" "C173", "S1"."COUNTER_1157631495" "C174",
      R.CARR_37_NUM, R.CARR_78_NUM, R.CARR_119_NUM, R.DO_CELL_TOTAL_NUM,R.DO_1CARR_CELL_NUM, R.DO_2CARR_CELL_NUM, R.DO_3CARR_CELL_NUM
     from "DS_COUNTER_GROUP_HW_TC_DO_1" "S1" inner join "DS_COUNTER_GROUP_HW_TC_DO_2" "S2" on ("S1"."NE_SYS_ID" = "S2"."NE_SYS_ID" and "S1"."START_TIME" = "S2"."START_TIME" and "S1"."CITY_ID" = "S2"."CITY_ID") inner join ( select distinct g.group_id,g.group_name,ne.CITY_ID , n.ne_sys_id, n.china_name, n.vendor from (select * from mod_negroup_group g 
     where Group_name LIKE 'HQ_%' and city_id != 0 ) g,mod_negroup_ne n,NE_CELL_C ne where n.group_id = g.group_id and n.ne_sys_id = ne.ne_sys_id ) "NEGROUP" on ("S1"."NE_SYS_ID" = "NEGROUP"."NE_SYS_ID" and "S1"."CITY_ID" = "NEGROUP"."CITY_ID")  inner join ( SELECT T.NE_CELL_ID,CELL_NAME,T.CITY_ID, CITY_NAME,  CELL_283_NUM, CELL_201_NUM,  CELL_242_NUM,
                           CELL_160_NUM,ONEX_CELL_TOTAL_NUM, ONEX_1CARR_CELL_NUM, ONEX_2CARR_CELL_NUM, ONEX_3CARR_CELL_NUM, ONEX_4CARR_CELL_NUM, 0 WIRELESS_CAPACITY,
                           CARR_37_NUM, CARR_78_NUM,  CARR_119_NUM, DO_1CARR_CELL_NUM,  DO_2CARR_CELL_NUM, DO_3CARR_CELL_NUM, DO_CELL_TOTAL_NUM
                      FROM (SELECT CELL,  CITY_ID, SUM(DECODE(CELL_283, 0, 0, 1)) CELL_283_NUM, SUM(DECODE(CELL_201, 0, 0, 1)) CELL_201_NUM, SUM(DECODE(CELL_242, 0, 0, 1)) CELL_242_NUM,
                                   SUM(DECODE(CELL_160, 0, 0, 1)) CELL_160_NUM
                              FROM (SELECT DISTINCT RELATED_CELL CELL, CITY_ID, BUSTYPE, DECODE(CARRIER_ID, 283, RELATED_CELL, 0) CELL_283, DECODE(CARRIER_ID, 201, RELATED_CELL, 0) CELL_201, DECODE(CARRIER_ID, 242, RELATED_CELL, 0) CELL_242, DECODE(CARRIER_ID, 160, RELATED_CELL, 0) CELL_160
                                      FROM NE_CARRIER_C T
                                     WHERE T.BUSTYPE = '1X')
                             GROUP BY CELL, CITY_ID) T3,
                           (SELECT RELATED_CELL CELL, CITY_ID,SUM(DECODE(CARRIER_ID, 37, 1, 0)) CARR_37_NUM,SUM(DECODE(CARRIER_ID, 78, 1, 0)) CARR_78_NUM, SUM(DECODE(CARRIER_ID, 119, 1, 0)) CARR_119_NUM
                              FROM NE_CARRIER_C T
                             WHERE T.BUSTYPE = 'DO'
                             GROUP BY RELATED_CELL, CITY_ID) T4,
                           (SELECT CELL, CITY_ID,
                                   SUM(DECODE(BUSTYPE, '1X', 1, 0)) ONEX_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', 1, 0)) DO_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 1, 1, 0), 0)) ONEX_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 2, 1, 0), 0)) ONEX_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 3, 1, 0), 0)) ONEX_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 4, 1, 0), 0)) ONEX_4CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 1, 1, 0), 0)) DO_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 2, 1, 0), 0)) DO_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 3, 1, 0), 0)) DO_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 4, 1, 0), 0)) DO_4CARR_CELL_NUM
                              FROM (SELECT RELATED_BSC BSC,RELATED_BTS BTS, RELATED_CELL CELL,CITY_ID, BUSTYPE, COUNT(DISTINCT CARRIER_ID) CNT
                                      FROM NE_CARRIER_C T
                                     GROUP BY RELATED_BTS,
                                              T.RELATED_BSC,
                                              RELATED_CELL,
                                              CITY_ID,
                                              BUSTYPE)
                             GROUP BY CELL, CITY_ID) T5,
                           (SELECT DISTINCT NE_CELL_ID, CELL_NAME, CITY_ID, CITY_NAME
                              FROM CFG_MAP_DEV_TO_NE) T
                     WHERE T.NE_CELL_ID = T3.CELL(+)
                       AND T.NE_CELL_ID = T4.CELL(+)
                       AND T.NE_CELL_ID = T5.CELL(+) 
                       AND T.CITY_ID = T3.CITY_ID(+)
                       AND T.CITY_ID = T4.CITY_ID(+)
                       AND T.CITY_ID = T5.CITY_ID(+) ) R  On (S1.NE_SYS_ID = R.NE_CELL_ID) 
     where  S1.START_TIME&gt;=TO_DATE('%%Y-%%M-%%D 00:00:00','YYYY-MM-DD HH24:MI:SS') AND  S1.START_TIME&lt;=TO_DATE('%%Y-%%M-%%D 23:59:59','YYYY-MM-DD HH24:MI:SS') ) "COUNTER" 
  group by "START_TIME_H", "START_TIME_DAY", "CITY_ID", "CITY_NAME", "GROUP_NAME", "GROUP_ID", "START_TIME" ) "UN" 
   group BY START_TIME, "CITY_NAME", "GROUP_NAME"
  ) "PC"
  union all -- 省
  select SCENE_LEVEL as "场景级别",to_char(START_TIME,'YYYY-MM-DD HH24:MI:SS') as "数据时间点", GROUP_NAME as "场景名称", '${province_cn}' as "省份",'' as "城市", Round( PC1 ,4) "MD1.6", Round( (decode( PC3 ,0,1, PC2  /  PC3 ))  *  100 ,4) "MD1.10", Round( PC4 ,4) "MD1.11", Round( (decode( PC6 ,0,1, PC5  /  PC6 ))  *  100 ,4) "MD2.1", Round( (decode( PC8 ,0,1, PC7  /  PC8 ))  *  100 ,4) "MD2.2", Round( (decode( PC10 ,0,1, PC9  /  PC10 ))  *  100 ,4) "MD2.3", Round( PC11 ,4) "MD2.4", Round( PC12 ,4) "MD2.5", Round( PC13 ,4) "MD2.6", Round( PC14 ,4) "MD2.7", Round( (decode( PC16 ,0,1, PC15  /  PC16 ))  *  100 ,4) "MD2.8", Round( PC17 ,4) "MD2.9", Round( PC18 ,4) "MD2.10", Round( PC19 ,4) "MD2.13", Round( PC20 ,4) "MD2.14", Round( PC21 ,4) "MD2.15", Round( PC22 ,4) "MD2.16", Round( PC23 ,4) "MD2.17", Round( PC24 ,4) "MD2.18", Round( PC25 ,4) "MD2.19", Round( PC26 ,4) "MD2.20", Round( PC27 ,4) "MD2.21", Round( (decode( PC29 ,0,1, PC28  /  PC29 ))  *  100 ,4) "MD2.22", Round( (decode( PC31 ,0,1, PC30  /  PC31 ))  *  100 ,4) "MD2.23", Round( PC32 ,4) "MD2.26", Round( PC33 ,4) "MD2.27", Round( PC34 ,4) "MD2.28", Round( (decode( PC36 ,0,1, PC35  /  PC36 ))  *  100 ,4) "MD3.1", Round( PC37 ,4) "MD3.2", Round( PC38 ,4) "MD3.3", Round( PC39 ,4) "MD3.4", Round( PC40 ,4) "MD5.1", Round( PC41 ,4) "MD5.2", Round( PC42 ,4) "MD5.3", Round( PC43 ,4) "MD5.4", Round( (decode( PC45 ,0,1, PC44  /  PC45 ))  *  100 ,4) "MD5.5", Round( PC46 ,4) "MD6.9", Round( (decode( PC48 ,0,1, PC47  /  PC48 ))  *  100 ,4) "MD6.10", Round( PC49 ,4) "MD6.11", Round( (decode( PC51 ,0,1, PC50  /  PC51 ))  *  100 ,4) "MD6.12", Round( PC52 ,4) "MD6.13", Round( PC53 ,4) "MD6.14", Round( PC54 ,4) "MD6.15", Round( PC55 ,4) "MD6.16", Round( (decode( PC57 ,0,1, PC56  /  PC57 ))  *  100 ,4) "MD6.17", Round( (decode( PC59 ,0,1, PC58  /  PC59 ))  *  100 ,4) "MD6.18", Round( (decode( PC61 ,0,1, PC60  /  PC61 ))  *  100 ,4) "MD6.19", Round( (decode( PC63 ,0,1, PC62  /  PC63 ))  *  100 ,4) "MD7.4", Round( PC64 ,4) "MD7.5", Round( PC65 ,4) "MD7.6", Round( (decode( PC67 ,0,1, PC66  /  PC67 ))  *  100 ,4) "MD7.7", Round( PC68 ,4) "MD7.8", Round( PC69 ,4) "MD7.9", Round( (decode( PC71 ,0,1, PC70  /  PC71 ))  *  100 ,4) "MD7.10", Round( PC72 ,4) "MD7.11", Round( PC73 ,4) "MD7.12", Round( (decode( PC75 ,0,1, PC74  /  PC75 ))  *  100 ,4) "MD7.13", Round( PC76 ,4) "MD7.14", Round( PC77 ,4) "MD7.15", 
Round( PC78 ,4) "MD9.1", Round( PC79 ,4) "MD9.2", Round( PC80 ,4) "MD9.3", Round( PC81 ,4) "MD9.4",
Round( PC82 ,4) "MD9.5", Round( PC83 ,4) "MD9.6", Round( PC84 ,4) "MD9.7",
Round( PC85 ,4) "MD9.8", Round( PC86 ,4) "MD9.9", Round( PC87 ,4) "MD9.10", Round( PC88 ,4) "MD9.11", 
Round( PC89 ,4) "MD10.4", Round( PC90 ,4) "MD10.5", Round( PC91 ,4) "MD10.6", Round( PC92 ,4) "MD10.7", Round( PC93 ,4) "MD10.10", Round( PC94 ,4) "MD10.11", Round( PC95 ,4) "MD10.12", Round( PC96 ,4) "MD10.13", Round( PC97 ,4) "MD10.14", Round( PC98 ,4) "MD10.15", Round( PC99 ,4) "MD10.16", Round( PC100 ,4) "MD10.17", Round( PC101 ,4) "MD11.1", Round( PC102 ,4) "MD11.2", Round( PC103 ,4) "MD11.3", Round( PC104 ,4) "MD11.4", Round( PC105 ,4) "MD11.5"
from ( 
  select '省' as SCENE_LEVEL,START_TIME, GROUP_NAME, SUM(PC1) "PC1", SUM(PC2) "PC2", SUM(PC3) "PC3", SUM(PC4) "PC4", SUM(PC5) "PC5", SUM(PC6) "PC6", SUM(PC7) "PC7", SUM(PC8) "PC8", SUM(PC9) "PC9", SUM(PC10) "PC10", SUM(PC11) "PC11", SUM(PC12) "PC12", SUM(PC13) "PC13", SUM(PC14) "PC14", SUM(PC15) "PC15", SUM(PC16) "PC16", SUM(PC17) "PC17", SUM(PC18) "PC18", SUM(PC19) "PC19", SUM(PC20) "PC20", SUM(PC21) "PC21", SUM(PC22) "PC22", SUM(PC23) "PC23", SUM(PC24) "PC24", SUM(PC25) "PC25", SUM(PC26) "PC26", SUM(PC27) "PC27", SUM(PC28) "PC28", SUM(PC29) "PC29", SUM(PC30) "PC30", SUM(PC31) "PC31", SUM(PC32) "PC32", SUM(PC33) "PC33", SUM(PC34) "PC34", SUM(PC35) "PC35", SUM(PC36) "PC36", SUM(PC37) "PC37", SUM(PC38) "PC38", SUM(PC39) "PC39", SUM(PC40) "PC40", SUM(PC41) "PC41", SUM(PC42) "PC42", SUM(PC43) "PC43", SUM(PC44) "PC44", SUM(PC45) "PC45", SUM(PC46) "PC46", SUM(PC47) "PC47", SUM(PC48) "PC48", SUM(PC49) "PC49", SUM(PC50) "PC50", SUM(PC51) "PC51", SUM(PC52) "PC52", SUM(PC53) "PC53", SUM(PC54) "PC54", SUM(PC55) "PC55", SUM(PC56) "PC56", SUM(PC57) "PC57", SUM(PC58) "PC58", SUM(PC59) "PC59", SUM(PC60) "PC60", SUM(PC61) "PC61", SUM(PC62) "PC62", SUM(PC63) "PC63", SUM(PC64) "PC64", SUM(PC65) "PC65", SUM(PC66) "PC66", SUM(PC67) "PC67", SUM(PC68) "PC68", SUM(PC69) "PC69", SUM(PC70) "PC70", SUM(PC71) "PC71", SUM(PC72) "PC72", SUM(PC73) "PC73", SUM(PC74) "PC74", SUM(PC75) "PC75", SUM(PC76) "PC76", SUM(PC77) "PC77", SUM(PC78) "PC78", SUM(PC79) "PC79", SUM(PC80) "PC80", SUM(PC81) "PC81", SUM(PC82) "PC82", SUM(PC83) "PC83", SUM(PC84) "PC84", SUM(PC85) "PC85", SUM(PC86) "PC86", SUM(PC87) "PC87", SUM(PC88) "PC88", SUM(PC89) "PC89", SUM(PC90) "PC90", SUM(PC91) "PC91", SUM(PC92) "PC92", SUM(PC93) "PC93", SUM(PC94) "PC94", SUM(PC95) "PC95", SUM(PC96) "PC96", SUM(PC97) "PC97", SUM(PC98) "PC98", SUM(PC99) "PC99", SUM(PC100) "PC100", SUM(PC101) "PC101", SUM(PC102) "PC102", SUM(PC103) "PC103", SUM(PC104) "PC104", SUM(PC105) "PC105"
  from ( 
      --中兴MD
     select "START_TIME_DAY", "START_TIME_H", "COUNTER"."CITY_ID", "COUNTER"."CITY_NAME", "GROUP_NAME", "GROUP_ID", COUNT(1) "PC1", Round( ( SUM(C1) ) ,4) "PC2", Round( ( 0 ) ,4) "PC3", Round( SUM(C1) ,4) "PC4", Round( ( SUM(C2)  +  SUM(C3)  +  SUM(C4)  +  SUM(C5)  +  SUM(C6)  +  SUM(C7) ) ,4) "PC5", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C10)  +  SUM(C11)  +  SUM(C12)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C15)  +  SUM(C16)  +  SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20)  +  SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,4) "PC6", Round( ( SUM(C2)  +  SUM(C3) ) ,4) "PC7", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C10)  +  SUM(C11)  +  SUM(C12)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C15)  +  SUM(C16)  +  SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ,4) "PC8", Round( ( SUM(C4)  +  SUM(C5)  +  SUM(C6)  +  SUM(C7) ) ,4) "PC9", Round( ( SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,4) "PC10", Round( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C10)  +  SUM(C11)  +  SUM(C12)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C15)  +  SUM(C16)  +  SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ,4) "PC11", Round( SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ,4) "PC12", Round( SUM(C2)  +  SUM(C3) ,4) "PC13", Round( SUM(C4)  +  SUM(C5)  +  SUM(C6)  +  SUM(C7) ,4) "PC14", Round( ( SUM(C47)  +  SUM(C48)  +  SUM(C49)  +  SUM(C50) ) ,4) "PC15", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C12)  +  SUM(C10)  +  SUM(C11)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C17)  +  SUM(C15)  +  SUM(C16)  +  SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C25)  +  SUM(C23)  +  SUM(C24)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C30)  +  SUM(C28)  +  SUM(C29)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C38)  +  SUM(C36)  +  SUM(C37)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C43)  +  SUM(C41)  +  SUM(C42) ) ,4) "PC16", Round( ( SUM(C47)  +  SUM(C48)  +  SUM(C49)  +  SUM(C50) ) ,4) "PC17", Round( ( SUM(C2)  +  SUM(C8)  +  SUM(C9)  +  SUM(C12)  +  SUM(C10)  +  SUM(C11)  +  SUM(C3)  +  SUM(C13)  +  SUM(C14)  +  SUM(C17)  +  SUM(C15)  +  SUM(C16)  +  SUM(C4)  +  SUM(C21)  +  SUM(C22)  +  SUM(C25)  +  SUM(C23)  +  SUM(C24)  +  SUM(C5)  +  SUM(C26)  +  SUM(C27)  +  SUM(C30)  +  SUM(C28)  +  SUM(C29)  +  SUM(C6)  +  SUM(C34)  +  SUM(C35)  +  SUM(C38)  +  SUM(C36)  +  SUM(C37)  +  SUM(C7)  +  SUM(C39)  +  SUM(C40)  +  SUM(C43)  +  SUM(C41)  +  SUM(C42) ) ,4) "PC18", Round( SUM(C9)  +  SUM(C14)  +  SUM(C19)  +  SUM(C22)  +  SUM(C27)  +  SUM(C32)  +  SUM(C35)  +  SUM(C40)  +  SUM(C45) ,4) "PC19", Round( SUM(C10)  +  SUM(C15)  +  SUM(C23)  +  SUM(C28)  +  SUM(C36)  +  SUM(C41) ,4) "PC20", Round( SUM(C11)  +  SUM(C16)  +  SUM(C24)  +  SUM(C29)  +  SUM(C37)  +  SUM(C42) ,4) "PC21", Round( ( SUM(C51)  +  SUM(C52) ) ,4) "PC22", Round( ( SUM(C51)  +  SUM(C52)  -  SUM(C52) ) ,4) "PC23", Round( ( SUM(C52) ) ,4) "PC24", Round( ( SUM(C53) ) ,4) "PC25", Round( ( SUM(C54) ) ,4) "PC26", Round( ( SUM(C55) ) ,4) "PC27", Round( ( SUM(C53)  +  SUM(C54)  +  SUM(C55) ) ,4) "PC28", Round( ( SUM(C53)  +  SUM(C54)  +  SUM(C55)  +  SUM(C51)  +  SUM(C52) ) ,4) "PC29", Round( ( ( SUM(C52)  +  SUM(C53)  +  SUM(C54)  +  SUM(C55) ) ) ,4) "PC30", Round( ( ( SUM(C51)  +  SUM(C52)  +  SUM(C53)  +  SUM(C54)  +  SUM(C55) ) ) ,4) "PC31", Round( ( 100  *  (decode( ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) ,0,1, SUM(C56)  /  ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) )) ) ,4) "PC32", Round( ( ( 100  * decode( ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) ,0,1, ( SUM(C57)  +  SUM(C58) )  /  ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) )) ) ,4) "PC33", Round( ( 100  *  (decode( ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) ,0,1, SUM(C59)  /  ( SUM(C56)  +  SUM(C57)  +  SUM(C58)  +  SUM(C59) ) )) ) ,4) "PC34", Round( ( SUM(C60) ) ,4) "PC35", Round( ( SUM(C61) ) ,4) "PC36", Round( ( SUM(C61) ) ,4) "PC37", Round( ( SUM(C60) ) ,4) "PC38", Round( SUM(C61)  -  SUM(C60) ,4) "PC39", Round( ( SUM(C62) ) ,4) "PC40", Round( ( SUM(C63)  /  3600 ) ,4) "PC41", Round( ( ( SUM(C63)  +  SUM(C64) )  /  3600 ) ,4) "PC42", Round( ( ( SUM(C63)  +  SUM(C64) )  /  3600 )  -  ( SUM(C63)  /  3600 ) ,4) "PC43", Round( ( ( ( SUM(C63)  +  SUM(C64) )  /  3600 )  -  ( SUM(C63)  /  3600 ) ) ,4) "PC44", Round( ( ( SUM(C63)  /  3600 ) ) ,4) "PC45", Round( ( ( ( SUM(C65)  +  SUM(C66) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC46", Round( ( SUM(C66) ) ,4) "PC47", Round( ( SUM(C65)  -  SUM(C66)  +  SUM(C66) ) ,4) "PC48", Round( ( ( ( SUM(C67)  +  SUM(C68)  -  SUM(C69)  +  SUM(C69) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC49", Round( ( SUM(C69) ) ,4) "PC50", Round( ( SUM(C67)  +  SUM(C68)  -  SUM(C69)  +  SUM(C69) ) ,4) "PC51", Round( ( ( SUM(C70)  +  SUM(C71) )  *  ( 8  /  1000 )  /  3600 ) ,4) "PC52", Round( ( SUM(C70)  +  SUM(C71) )  *  (decode( ( ( AVG(C72)  +  AVG(C73) )  *  1.667 ) ,0,1, 8  /  ( ( AVG(C72)  +  AVG(C73) )  *  1.667 ) )) ,4) "PC53", Round( ( ( SUM(C74)  +  SUM(C75) )  *  ( 8  /  1000 )  /  3600 ) ,4) "PC54", Round( ( (decode( ( AVG(C76)  *  1.667  /  1000 ) ,0,1, ( ( SUM(C74)  +  SUM(C75) )  *  8 )  /  ( AVG(C76)  *  1.667  /  1000 ) ))  /  1000 ) ,4) "PC55", Round( ( ( AVG(C72)  +  AVG(C73) )  *  ( 1.667  /  3600000 )  *  100 ) ,4) "PC56", Round( 100 ,4) "PC57", Round( ( 100  *  ( AVG(C77)  *  ( 1.667  /  1000 )  /  3600 ) ) ,4) "PC58", Round( 100 ,4) "PC59", Round( ( 100  *  ( AVG(C78)  +  AVG(C79) )  *  ( 16  *  ( 1.667  /  1000 )  /  3600 ) ) ,4) "PC60", Round( 100 ,4) "PC61", Round( ( SUM(C80)  +  SUM(C81)  +  SUM(C82) ) ,4) "PC62", Round( ( SUM(C83)  +  SUM(C84)  +  SUM(C85) ) ,4) "PC63", Round( ( SUM(C83)  +  SUM(C84)  +  SUM(C85) ) ,4) "PC64", Round( ( SUM(C80)  +  SUM(C81)  +  SUM(C82) ) ,4) "PC65", Round( ( SUM(C86)  +  SUM(C87) ) ,4) "PC66", Round( ( SUM(C88)  +  SUM(C89) ) ,4) "PC67", Round( ( SUM(C88)  +  SUM(C89) ) ,4) "PC68", Round( ( SUM(C86)  +  SUM(C87) ) ,4) "PC69", Round( ( SUM(C90) ) ,4) "PC70", Round( ( SUM(C91) ) ,4) "PC71", Round( ( SUM(C91) ) ,4) "PC72", Round( ( SUM(C90) ) ,4) "PC73", Round( ( SUM(C92) ) ,4) "PC74", Round( ( SUM(C93) ) ,4) "PC75", Round( ( SUM(C93) ) ,4) "PC76", Round( ( SUM(C92) ) ,4) "PC77",
     SUM(CARR_37_NUM) "PC78", SUM(CARR_78_NUM) "PC79", SUM(CARR_119_NUM) "PC80", SUM(DO_CELL_TOTAL_NUM) "PC81",
     Round( 0 ,4) "PC82", Round( 0 ,4) "PC83", Round( 0 ,4) "PC84",
    SUM(DO_1CARR_CELL_NUM) "PC85", SUM(DO_2CARR_CELL_NUM) "PC86", SUM(DO_3CARR_CELL_NUM) "PC87", COUNT(1) "PC88",
     Round( SUM(C66) ,4) "PC89", Round( SUM(C66)  +  SUM(C65) ,4) "PC90", Round( SUM(C69) ,4) "PC91", Round( SUM(C67)  +  SUM(C68) ,4) "PC92", Round( 0 ,4) "PC93", Round( SUM(C56) ,4) "PC94", Round( SUM(C57)  +  SUM(C58) ,4) "PC95", Round( SUM(C59) ,4) "PC96", Round( ( SUM(C70)  +  SUM(C71) )  *  8 ,4) "PC97", Round( ( AVG(C72)  +  AVG(C73) )  *  ( 1.667  /  1000 ) ,4) "PC98", Round( ( SUM(C74)  +  SUM(C75) )  *  8 ,4) "PC99", Round( AVG(C76)  *  ( 1.667  /  1000 ) ,4) "PC100", Round( 0 ,4) "PC101", Round( 0 ,4) "PC102", Round( 0 ,4) "PC103", Round( 0 ,4) "PC104", Round( 0 ,4) "PC105", "START_TIME" 
     from (
       select "S1"."START_TIME", to_char(S1.START_TIME,'YYYY-MM-DD') "START_TIME_DAY", to_char(S1.START_TIME,'HH24') "START_TIME_H", "S1"."CITY_ID", "S1"."CITY_NAME", "GROUP_NAME", "GROUP_ID", "S1"."P821_USERNUM" "C1", "S1"."P801_CMO_CALLSNUM" "C2", "S1"."P819_CMO_CALLSUCCESSNUM" "C3", "S1"."P801_CMT_CALLSNUM" "C4", "S1"."P819_CMT_CALLSUCCESSNUM" "C5", "S1"."P801_FMT_CALLSNUM" "C6", "S1"."P819_FMT_CALLSUCCESSNUM" "C7", "S1"."P801_CMO_EXTINTERRUPTNUM" "C8", "S1"."P801_CMO_BLOCKFNUM" "C9", "S1"."P801_CMO_RTCHCAPFNUM" "C10", "S1"."P801_CMO_TCCTIMEOUTFNUM" "C11", "S1"."P801_CMO_OTHERFNUM" "C12", "S1"."P819_CMO_EXTINTERRUPTNUM" "C13", "S1"."P819_CMO_BLOCKFAILURENUM" "C14", "S1"."P819_CMO_RTCHCAPFNUM" "C15", "S1"."P819_CMO_TCCTIMEOUTFNUM" "C16", "S1"."P819_CMO_OTHERFAILURENUM" "C17", "S1"."P822_CMO_EXTINTERRUPTNUM" "C18", "S1"."P822_CMO_BLOCKFAILURENUM" "C19", "S1"."P822_CMO_OTHERFAILURENUM" "C20", "S1"."P801_CMT_EXTINTERRUPTNUM" "C21", "S1"."P801_CMT_BLOCKFNUM" "C22", "S1"."P801_CMT_RTCHCAPFNUM" "C23", "S1"."P801_CMT_TCCTIMEOUTFNUM" "C24", "S1"."P801_CMT_OTHERFNUM" "C25", "S1"."P819_CMT_EXTINTERRUPTNUM" "C26", "S1"."P819_CMT_BLOCKFAILURENUM" "C27", "S1"."P819_CMT_RTCHCAPFNUM" "C28", "S1"."P819_CMT_TCCTIMEOUTFNUM" "C29", "S1"."P819_CMT_OTHERFAILURENUM" "C30", "S1"."P822_CMT_EXTINTERRUPTNUM" "C31", "S1"."P822_CMT_BLOCKFAILURENUM" "C32", "S1"."P822_CMT_OTHERFAILURENUM" "C33", "S1"."P801_FMT_EXTINTERRUPTNUM" "C34", "S1"."P801_FMT_BLOCKFNUM" "C35", "S1"."P801_FMT_RTCHCAPFNUM" "C36", "S1"."P801_FMT_TCCTIMEOUTFNUM" "C37", "S1"."P801_FMT_OTHERFNUM" "C38", "S1"."P819_FMT_EXTINTERRUPTNUM" "C39", "S1"."P819_FMT_BLOCKFAILURENUM" "C40", "S1"."P819_FMT_RTCHCAPFNUM" "C41", "S1"."P819_FMT_TCCTIMEOUTFNUM" "C42", "S1"."P819_FMT_OTHERFAILURENUM" "C43", "S1"."P822_FMT_EXTINTERRUPTNUM" "C44", "S1"."P822_FMT_BLOCKFAILURENUM" "C45", "S1"."P822_FMT_OTHERFAILURENUM" "C46", "S1"."P801_MO_WIRENETCALLSUCNUM" "C47", "S1"."P801_MT_WIRENETSUCNUM" "C48", "S1"."P819_MO_WIRENETCALLSUCNUM" "C49", "S1"."P819_MT_WIRENETSUCNUM" "C50", "S1"."P803_RLSSNUM" "C51", "S1"."P803_PDSNRELEASENUM" "C52", "S1"."P803_AIRLINKLOSTDROPNUM" "C53", "S1"."P803_HHODROPNUM" "C54", "S1"."P803_OTHERDROPNUM" "C55", "S1"."P840_RANGE1REQNUM" "C56", "S1"."P840_RANGE2REQNUM" "C57", "S1"."P840_RANGE3REQNUM" "C58", "S1"."P840_RANGE4REQNUM" "C59", "S1"."P820_SETUPSUCCESSNUM" "C60", "S1"."P820_SETUPATTEMPTNUM" "C61", "S1"."P815_EQUUSERNUM" "C62", "S1"."P804_CALLDURATION" "C63", "S1"."P804_SHODURATION" "C64", "S1"."P821_TXBYTENUM" "C65", "S1"."P821_RETXBYTENUM" "C66", "S1"."P807_REVAREVTCHMACBYTES" "C67", "S1"."P807_RLS0REVTCHMACBYTES" "C68", "S1"."P821_REREBYTENUM" "C69", "S1"."P806_REVAFWDTCHPHYBYTES" "C70", "S1"."P806_RLS0FWDTCHPHYBYTES" "C71", "S1"."P806_REVAFWDTCHSENDSLOTNUM" "C72", "S1"."P806_RLS0FWDTCHSENDSLOTNUM" "C73", "S1"."P807_REVAREVTCHPHYBYTES" "C74", "S1"."P807_RLS0REVTCHPHYBYTES" "C75", "S1"."P815_REVSLOTNUM" "C76", "S1"."P806_FWDCCHSENDSLOTNUM" "C77", "S1"."P815_SUCCESSCAPSULENUM" "C78", "S1"."P815_FAILURECAPSULENUM" "C79", "S1"."P802_SRCANTGTHO_SFTSUCCESSNUM" "C80", "S1"."P802_SRCANTGTHO_SFRSUCCESSNUM" "C81", "S1"."P802_SRCANTGTHO_AFRSUCCESSNUM" "C82", "S1"."P802_SRCANTGTHO_SFTREQUESTNUM" "C83", "S1"."P802_SRCANTGTHO_SFRREQUESTNUM" "C84", "S1"."P802_SRCANTGTHO_AFRREQESTNUM" "C85", "S1"."P802_INTERANSRCHOOUT_SUCCESSNU" "C86", "S1"."P826_INTERANTGTHOIN_SUCCESSNUM" "C87", "S1"."P802_INTERANSRCHOOUT_REQUESTNU" "C88", "S1"."P826_INTERANTGTHOIN_REQESTNUM" "C89", "S1"."P802_SRCANTGTHO_IFRSUCCESSNUM" "C90", "S1"."P802_SRCANTGTHO_IFRREQUESTNUM" "C91", "S1"."P825_HARDHOADD_SUCCESSNUM" "C92", "S1"."P825_HARDHOADD_REQESTNUM" "C93",
       R.CARR_37_NUM, R.CARR_78_NUM, R.CARR_119_NUM, R.DO_CELL_TOTAL_NUM,R.DO_1CARR_CELL_NUM, R.DO_2CARR_CELL_NUM, R.DO_3CARR_CELL_NUM
       from "DS_COUNTER_GROUP_ZTE_TC_DO_1" "S1" inner join ( select distinct g.group_id,g.group_name,ne.CITY_ID , n.ne_sys_id, n.china_name, n.vendor from (select * from mod_negroup_group g where  Group_name LIKE 'HQ_%' and city_id= 0  ) g,mod_negroup_ne n,NE_CELL_C ne where n.group_id = g.group_id and n.ne_sys_id = ne.ne_sys_id ) "NEGROUP" on ("S1"."NE_SYS_ID" = "NEGROUP"."NE_SYS_ID" and "S1"."CITY_ID" = "NEGROUP"."CITY_ID")  inner join ( SELECT T.NE_CELL_ID,CELL_NAME,T.CITY_ID, CITY_NAME,  CELL_283_NUM, CELL_201_NUM,  CELL_242_NUM,
                           CELL_160_NUM,ONEX_CELL_TOTAL_NUM, ONEX_1CARR_CELL_NUM, ONEX_2CARR_CELL_NUM, ONEX_3CARR_CELL_NUM, ONEX_4CARR_CELL_NUM, 0 WIRELESS_CAPACITY,
                           CARR_37_NUM, CARR_78_NUM,  CARR_119_NUM, DO_1CARR_CELL_NUM,  DO_2CARR_CELL_NUM, DO_3CARR_CELL_NUM, DO_CELL_TOTAL_NUM
                      FROM (SELECT CELL,  CITY_ID, SUM(DECODE(CELL_283, 0, 0, 1)) CELL_283_NUM, SUM(DECODE(CELL_201, 0, 0, 1)) CELL_201_NUM, SUM(DECODE(CELL_242, 0, 0, 1)) CELL_242_NUM,
                                   SUM(DECODE(CELL_160, 0, 0, 1)) CELL_160_NUM
                              FROM (SELECT DISTINCT RELATED_CELL CELL, CITY_ID, BUSTYPE, DECODE(CARRIER_ID, 283, RELATED_CELL, 0) CELL_283, DECODE(CARRIER_ID, 201, RELATED_CELL, 0) CELL_201, DECODE(CARRIER_ID, 242, RELATED_CELL, 0) CELL_242, DECODE(CARRIER_ID, 160, RELATED_CELL, 0) CELL_160
                                      FROM NE_CARRIER_C T
                                     WHERE T.BUSTYPE = '1X')
                             GROUP BY CELL, CITY_ID) T3,
                           (SELECT RELATED_CELL CELL, CITY_ID,SUM(DECODE(CARRIER_ID, 37, 1, 0)) CARR_37_NUM,SUM(DECODE(CARRIER_ID, 78, 1, 0)) CARR_78_NUM, SUM(DECODE(CARRIER_ID, 119, 1, 0)) CARR_119_NUM
                              FROM NE_CARRIER_C T
                             WHERE T.BUSTYPE = 'DO'
                             GROUP BY RELATED_CELL, CITY_ID) T4,
                           (SELECT CELL, CITY_ID,
                                   SUM(DECODE(BUSTYPE, '1X', 1, 0)) ONEX_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', 1, 0)) DO_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 1, 1, 0), 0)) ONEX_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 2, 1, 0), 0)) ONEX_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 3, 1, 0), 0)) ONEX_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 4, 1, 0), 0)) ONEX_4CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 1, 1, 0), 0)) DO_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 2, 1, 0), 0)) DO_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 3, 1, 0), 0)) DO_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 4, 1, 0), 0)) DO_4CARR_CELL_NUM
                              FROM (SELECT RELATED_BSC BSC,RELATED_BTS BTS, RELATED_CELL CELL,CITY_ID, BUSTYPE, COUNT(DISTINCT CARRIER_ID) CNT
                                      FROM NE_CARRIER_C T
                                     GROUP BY RELATED_BTS,
                                              T.RELATED_BSC,
                                              RELATED_CELL,
                                              CITY_ID,
                                              BUSTYPE)
                             GROUP BY CELL, CITY_ID) T5,
                           (SELECT DISTINCT NE_CELL_ID, CELL_NAME, CITY_ID, CITY_NAME
                              FROM CFG_MAP_DEV_TO_NE) T
                     WHERE T.NE_CELL_ID = T3.CELL(+)
                       AND T.NE_CELL_ID = T4.CELL(+)
                       AND T.NE_CELL_ID = T5.CELL(+) 
                       AND T.CITY_ID = T3.CITY_ID(+)
                       AND T.CITY_ID = T4.CITY_ID(+)
                       AND T.CITY_ID = T5.CITY_ID(+) ) R  On (S1.NE_SYS_ID = R.NE_CELL_ID) 
       where  S1.START_TIME&gt;=TO_DATE('%%Y-%%M-%%D 00:00:00','YYYY-MM-DD HH24:MI:SS') AND  S1.START_TIME&lt;=TO_DATE('%%Y-%%M-%%D 23:59:59','YYYY-MM-DD HH24:MI:SS')  ) "COUNTER" 
     group by "START_TIME_H", "START_TIME_DAY", "CITY_ID", "CITY_NAME", "GROUP_NAME", "GROUP_ID", "START_TIME" 
     union all --华为MD
     select "START_TIME_DAY", "START_TIME_H", "COUNTER"."CITY_ID", "COUNTER"."CITY_NAME", "GROUP_NAME", "GROUP_ID", COUNT(1) "PC1", Round( ( SUM(C1)  +  SUM(C2) ) ,4) "PC2", Round( ( SUM(C3) ) ,4) "PC3", Round( SUM(C1)  +  SUM(C2) ,4) "PC4", Round( ( (decode( ( SUM(C6)  +  SUM(C7) ) ,0,1, ( SUM(C4)  +  SUM(C5) )  /  ( SUM(C6)  +  SUM(C7) ) ))  *  100 ) ,4) "PC5", Round( 1 ,4) "PC6", Round( ( (decode( SUM(C6) ,0,1, SUM(C4)  /  SUM(C6) )) )  *  100 ,4) "PC7", Round( 1 ,4) "PC8", Round( ( (decode( SUM(C7) ,0,1, SUM(C5)  /  SUM(C7) )) )  *  100 ,4) "PC9", Round( 1 ,4) "PC10", Round( SUM(C6) ,4) "PC11", Round( SUM(C7) ,4) "PC12", Round( SUM(C4) ,4) "PC13", Round( SUM(C5) ,4) "PC14", Round( ( SUM(C8) ) ,4) "PC15", Round( ( SUM(C9) ) ,4) "PC16", Round( ( SUM(C8) ) ,4) "PC17", Round( ( SUM(C9) ) ,4) "PC18", Round( SUM(C10)  +  SUM(C11) ,4) "PC19", Round( SUM(C12)  +  SUM(C13) ,4) "PC20", Round( SUM(C14)  +  SUM(C15) ,4) "PC21", Round( ( SUM(C16) ) ,4) "PC22", Round( ( SUM(C16)  -  SUM(C17) ) ,4) "PC23", Round( ( SUM(C17) ) ,4) "PC24", Round( ( SUM(C18) ) ,4) "PC25", Round( ( SUM(C19) ) ,4) "PC26", Round( ( SUM(C20) ) ,4) "PC27", Round( ( SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ,4) "PC28", Round( ( SUM(C18)  +  SUM(C19)  +  SUM(C20)  +  SUM(C16) ) ,4) "PC29", Round( ( ( SUM(C17)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ) ,4) "PC30", Round( ( ( SUM(C16)  +  SUM(C18)  +  SUM(C19)  +  SUM(C20) ) ) ,4) "PC31", Round( ( ( 100  * decode( ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,0,1, ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26) )  /  ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) )) ) ,4) "PC32", Round( ( ( 100  * decode( ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,0,1, ( SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40) )  /  ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) )) ) ,4) "PC33", Round( ( ( 100  * decode( ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) ,0,1, ( SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) )  /  ( SUM(C21)  +  SUM(C22)  +  SUM(C23)  +  SUM(C24)  +  SUM(C25)  +  SUM(C26)  +  SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33)  +  SUM(C34)  +  SUM(C35)  +  SUM(C36)  +  SUM(C37)  +  SUM(C38)  +  SUM(C39)  +  SUM(C40)  +  SUM(C41)  +  SUM(C42)  +  SUM(C43)  +  SUM(C44)  +  SUM(C45)  +  SUM(C46) ) )) ) ,4) "PC34", Round( ( SUM(C47) ) ,4) "PC35", Round( ( SUM(C48) ) ,4) "PC36", Round( ( SUM(C48) ) ,4) "PC37", Round( ( SUM(C47) ) ,4) "PC38", Round( SUM(C49)  +  SUM(C50)  +  SUM(C51)  +  SUM(C52) ,4) "PC39", Round( ( SUM(C53)  *  ( 0.001667  /  3600 ) ) ,4) "PC40", Round( ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ,4) "PC41", Round( ( ( ( SUM(C88)  +  ( SUM(C89)  /  2 )  +  ( ( SUM(C57)  +  SUM(C61)  +  SUM(C90)  +  SUM(C91) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C92)  +  SUM(C93) )  /  4 )  +  ( ( SUM(C94)  +  SUM(C95) )  /  5 )  +  ( SUM(C96)  /  6 ) )  +  ( SUM(C97)  +  ( SUM(C98)  /  2 )  +  ( ( SUM(C69)  +  SUM(C73)  +  SUM(C99)  +  SUM(C100) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C101)  +  SUM(C102) )  /  4 )  +  ( ( SUM(C103)  +  SUM(C104) )  /  5 )  +  ( SUM(C105)  /  6 ) )  +  ( SUM(C106)  /  30 ) )  /  3600 ) ,4) "PC42", Round( ( ( ( SUM(C88)  +  ( SUM(C89)  /  2 )  +  ( ( SUM(C57)  +  SUM(C61)  +  SUM(C90)  +  SUM(C91) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C92)  +  SUM(C93) )  /  4 )  +  ( ( SUM(C94)  +  SUM(C95) )  /  5 )  +  ( SUM(C96)  /  6 ) )  +  ( SUM(C97)  +  ( SUM(C98)  /  2 )  +  ( ( SUM(C69)  +  SUM(C73)  +  SUM(C99)  +  SUM(C100) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C101)  +  SUM(C102) )  /  4 )  +  ( ( SUM(C103)  +  SUM(C104) )  /  5 )  +  ( SUM(C105)  /  6 ) )  +  ( SUM(C106)  /  30 ) )  /  3600 )  -  ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ,4) "PC43", Round( ( ( ( ( SUM(C88)  +  ( SUM(C89)  /  2 )  +  ( ( SUM(C57)  +  SUM(C61)  +  SUM(C90)  +  SUM(C91) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C92)  +  SUM(C93) )  /  4 )  +  ( ( SUM(C94)  +  SUM(C95) )  /  5 )  +  ( SUM(C96)  /  6 ) )  +  ( SUM(C97)  +  ( SUM(C98)  /  2 )  +  ( ( SUM(C69)  +  SUM(C73)  +  SUM(C99)  +  SUM(C100) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C101)  +  SUM(C102) )  /  4 )  +  ( ( SUM(C103)  +  SUM(C104) )  /  5 )  +  ( SUM(C105)  /  6 ) )  +  ( SUM(C106)  /  30 ) )  /  3600 )  -  ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ) ,4) "PC44", Round( ( ( ( ( SUM(C54)  +  ( ( SUM(C55)  +  SUM(C56) )  /  2 )  +  ( ( SUM(C57)  +  SUM(C58)  +  SUM(C59) )  /  3 )  +  ( ( SUM(C60)  +  SUM(C61)  +  SUM(C62)  +  SUM(C63) )  /  4 )  +  ( SUM(C64)  /  5 )  +  ( SUM(C65)  /  6 ) )  +  ( SUM(C66)  +  ( ( SUM(C67)  +  SUM(C68) )  /  2 )  +  ( ( SUM(C69)  +  SUM(C70)  +  SUM(C71) )  /  3 )  +  ( ( SUM(C72)  +  SUM(C73)  +  SUM(C74)  +  SUM(C75) )  /  4 )  +  ( SUM(C76)  /  5 )  +  ( SUM(C77)  /  6 ) )  +  ( SUM(C78)  +  ( SUM(C79)  /  10 )  +  ( SUM(C80)  /  11 )  +  ( SUM(C81)  /  12 )  +  ( SUM(C82)  /  13 )  +  ( SUM(C83)  /  14 )  +  ( SUM(C84)  /  15 )  +  ( SUM(C85)  /  16 )  +  ( SUM(C86)  /  17 )  +  ( SUM(C87)  /  18 ) ) )  /  3600 ) ) ,4) "PC45", Round( ( ( ( SUM(C107)  +  SUM(C108) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC46", Round( ( SUM(C108) ) ,4) "PC47", Round( ( SUM(C107)  +  SUM(C108) ) ,4) "PC48", Round( ( ( ( SUM(C109)  *  1024  -  SUM(C110)  +  SUM(C110) )  *  ( 8  /  1000 )  /  3600 ) ) ,4) "PC49", Round( ( SUM(C110) ) ,4) "PC50", Round( ( SUM(C109)  *  1024  -  SUM(C110)  +  SUM(C110) ) ,4) "PC51", Round( ( SUM(C111)  /  3600 ) ,4) "PC52", Round( (decode( ( 0.001667  *  SUM(C112) ) ,0,1, SUM(C111)  /  ( 0.001667  *  SUM(C112) ) )) ,4) "PC53", Round( (decode( ( 1000  *  3600 ) ,0,1, ( ( SUM(C113)  +  SUM(C114)  +  SUM(C115)  +  SUM(C116) )  *  256  +  ( SUM(C117)  +  SUM(C118)  +  SUM(C119)  +  SUM(C120) )  *  512  +  ( SUM(C121)  +  SUM(C122)  +  SUM(C123)  +  SUM(C124) )  *  1024  +  ( SUM(C125)  +  SUM(C126)  +  SUM(C127)  +  SUM(C128) )  *  2048  +  ( SUM(C129)  +  SUM(C130)  +  SUM(C131)  +  SUM(C132) )  *  4096  +  SUM(C133)  *  128  +  SUM(C134)  *  256  +  SUM(C135)  *  512  +  SUM(C136)  *  768  +  SUM(C137)  *  1024  +  SUM(C138)  *  1536  +  SUM(C139)  *  2048  +  SUM(C140)  *  3072  +  SUM(C141)  *  4096  +  SUM(C142)  *  6144  +  SUM(C143)  *  8192  +  SUM(C144)  *  12288  +  SUM(C145)  *  128  +  SUM(C146)  *  256  +  SUM(C147)  *  512  +  SUM(C148)  *  768  +  SUM(C149)  *  1024  +  SUM(C150)  *  1536  +  SUM(C151)  *  2048  +  SUM(C152)  *  3072  +  SUM(C153)  *  4096  +  SUM(C154)  *  6144  +  SUM(C155)  *  8192  +  SUM(C156)  *  12288 )  /  ( 1000  *  3600 ) )) ,4) "PC54", Round( (decode( ( 1000  *  SUM(C157) ) ,0,1, ( ( SUM(C113)  +  SUM(C114)  +  SUM(C115)  +  SUM(C116) )  *  256  +  ( SUM(C117)  +  SUM(C118)  +  SUM(C119)  +  SUM(C120) )  *  512  +  ( SUM(C121)  +  SUM(C122)  +  SUM(C123)  +  SUM(C124) )  *  1024  +  ( SUM(C125)  +  SUM(C126)  +  SUM(C127)  +  SUM(C128) )  *  2048  +  ( SUM(C129)  +  SUM(C130)  +  SUM(C131)  +  SUM(C132) )  *  4096  +  SUM(C133)  *  128  +  SUM(C134)  *  256  +  SUM(C135)  *  512  +  SUM(C136)  *  768  +  SUM(C137)  *  1024  +  SUM(C138)  *  1536  +  SUM(C139)  *  2048  +  SUM(C140)  *  3072  +  SUM(C141)  *  4096  +  SUM(C142)  *  6144  +  SUM(C143)  *  8192  +  SUM(C144)  *  12288  +  SUM(C145)  *  128  +  SUM(C146)  *  256  +  SUM(C147)  *  512  +  SUM(C148)  *  768  +  SUM(C149)  *  1024  +  SUM(C150)  *  1536  +  SUM(C151)  *  2048  +  SUM(C152)  *  3072  +  SUM(C153)  *  4096  +  SUM(C154)  *  6144  +  SUM(C155)  *  8192  +  SUM(C156)  *  12288 )  /  ( 1000  *  SUM(C157) ) )) ,4) "PC55", Round( ( ( AVG(C158)  /  100 ) ) ,4) "PC56", Round( 100 ,4) "PC57", Round( ( AVG(C159)  +  AVG(C160) ) ,4) "PC58", Round( 100 ,4) "PC59", Round( ( AVG(C161) ) ,4) "PC60", Round( 100 ,4) "PC61", Round( ( SUM(C162) ) ,4) "PC62", Round( ( SUM(C163) ) ,4) "PC63", Round( ( SUM(C163) ) ,4) "PC64", Round( ( SUM(C162) ) ,4) "PC65", Round( ( SUM(C164)  +  SUM(C165) ) ,4) "PC66", Round( ( SUM(C166)  +  SUM(C167) ) ,4) "PC67", Round( ( SUM(C166)  +  SUM(C167) ) ,4) "PC68", Round( ( SUM(C164)  +  SUM(C165) ) ,4) "PC69", Round( ( SUM(C168) ) ,4) "PC70", Round( ( SUM(C169) ) ,4) "PC71", Round( ( SUM(C169) ) ,4) "PC72", Round( ( SUM(C168) ) ,4) "PC73", Round( ( SUM(C170)  +  SUM(C171) ) ,4) "PC74", Round( ( SUM(C172)  +  SUM(C173) ) ,4) "PC75", Round( ( SUM(C172)  +  SUM(C173) ) ,4) "PC76", Round( ( SUM(C170)  +  SUM(C171) ) ,4) "PC77",
     SUM(CARR_37_NUM) "PC78", SUM(CARR_78_NUM) "PC79", SUM(CARR_119_NUM) "PC80", SUM(DO_CELL_TOTAL_NUM) "PC81",
     Round( 0 ,4) "PC82", Round( 0 ,4) "PC83", Round( 0 ,4) "PC84",
    SUM(DO_1CARR_CELL_NUM) "PC85", SUM(DO_2CARR_CELL_NUM) "PC86", SUM(DO_3CARR_CELL_NUM) "PC87", COUNT(1) "PC88",
     Round( SUM(C108) ,4) "PC89", Round( SUM(C107)  +  SUM(C108) ,4) "PC90", Round( SUM(C174) ,4) "PC91", Round( SUM(C109)  *  1024 ,4) "PC92", Round( SUM(C3) ,4) "PC93", Round( SUM(C21)  +  SUM(C22)  +  SUM(C23) ,4) "PC94", Round( SUM(C27)  +  SUM(C28)  +  SUM(C29)  +  SUM(C30)  +  SUM(C31)  +  SUM(C32)  +  SUM(C33) ,4) "PC95", Round( SUM(C41)  +  SUM(C42) ,4) "PC96", Round( SUM(C111) ,4) "PC97", Round( 0.001667  *  SUM(C112) ,4) "PC98", Round( ( SUM(C113)  +  SUM(C114)  +  SUM(C115)  +  SUM(C116) )  *  256  +  ( SUM(C117)  +  SUM(C118)  +  SUM(C119)  +  SUM(C120) )  *  512  +  ( SUM(C121)  +  SUM(C122)  +  SUM(C123)  +  SUM(C124) )  *  1024  +  ( SUM(C125)  +  SUM(C126)  +  SUM(C127)  +  SUM(C128) )  *  2048  +  ( SUM(C129)  +  SUM(C130)  +  SUM(C131)  +  SUM(C132) )  *  4096  +  SUM(C133)  *  128  +  SUM(C134)  *  256  +  SUM(C135)  *  512  +  SUM(C136)  *  768  +  SUM(C137)  *  1024  +  SUM(C138)  *  1536  +  SUM(C139)  *  2048  +  SUM(C140)  *  3072  +  SUM(C141)  *  4096  +  SUM(C142)  *  6144  +  SUM(C143)  *  8192  +  SUM(C144)  *  12288  +  SUM(C145)  *  128  +  SUM(C146)  *  256  +  SUM(C147)  *  512  +  SUM(C148)  *  768  +  SUM(C149)  *  1024  +  SUM(C150)  *  1536  +  SUM(C151)  *  2048  +  SUM(C152)  *  3072  +  SUM(C153)  *  4096  +  SUM(C154)  *  6144  +  SUM(C155)  *  8192  +  SUM(C156)  *  12288 ,4) "PC99", Round( 1000  *  SUM(C157) ,4) "PC100", Round( 0 ,4) "PC101", Round( 0 ,4) "PC102", Round( 0 ,4) "PC103", Round( 0 ,4) "PC104", Round( 0 ,4) "PC105", "START_TIME"
     from ( 
       select "S1"."START_TIME", to_char(S1.START_TIME,'YYYY-MM-DD') "START_TIME_DAY", to_char(S1.START_TIME,'HH24') "START_TIME_H", "S1"."CITY_ID", "S1"."CITY_NAME", "GROUP_NAME", "GROUP_ID", "S1"."COUNTER_1166017335" "C1", "S1"."COUNTER_1166017337" "C2", "S1"."COUNTER_1166017334" "C3", "S1"."COUNTER_1157633256" "C4", "S1"."COUNTER_1157633257" "C5", "S1"."COUNTER_1157631096" "C6", "S1"."COUNTER_1157631102" "C7", "S1"."COUNTER_1157631249" "C8", "S1"."COUNTER_1157631248" "C9", "S1"."COUNTER_1157631098" "C10", "S1"."COUNTER_1157631104" "C11", "S1"."COUNTER_1157631099" "C12", "S1"."COUNTER_1157631105" "C13", "S1"."COUNTER_1157631100" "C14", "S1"."COUNTER_1157631106" "C15", "S1"."COUNTER_1157633262" "C16", "S1"."COUNTER_1157633259" "C17", "S1"."COUNTER_1157633261" "C18", "S1"."COUNTER_1157631124" "C19", "S1"."COUNTER_1157633260" "C20", "S1"."COUNTER_1166017251" "C21", "S1"."COUNTER_1166017252" "C22", "S1"."COUNTER_1166017253" "C23", "S1"."COUNTER_1166017514" "C24", "S1"."COUNTER_1166017515" "C25", "S1"."COUNTER_1166017516" "C26", "S1"."COUNTER_1166017254" "C27", "S1"."COUNTER_1166017255" "C28", "S1"."COUNTER_1166017256" "C29", "S1"."COUNTER_1166017257" "C30", "S1"."COUNTER_1166017258" "C31", "S1"."COUNTER_1166017259" "C32", "S1"."COUNTER_1166017260" "C33", "S1"."COUNTER_1166017517" "C34", "S1"."COUNTER_1166017518" "C35", "S1"."COUNTER_1166017519" "C36", "S1"."COUNTER_1166017520" "C37", "S1"."COUNTER_1166017521" "C38", "S1"."COUNTER_1166017522" "C39", "S1"."COUNTER_1166017523" "C40", "S1"."COUNTER_1166017261" "C41", "S1"."COUNTER_1166017262" "C42", "S1"."COUNTER_1166017524" "C43", "S1"."COUNTER_1166017525" "C44", "S1"."COUNTER_1166017526" "C45", "S1"."COUNTER_1166017527" "C46", "S1"."COUNTER_1157629100" "C47", "S1"."COUNTER_1157629099" "C48", "S1"."COUNTER_1157629101" "C49", "S1"."COUNTER_1157629102" "C50", "S1"."COUNTER_1157629103" "C51", "S1"."COUNTER_1157629104" "C52", "S1"."COUNTER_1166017533" "C53", "S1"."COUNTER_1157630435" "C54", "S1"."COUNTER_1157630436" "C55", "S1"."COUNTER_1157630441" "C56", "S1"."COUNTER_1157630437" "C57", "S1"."COUNTER_1157630442" "C58", "S1"."COUNTER_1157630446" "C59", "S1"."COUNTER_1157630438" "C60", "S1"."COUNTER_1157630443" "C61", "S1"."COUNTER_1157630447" "C62", "S1"."COUNTER_1157630450" "C63", "S1"."COUNTER_1157631898" "C64", "S1"."COUNTER_1157631899" "C65", "S1"."COUNTER_1157630456" "C66", "S1"."COUNTER_1157630457" "C67", "S1"."COUNTER_1157630462" "C68", "S1"."COUNTER_1157630458" "C69", "S1"."COUNTER_1157630463" "C70", "S1"."COUNTER_1157630467" "C71", "S1"."COUNTER_1157630459" "C72", "S1"."COUNTER_1157630464" "C73", "S1"."COUNTER_1157630468" "C74", "S1"."COUNTER_1157630471" "C75", "S1"."COUNTER_1157631902" "C76", "S1"."COUNTER_1157631903" "C77", "S1"."COUNTER_1157632844" "C78", "S1"."COUNTER_1157632728" "C79", "S1"."COUNTER_1157632729" "C80", "S1"."COUNTER_1157632730" "C81", "S1"."COUNTER_1157632731" "C82", "S1"."COUNTER_1157632732" "C83", "S1"."COUNTER_1157632733" "C84", "S1"."COUNTER_1157632734" "C85", "S1"."COUNTER_1157632735" "C86", "S1"."COUNTER_1157632736" "C87", "S1"."COUNTER_1157631896" "C88", "S1"."COUNTER_1157631897" "C89", "S1"."COUNTER_1157630448" "C90", "S1"."COUNTER_1157630452" "C91", "S1"."COUNTER_1157630444" "C92", "S1"."COUNTER_1157630449" "C93", "S1"."COUNTER_1157630439" "C94", "S1"."COUNTER_1157630445" "C95", "S1"."COUNTER_1157630440" "C96", "S1"."COUNTER_1157631900" "C97", "S1"."COUNTER_1157631901" "C98", "S1"."COUNTER_1157630469" "C99", "S1"."COUNTER_1157630472" "C100", "S1"."COUNTER_1157630465" "C101", "S1"."COUNTER_1157630470" "C102", "S1"."COUNTER_1157630460" "C103", "S1"."COUNTER_1157630466" "C104", "S1"."COUNTER_1157630461" "C105", "S1"."COUNTER_1157632680" "C106", "S1"."COUNTER_1166017164" "C107", "S1"."COUNTER_1166017165" "C108", "S1"."COUNTER_1157631494" "C109", "S1"."COUNTER_1157631496" "C110", "S2"."COUNTER_1166022435" "C111", "S1"."COUNTER_1166017534" "C112", "S2"."COUNTER_1166016809" "C113", "S2"."COUNTER_1166016813" "C114", "S2"."COUNTER_1166016815" "C115", "S2"."COUNTER_1166016819" "C116", "S2"."COUNTER_1166016821" "C117", "S2"."COUNTER_1166016825" "C118", "S2"."COUNTER_1166016827" "C119", "S2"."COUNTER_1166016831" "C120", "S2"."COUNTER_1166016833" "C121", "S2"."COUNTER_1166016837" "C122", "S2"."COUNTER_1166016839" "C123", "S2"."COUNTER_1166016843" "C124", "S2"."COUNTER_1166016845" "C125", "S2"."COUNTER_1166016849" "C126", "S2"."COUNTER_1166016851" "C127", "S2"."COUNTER_1166016855" "C128", "S2"."COUNTER_1166016857" "C129", "S2"."COUNTER_1166016861" "C130", "S2"."COUNTER_1166016863" "C131", "S2"."COUNTER_1166016867" "C132", "S2"."COUNTER_1166017269" "C133", "S2"."COUNTER_1166017271" "C134", "S2"."COUNTER_1166017273" "C135", "S2"."COUNTER_1166017275" "C136", "S2"."COUNTER_1166017277" "C137", "S2"."COUNTER_1166017279" "C138", "S2"."COUNTER_1166017281" "C139", "S2"."COUNTER_1166017283" "C140", "S2"."COUNTER_1166017285" "C141", "S2"."COUNTER_1166017287" "C142", "S2"."COUNTER_1166017289" "C143", "S2"."COUNTER_1166017291" "C144", "S2"."COUNTER_1166022231" "C145", "S2"."COUNTER_1166022233" "C146", "S2"."COUNTER_1166022235" "C147", "S2"."COUNTER_1166022237" "C148", "S2"."COUNTER_1166022239" "C149", "S2"."COUNTER_1166022241" "C150", "S2"."COUNTER_1166022243" "C151", "S2"."COUNTER_1166022245" "C152", "S2"."COUNTER_1166022247" "C153", "S2"."COUNTER_1166022249" "C154", "S2"."COUNTER_1166022251" "C155", "S2"."COUNTER_1166022253" "C156", "S1"."COUNTER_1166022267" "C157", "S1"."COUNTER_1166017182" "C158", "S1"."COUNTER_1166017219" "C159", "S1"."COUNTER_1166017225" "C160", "S1"."COUNTER_1166017341" "C161", "S1"."COUNTER_1157629162" "C162", "S1"."COUNTER_1157629161" "C163", "S1"."COUNTER_1157632248" "C164", "S1"."COUNTER_1157632249" "C165", "S1"."COUNTER_1157632246" "C166", "S1"."COUNTER_1157632247" "C167", "S1"."COUNTER_1157632127" "C168", "S1"."COUNTER_1157632126" "C169", "S1"."COUNTER_1157631536" "C170", "S1"."COUNTER_1157631541" "C171", "S1"."COUNTER_1157631540" "C172", "S1"."COUNTER_1157631535" "C173", "S1"."COUNTER_1157631495" "C174",
      R.CARR_37_NUM, R.CARR_78_NUM, R.CARR_119_NUM, R.DO_CELL_TOTAL_NUM,R.DO_1CARR_CELL_NUM, R.DO_2CARR_CELL_NUM, R.DO_3CARR_CELL_NUM
     from "DS_COUNTER_GROUP_HW_TC_DO_1" "S1" inner join "DS_COUNTER_GROUP_HW_TC_DO_2" "S2" on ("S1"."NE_SYS_ID" = "S2"."NE_SYS_ID" and "S1"."START_TIME" = "S2"."START_TIME" and "S1"."CITY_ID" = "S2"."CITY_ID") inner join ( select distinct g.group_id,g.group_name,ne.CITY_ID , n.ne_sys_id, n.china_name, n.vendor from (select * from mod_negroup_group g 
     where Group_name LIKE 'HQ_%' and city_id= 0 ) g,mod_negroup_ne n,NE_CELL_C ne where n.group_id = g.group_id and n.ne_sys_id = ne.ne_sys_id ) "NEGROUP" on ("S1"."NE_SYS_ID" = "NEGROUP"."NE_SYS_ID" and "S1"."CITY_ID" = "NEGROUP"."CITY_ID")  inner join ( SELECT T.NE_CELL_ID,CELL_NAME,T.CITY_ID, CITY_NAME,  CELL_283_NUM, CELL_201_NUM,  CELL_242_NUM,
                           CELL_160_NUM,ONEX_CELL_TOTAL_NUM, ONEX_1CARR_CELL_NUM, ONEX_2CARR_CELL_NUM, ONEX_3CARR_CELL_NUM, ONEX_4CARR_CELL_NUM, 0 WIRELESS_CAPACITY,
                           CARR_37_NUM, CARR_78_NUM,  CARR_119_NUM, DO_1CARR_CELL_NUM,  DO_2CARR_CELL_NUM, DO_3CARR_CELL_NUM, DO_CELL_TOTAL_NUM
                      FROM (SELECT CELL,  CITY_ID, SUM(DECODE(CELL_283, 0, 0, 1)) CELL_283_NUM, SUM(DECODE(CELL_201, 0, 0, 1)) CELL_201_NUM, SUM(DECODE(CELL_242, 0, 0, 1)) CELL_242_NUM,
                                   SUM(DECODE(CELL_160, 0, 0, 1)) CELL_160_NUM
                              FROM (SELECT DISTINCT RELATED_CELL CELL, CITY_ID, BUSTYPE, DECODE(CARRIER_ID, 283, RELATED_CELL, 0) CELL_283, DECODE(CARRIER_ID, 201, RELATED_CELL, 0) CELL_201, DECODE(CARRIER_ID, 242, RELATED_CELL, 0) CELL_242, DECODE(CARRIER_ID, 160, RELATED_CELL, 0) CELL_160
                                      FROM NE_CARRIER_C T
                                     WHERE T.BUSTYPE = '1X')
                             GROUP BY CELL, CITY_ID) T3,
                           (SELECT RELATED_CELL CELL, CITY_ID,SUM(DECODE(CARRIER_ID, 37, 1, 0)) CARR_37_NUM,SUM(DECODE(CARRIER_ID, 78, 1, 0)) CARR_78_NUM, SUM(DECODE(CARRIER_ID, 119, 1, 0)) CARR_119_NUM
                              FROM NE_CARRIER_C T
                             WHERE T.BUSTYPE = 'DO'
                             GROUP BY RELATED_CELL, CITY_ID) T4,
                           (SELECT CELL, CITY_ID,
                                   SUM(DECODE(BUSTYPE, '1X', 1, 0)) ONEX_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', 1, 0)) DO_CELL_TOTAL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 1, 1, 0), 0)) ONEX_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 2, 1, 0), 0)) ONEX_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 3, 1, 0), 0)) ONEX_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, '1X', DECODE(CNT, 4, 1, 0), 0)) ONEX_4CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 1, 1, 0), 0)) DO_1CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 2, 1, 0), 0)) DO_2CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 3, 1, 0), 0)) DO_3CARR_CELL_NUM,
                                   SUM(DECODE(BUSTYPE, 'DO', DECODE(CNT, 4, 1, 0), 0)) DO_4CARR_CELL_NUM
                              FROM (SELECT RELATED_BSC BSC,RELATED_BTS BTS, RELATED_CELL CELL,CITY_ID, BUSTYPE, COUNT(DISTINCT CARRIER_ID) CNT
                                      FROM NE_CARRIER_C T
                                     GROUP BY RELATED_BTS,
                                              T.RELATED_BSC,
                                              RELATED_CELL,
                                              CITY_ID,
                                              BUSTYPE)
                             GROUP BY CELL, CITY_ID) T5,
                           (SELECT DISTINCT NE_CELL_ID, CELL_NAME, CITY_ID, CITY_NAME
                              FROM CFG_MAP_DEV_TO_NE) T
                     WHERE T.NE_CELL_ID = T3.CELL(+)
                       AND T.NE_CELL_ID = T4.CELL(+)
                       AND T.NE_CELL_ID = T5.CELL(+) 
                       AND T.CITY_ID = T3.CITY_ID(+)
                       AND T.CITY_ID = T4.CITY_ID(+)
                       AND T.CITY_ID = T5.CITY_ID(+) ) R  On (S1.NE_SYS_ID = R.NE_CELL_ID) 
     where  S1.START_TIME&gt;=TO_DATE('%%Y-%%M-%%D 00:00:00','YYYY-MM-DD HH24:MI:SS') AND  S1.START_TIME&lt;=TO_DATE('%%Y-%%M-%%D 23:59:59','YYYY-MM-DD HH24:MI:SS') ) "COUNTER" 
  group by "START_TIME_H", "START_TIME_DAY", "CITY_ID", "CITY_NAME", "GROUP_NAME", "GROUP_ID", "START_TIME" ) "UN" 
   group BY START_TIME, "GROUP_NAME"
  ) "PC"
  order by 1,2,5,3

				    
					</sql>
			</mapping>
			
		</resolve>
	</to>
	
	<!-- 传输接口, 当只有path属性在时候为本地接口，其他则为远程接口 -->
		
    
        <ti id="1" after="1">
		<property name="ftpip">132.63.5.83</property>
		<property name="port">21</property>
		<property name="username">jsftp</property>
		<property name="password">ExZp^yNz</property>
		
		<property name="path">/PERF/</property><!---->
		<property name="encode">utf-8</property>
	</ti>
	<t>
		<action id="1" toid="1" tiid="1" strategyid="1"/><!---->
	</t>
	
	<!-- 默认失败不处理  0:正常   1:   2: -->
	<strategy id="1">
		<property name="failure">1,2,3</property>
	</strategy>
	
	<!-- before ,after ,exception -->
	<trigger id="11" class="cn.uway.nbi.task.triggerc.UpdateBean" />
</config>