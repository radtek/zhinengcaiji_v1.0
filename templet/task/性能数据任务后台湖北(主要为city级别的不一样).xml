<?xml version="1.0" encoding="utf-8" ?>
<config>
	<include>
       <property name="mapping">mapping.xml</property>
       <property name="loop">false</property>
    </include>
	<!-- 100: db 200:file(200:local file , 201: ftp file) 300:socket 400:others -->
	<ds id="1" type="100">
		<property name="url">jdbc:oracle:thin:@192.168.0.180:1521:uway</property>
		<property name="driver">oracle.jdbc.driver.OracleDriver</property>
		<property name="username">cnoap</property>
		<property name="password">uwaysoft2009</property>
	</ds>
	<!-- to 与  resolve 是一对多关系, package为可选标签 -->

	<to id="1">
		<resolve dsid="1">
			<mapping name="${province_en}_PERF_MSC_1X_%%Y%%M%%D.csv" templet="性能数据模板MSC1X.ftl">
				<sql>select t1.MSC,t1.start_time,t1.mscname,t1.proname,t1.city_name,t1.ID1,t1.ID2,t1.ID3,t1.ID4,t1.ID5,t1.ID6,t1.ID7,t1.ID8,t1.ID9,t1.ID10,t1.ID11,t1.ID12,t1.ID13,t1.ID14,t1.ID15,t1.ID16,t1.ID17,t1.ID18,t1.ID19,t1.ID20,t1.ID21,t1.ID22,t1.ID23,t1.ID24,t1.ID25,t1.ID26,t1.ID27,t1.ID28,t1.ID29,t1.ID30,t1.ID31,t1.ID32,t1.ID33,t1.ID34,t1.ID35,t1.ID36,t1.ID37,t1.ID38,t1.ID39,t1.ID40,t1.ID41,t1.ID42,t1.ID43,t1.ID44,t1.ID45,t1.ID46,t1.ID47,t1.ID48,t1.ID49,t1.ID50,t1.ID51,t1.ID52,t1.ID53,t1.ID54,t1.ID55,t1.ID56,t1.ID57,t1.ID58,t1.ID59,t1.ID60,t1.ID61,t1.ID62,t1.ID63,t1.ID64,t1.ID65,t1.ID66,t1.ID67,t1.ID68,t1.ID69,t1.ID70,t1.ID71,t1.ID72,t1.ID73,t1.ID74,t1.ID75,t1.ID76,t1.ID77,t1.ID78,t1.ID79,t1.ID80,t1.ID81,t1.ID82,t1.ID83,t1.ID84,t1.ID85,t1.ID86,t1.ID87,t1.ID88,t1.ID89,t1.ID90,t1.ID91,t1.ID92,t1.ID93,t1.ID94,t1.ID95,t1.ID96,t1.ID97,t1.ID98,t1.ID99,t1.ID100,t1.ID101,t1.ID102,t1.ID103,t1.ID104,t1.ID105,t1.ID106,t1.ID107,t1.ID108,t1.ID109,t1.ID110,t1.ID111,t1.ID112,t1.ID113,t1.ID114,t1.ID115,t1.ID116,t1.ID117,t1.ID118,t1.ID119,t1.ID120,t1.ID121,t1.ID122,t2.ID301,t2.ID302,t2.ID303,t2.ID304,t2.ID305,t1.ID128,t1.ID129,t1.ID130,t1.ID131,t1.ID132,t1.ID133,t1.ID134,t1.ID135,t1.ID136,t1.ID137,t1.ID138,t1.ID139,t1.ID140,t1.ID141,t1.ID142,t1.ID143,t1.ID144,t1.ID145,t1.ID146,t1.ID147,t1.ID148,t1.ID149,t2.ID306,t2.ID307,t2.ID308,t2.ID309,t2.ID310,t2.ID311,t2.ID312,t2.ID313,t2.ID314,t2.ID315,t1.ID160,t1.ID161,t1.ID162,t1.ID163,t1.ID164,t1.ID165,t1.ID166,t2.ID318,t2.ID319,t2.ID320,t2.ID321,t2.ID322,t1.ID172,t1.ID173,t1.ID174,t1.ID175,t1.ID176,t2.ID323,t1.ID178,t1.ID179,t1.ID180,t1.ID181,t1.ID182,t2.ID324,t2.ID325,t2.ID326,t2.ID327,t2.ID328,t2.ID329,t2.ID330,t2.ID331,t2.ID332,t2.ID333,t1.ID193,t1.ID194,t1.ID195,t1.ID196,t1.ID197,t1.ID198,t1.ID199,t1.ID200,t1.ID201,t1.ID202,t1.ID203,t1.ID204,t1.ID205,t1.ID206,t1.ID207,t1.ID208,t1.ID209,t1.ID210,t1.ID211 
				from (select b.mscname as MSC,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,b.mscname,'${province_cn}' as proname,
				(select mapcity2.city_name from (select rownum as num,mapcity.* from 
				(select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity)mapcity2 where mapcity2.num in(select min(num) from (
select rownum as num,mapcity.msc from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity) group by msc) and mapcity2.msc=b.mscname) as city_name,sum(nvl(CALL_ATT,0))+sum(nvl(DATACALLATT3G,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(ESTDATACALLS3G,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))&gt;=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))/(SUM(CALL_ATT) + SUM(DATACALLATT3G)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))&gt;=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,sum(DATACALLATT3G) as ID7,sum(ESTDATACALLS3G) as ID8,CASE WHEN sum(DATACALLATT3G)=0 THEN 0 WHEN sum(ESTDATACALLS3G)&gt;=sum(DATACALLATT3G) THEN 99.99 ELSE ROUND(sum(ESTDATACALLS3G)/sum(DATACALLATT3G) * 100,2) END as ID9,SUM(nvl(SHO_TRAFFIC_CS,0)) + SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(WALSHCODE_ERL_PS) as ID20,SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS) as ID21,SUM(WALSHCODE_ERL_PS)-SUM(SHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS))/SUM(TRAFFIC_PS) * 100,2) END as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATACALLSDROP,0)) as ID24,CASE WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))&lt;=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))/(SUM(CALL_SETUP_SUCC_CS) + SUM(ESTDATACALLS3G)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + sum(DATACALLSDROP))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + sum(DATACALLSDROP)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,sum(DATACALLSDROP) as ID30,CASE WHEN SUM(nvl(ESTDATACALLS3G,0))=0 THEN 0 WHEN sum(DATACALLSDROP)&lt;=0 THEN 0.01 ELSE ROUND(sum(DATACALLSDROP)/SUM(nvl(ESTDATACALLS3G,0)) * 100,2) END as ID31,CASE WHEN sum(DATACALLSDROP)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/sum(DATACALLSDROP),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(TCH_ASSIGN_ATT_HO_PS) as ID33,SUM(TCH_SETUP_SUC)+SUM(TCH_ASSIGN_SUC_HO_PS) as ID34,(SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC))+(SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS)) as ID35,CASE WHEN SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)) * 100,4) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID39,CASE WHEN SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND((SUM(nvl(CALL_SETUP_SUCC_CS, 0))+SUM(nvl(ESTDATACALLS3G, 0)))/(SUM(O_TCH_ASSIGN_ATT) + SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,4) END as ID40,SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS) -SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)) * 100,4) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC)*100/SUM(TCH_SETUP_ATT),2) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)*100/SUM(TCH_SETUP_ATT),2) END as ID52,SUM(VOICECALLHARDHOREQ) as ID53,SUM(VOICECALLHARDHOCOMPLET) as ID54,CASE WHEN SUM(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(VOICECALLHARDHOREQ)-SUM(VOICECALLHARDHOCOMPLET))/SUM(VOICECALLHARDHOREQ) * 100,4) END as ID55,SUM(TCH_SETUP_ATT)-SUM(TCH_ASSIGN_ATT_NUM)-SUM(BSS_HHO_ATT) as ID56,SUM(TCH_SETUP_SUC)-SUM(TCH_ASSIGN_SUC)-SUM(BSS_HHO_SUC) as ID57,CASE WHEN SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(((SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) -(SUM(TCH_SETUP_SUC) - SUM(TCH_ASSIGN_SUC) - SUM(BSS_HHO_SUC))) /(SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) * 100,4) END as ID58,SUM(TCH_ASSIGN_ATT_HO_PS) as ID59,SUM(TCH_ASSIGN_SUC_HO_PS) as ID60,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID61,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_HO_PS) / SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(nvl(ESTDATACALLS3G,0)) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(nvl(ESTDATACALLS3G, 0)) / SUM(TCH_ASSIGN_ATT_PS) * 100,4) END as ID66,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID67,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS))/SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID68,SUM(DATACALLHARDHOREQ) as ID69,SUM(DATACALLHARDHOCOMPLET) as ID70,CASE WHEN SUM(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(DATACALLHARDHOREQ)-SUM(DATACALLHARDHOCOMPLET))/SUM(DATACALLHARDHOREQ) * 100,4) END as ID71,SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ) as ID72,SUM(DATACALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTHOCOMPLET) as ID73,CASE WHEN SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(((SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ))-(SUM(DATACALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTHOCOMPLET)))/(SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ))*100,4) END as ID74,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID75,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID76,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID77,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID78,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID79,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID80,sum(VOICECALLHARDHOREQ) as ID81,sum(VOICECALLHARDHOCOMPLET) as ID82,CASE WHEN sum(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLHARDHOCOMPLET)*100/sum(VOICECALLHARDHOREQ),2) END as ID83,sum(VOICECALLSOFTHOREQ) as ID84,sum(VOICECALLSOFTHOCOMPLET) as ID85,CASE WHEN sum(VOICECALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTHOCOMPLET)*100/sum(VOICECALLSOFTHOREQ),2) END as ID86,sum(VOICECALLSOFTERHOREQ) as ID87,sum(VOICECALLSOFTERHOCOMPLET) as ID88,CASE WHEN sum(VOICECALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTERHOCOMPLET)*100/sum(VOICECALLSOFTERHOREQ),2) END as ID89,sum(DATACALLHOREQ) as ID90,sum(DATACALLHOCOMPLET) as ID91,CASE WHEN sum(DATACALLHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHOCOMPLET)/sum(DATACALLHOREQ) * 100,2) END as ID92,sum(DATACALLHARDHOREQ) as ID93,sum(DATACALLHARDHOCOMPLET) as ID94,CASE WHEN sum(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHARDHOCOMPLET)/sum(DATACALLHARDHOREQ) * 100,2) END as ID95,sum(DATACALLSOFTHOREQ) as ID96,sum(DATACALLSOFTHOCOMPLET) as ID97,CASE WHEN sum(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLSOFTHOCOMPLET)/sum(DATACALLSOFTHOREQ) * 100,2) END as ID98,SUM(DATACALLSOFTERHOREQ) as ID99,SUM(DATACALLSOFTERHOCOMPLET) as ID100,CASE WHEN SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(SUM(DATACALLSOFTERHOCOMPLET)/SUM(DATACALLSOFTERHOREQ) * 100,2) END as ID101,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID102,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTRAMSCSOFTHOCOMPLET)+SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID103,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTRAMSCSOFTHOCOMPLET) +SUM(VOICECALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTERHOCOMPLET)) /(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ) +SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)) * 100,4) END as ID104,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTERMSCSOFTHOREQ) as ID105,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTERMSCSOFTHOCOMPLET) as ID106,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTERMSCSOFTHOCOMPLET))/(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)) * 100,4) END as ID107,sum(THEINTERMSCHARDHOREQ) as ID108,sum(THEINTERMSCHARDHOCOMPLET) as ID109,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID110,SUM(THEINTRAMSCSOFTHOREQ) as ID111,SUM(THEINTRAMSCSOFTHOCOMPLET) as ID112,CASE WHEN SUM(THEINTRAMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTRAMSCSOFTHOCOMPLET)/SUM(THEINTRAMSCSOFTHOREQ) * 100,2) END as ID113,SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID114,SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID115,CASE WHEN (SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ))=0 THEN 0 ELSE ROUND((SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET))/(SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ)) * 100,2) END as ID116,sum(THEINTERMSCHARDHOREQ) as ID117,sum(THEINTERMSCHARDHOCOMPLET) as ID118,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID119,SUM(THEINTERMSCSOFTHOREQ) as ID120,SUM(THEINTERMSCSOFTHOCOMPLET) as ID121,CASE WHEN SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTERMSCSOFTHOCOMPLET)/SUM(THEINTERMSCSOFTHOREQ) * 100,2) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,SUM(CH_RLB_NUM) as ID129,SUM(CH_MAX_NUM) as ID130,CASE WHEN SUM(CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(CH_MAX_NUM)/SUM(CH_RLB_NUM)*100,4) END as ID131,null as ID132,null as ID133,null as ID134,null as ID135,null as ID136,null as ID137,null as ID138,null as ID139,null as ID140,SUM(FWD_RLP_DATA) as ID141,SUM(FTCH_RLP_TX_1X) as ID142,sum(TOTALRLPBYTESRETRFWDTRAFFIC) as ID143,null as ID144,null as ID145,null as ID146,SUM(TOTALFRAMESTRANSRESERVETRAFFIC) as ID147,SUM(RTCH_RLP_TX_1X) as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,round(AVG(WIRELESS_CAPACITY),2) as ID161,null as ID162,case when SUM(WIRELESS_CAPACITY) = 0 then 0 else ROUND(SUM(SHO_TRAFFIC_CS) / SUM(WIRELESS_CAPACITY) * 100, 2) end  as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT)*100,4) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)) * 100,2) END as ID176,null as ID177,SUM(CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211
  from perf_bsc_c c, cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.vendor ='ZY0810' and c.CITY_ID=b.city_id group by b.mscname, start_time order by b.mscname, start_time)
    t1 left join (select b.mscname as MSC,start_time,b.mscname,SUM(BTS_283_NUM) as ID301,SUM(BTS_201_NUM) as ID302,SUM(BTS_242_NUM) as ID303,SUM(BTS_160_NUM) as ID304,SUM(ONEX_CARR_TOTAL_NUM) as ID305,SUM(ONEX_BTS_TOTAL_NUM) as ID306,SUM(ONEX_1CARR_BTS_NUM) as ID307,SUM(ONEX_2CARR_BTS_NUM) as ID308,SUM(ONEX_3CARR_BTS_NUM) as ID309,SUM(ONEX_4CARR_BTS_NUM) as ID310,SUM(ONEX_CELL_TOTAL_NUM) as ID311,SUM(ONEX_1CARR_CELL_NUM) as ID312,SUM(ONEX_2CARR_CELL_NUM) as ID313,SUM(ONEX_3CARR_CELL_NUM) as ID314,SUM(ONEX_4CARR_CELL_NUM) as ID315,null as ID316,null as  ID317,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID318,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID319,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(IDLE_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID320,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID321,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID322,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(ABNORMAL_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID323,SUM(TRAFFIC_283) as ID324,SUM(TRAFFIC_201) as ID325,SUM(TRAFFIC_242) as ID326,SUM(TRAFFIC_160) as ID327,SUM(EX_BUSY_SECTOR_NUM) as ID328,SUM(BUSY_SECTOR_NUM) as ID329,SUM(IDLE_SECTOR_NUM) as ID330,SUM(ABNORMAL_SECTOR_NUM) as ID331,SUM(EX_OVERFLOW_BTS_NUM) as ID332,SUM(OVERFLOW_BTS_NUM) as ID333
     from perf_bsc_resource c,cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.CITY_ID=b.city_id group by b.mscname,start_time order by b.mscname, start_time) 
    t2 on to_date(t1.start_time, 'YYYY-MM-DD HH24:MI:SS')=t2.start_time and  t1.mscname=t2.mscname</sql>
				<sql>select t1.MSC,t1.start_time,t1.mscname,t1.proname,t1.city_name,t1.ID1,t1.ID2,t1.ID3,t1.ID4,t1.ID5,t1.ID6,t1.ID7,t1.ID8,t1.ID9,t1.ID10,t1.ID11,t1.ID12,t1.ID13,t1.ID14,t1.ID15,t1.ID16,t1.ID17,t1.ID18,t1.ID19,t1.ID20,t1.ID21,t1.ID22,t1.ID23,t1.ID24,t1.ID25,t1.ID26,t1.ID27,t1.ID28,t1.ID29,t1.ID30,t1.ID31,t1.ID32,t1.ID33,t1.ID34,t1.ID35,t1.ID36,t1.ID37,t1.ID38,t1.ID39,t1.ID40,t1.ID41,t1.ID42,t1.ID43,t1.ID44,t1.ID45,t1.ID46,t1.ID47,t1.ID48,t1.ID49,t1.ID50,t1.ID51,t1.ID52,t1.ID53,t1.ID54,t1.ID55,t1.ID56,t1.ID57,t1.ID58,t1.ID59,t1.ID60,t1.ID61,t1.ID62,t1.ID63,t1.ID64,t1.ID65,t1.ID66,t1.ID67,t1.ID68,t1.ID69,t1.ID70,t1.ID71,t1.ID72,t1.ID73,t1.ID74,t1.ID75,t1.ID76,t1.ID77,t1.ID78,t1.ID79,t1.ID80,t1.ID81,t1.ID82,t1.ID83,t1.ID84,t1.ID85,t1.ID86,t1.ID87,t1.ID88,t1.ID89,t1.ID90,t1.ID91,t1.ID92,t1.ID93,t1.ID94,t1.ID95,t1.ID96,t1.ID97,t1.ID98,t1.ID99,t1.ID100,t1.ID101,t1.ID102,t1.ID103,t1.ID104,t1.ID105,t1.ID106,t1.ID107,t1.ID108,t1.ID109,t1.ID110,t1.ID111,t1.ID112,t1.ID113,t1.ID114,t1.ID115,t1.ID116,t1.ID117,t1.ID118,t1.ID119,t1.ID120,t1.ID121,t1.ID122,t2.ID301,t2.ID302,t2.ID303,t2.ID304,t2.ID305,t1.ID128,t1.ID129,t1.ID130,t1.ID131,t1.ID132,t1.ID133,t1.ID134,t1.ID135,t1.ID136,t1.ID137,t1.ID138,t1.ID139,t1.ID140,t1.ID141,t1.ID142,t1.ID143,t1.ID144,t1.ID145,t1.ID146,t1.ID147,t1.ID148,t1.ID149,t2.ID306,t2.ID307,t2.ID308,t2.ID309,t2.ID310,t2.ID311,t2.ID312,t2.ID313,t2.ID314,t2.ID315,t1.ID160,t1.ID161,t1.ID162,t1.ID163,t1.ID164,t1.ID165,t1.ID166,t2.ID318,t2.ID319,t2.ID320,t2.ID321,t2.ID322,t1.ID172,t1.ID173,t1.ID174,t1.ID175,t1.ID176,t2.ID323,t1.ID178,t1.ID179,t1.ID180,t1.ID181,t1.ID182,t2.ID324,t2.ID325,t2.ID326,t2.ID327,t2.ID328,t2.ID329,t2.ID330,t2.ID331,t2.ID332,t2.ID333,t1.ID193,t1.ID194,t1.ID195,t1.ID196,t1.ID197,t1.ID198,t1.ID199,t1.ID200,t1.ID201,t1.ID202,t1.ID203,t1.ID204,t1.ID205,t1.ID206,t1.ID207,t1.ID208,t1.ID209,t1.ID210,t1.ID211
				 from (select b.mscname as MSC,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,b.mscname,'${province_cn}' as proname,(select mapcity2.city_name from (select rownum as num,mapcity.* from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity)mapcity2 where mapcity2.num in(select min(num) from (
select rownum as num,mapcity.msc from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity) group by msc) and mapcity2.msc=b.mscname) as city_name,sum(nvl(CALL_ATT,0))+sum(nvl(CALL_ATT_NUM_PS,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(CMO_CALLSUCCNUM_PS,0))+sum(nvl(PAG_SUCC_NUM_PS,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0)))&gt;=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0))+SUM(nvl(PAG_SUCC_NUM_PS,0)))/(SUM(CALL_ATT) + SUM(CALL_ATT_NUM_PS)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))&gt;=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,SUM(CALL_ATT_NUM_PS) as ID7,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS) as ID8,CASE WHEN SUM(CALL_ATT_NUM_PS)=0 THEN 0 WHEN (SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))&gt;=SUM(CALL_ATT_NUM_PS) THEN 99.99ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))/SUM(CALL_ATT_NUM_PS)* 100, 4) END  as ID9,SUM(SHO_TRAFFIC_CS)+SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(TRAFFIC_CS)+SUM(SFT_HO_TRAFFIC_CS) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS)+SUM(SSHO_TRAFFIC_PS) as ID20,SUM(SHO_TRAFFIC_PS) as ID21,SUM(SSHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_TRAFFIC_PS)/SUM(TRAFFIC_PS)* 100, 4) END  as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATE_DROP_NUM,0)) as ID24,CASE WHEN (SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(DATA_SRLSNUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))&lt;=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))/(SUM(TCH_ASSIGN_SUC) + SUM(DATA_SRLSNUM_PS)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,SUM(DATE_DROP_NUM) as ID30,CASE WHEN SUM(DATA_SRLSNUM_PS)=0 THEN 0 WHEN SUM(DATE_DROP_NUM)&lt;=0 THEN 0.01 ELSE ROUND(SUM(DATE_DROP_NUM)/SUM(DATA_SRLSNUM_PS),4)*100 END as ID31,CASE WHEN SUM(DATE_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/SUM(DATE_DROP_NUM),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID33,SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID34,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID35,CASE WHEN (SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM))/(SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)-(SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)) as ID39,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS))=0 THEN 0 ELSE ROUND(((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,2) END as ID40,SUM(TCH_BLOCK_COUNT)+ SUM(TCH_BLOCK_NUM_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT) + SUM(TCH_BLOCK_NUM_PS))*100/SUM(TCH_SETUP_ATT),2) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0   ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT),4)*100 END as ID52,SUM(BSS_HHO_ATT) as ID53,SUM(BSS_HHO_SUC) as ID54,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND((SUM(BSS_HHO_ATT) - SUM(BSS_HHO_SUC)) / SUM(BSS_HHO_ATT) * 100,4) END as ID55,SUM(S_SHO_ATT) as ID56,SUM(S_SHO_SUC) as ID57,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(S_SHO_ATT) - SUM(S_SHO_SUC)) / SUM(S_SHO_ATT) * 100,4) END as ID58,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID59,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID60,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID61,CASE WHEN SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(HHO_SUC_NUM_PS) + SUM(SHO_SUC_NUM_PS) +SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS))*100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(TCH_ASSIGN_SUC_PS) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(TCH_ASSIGN_SUC_PS) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_PS)/SUM(TCH_ASSIGN_ATT_PS) * 100,2) END as ID66,SUM(TCH_BLOCK_NUM_PS) as ID67,CASE WHEN (SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_NUM_PS)/(SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID68,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID69,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID70,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_PS)-SUM(TCH_ASSIGN_SUC_HHO_PS))/SUM(TCH_ASSIGN_ATT_HHO_PS) * 100,2) END as ID71,SUM(TCH_ASSIGN_ATT_SHO_PS) as ID72,SUM(TCH_ASSIGN_SUC_SHO_PS) as ID73,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_PS)-SUM(TCH_ASSIGN_SUC_SHO_PS))/SUM(TCH_ASSIGN_ATT_SHO_PS) * 100,2) END as ID74,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID75,SUM(INNER_BSC_HHO_SUCC)+ SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC) as ID76,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC))*100/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT)),2) END as ID77,SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT) as ID78,SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC) as ID79,CASE WHEN (SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)) = 0 THEN 0 ELSE  ROUND( (SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC))/(SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)), 3) * 100 END as ID80,SUM(BSS_HHO_ATT) as ID81,SUM(BSS_HHO_SUC) as ID82,CASE WHEN SUM(BSS_HHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT),4) * 100 END as ID83,SUM(S_SHO_ATT)-SUM(S_SSHO_ATT) as ID84,SUM(S_SHO_SUC)-SUM(S_SSHO_SUC) as ID85,CASE WHEN (SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)) = 0 THEN 0 ELSE  ROUND((SUM(S_SHO_SUC)-SUM(S_SSHO_SUC))/(SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)),4) * 100 END as ID86,SUM(S_SSHO_ATT) as ID87,SUM(S_SSHO_SUC) as ID88,CASE WHEN SUM(S_SSHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(S_SSHO_SUC)/SUM(S_SSHO_ATT),4) * 100 END as ID89,SUM(DATE_HO_ATT_NUM) as ID90,SUM(DATA_HO_SUCC_NUM) as ID91,CASE WHEN SUM(DATE_HO_ATT_NUM)=0 THEN 0 ELSE ROUND(SUM(DATA_HO_SUCC_NUM)/SUM(DATE_HO_ATT_NUM) * 100,2) END as ID92,SUM(HHO_ATT_NUM_PS) as ID93,SUM(HHO_SUC_NUM_PS) as ID94,CASE WHEN SUM(HHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(HHO_SUC_NUM_PS)/SUM(HHO_ATT_NUM_PS) * 100,2) END as ID95,SUM(SHO_ATT_NUM_PS) as ID96,SUM(SHO_SUC_NUM_PS) as ID97,CASE WHEN SUM(SHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_SUC_NUM_PS)/SUM(SHO_ATT_NUM_PS) * 100,2) END as ID98,SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID99,SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID100,CASE WHEN SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)) * 100,4) END as ID101,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT) as ID102,SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC) as ID103,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC))/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)) * 100,2) END as ID104,SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID105,SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC) as ID106,CASE WHEN SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC))/(SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)) * 100,4) END as ID107,SUM(INNER_BSC_HHO_ATT) as ID108,SUM(INNER_BSC_HHO_SUCC) as ID109,CASE WHEN SUM(INNER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_HHO_SUCC) / SUM(INNER_BSC_HHO_ATT) * 100,4) END as ID110,SUM(INNER_BSC_SHO_ATT) as ID111,SUM(INNER_BSC_SHO_SUCC) as ID112,CASE WHEN SUM(INNER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SHO_SUCC) / SUM(INNER_BSC_SHO_ATT) * 100,4) END as ID113,SUM(INNER_BSC_SOFTERHO_ATT) as ID114,SUM(INNER_BSC_SOFTERHO_SUCC) as ID115,CASE WHEN SUM(INNER_BSC_SOFTERHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SOFTERHO_SUCC) / SUM(INNER_BSC_SOFTERHO_ATT) * 100,4) END as ID116,SUM(INTER_BSC_HHO_ATT) as ID117,SUM(INTER_BSC_HHO_SUCC) as ID118,CASE WHEN SUM(INTER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_HHO_SUCC) / SUM(INTER_BSC_HHO_ATT) * 100,4) END as ID119,SUM(INTER_BSC_SHO_ATT) as ID120,SUM(INTER_BSC_SHO_SUCC) as ID121,CASE WHEN SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_SHO_SUCC) / SUM(INTER_BSC_SHO_ATT) * 100,4) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID128,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID129,SUM(FWD_CH_MAX_NUM)+SUM(REV_CH_MAX_NUM) as ID130,CASE WHEN SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND((SUM(FWD_CH_MAX_NUM) + SUM(REV_CH_MAX_NUM))/(SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)) * 100,4) END as ID131,SUM(FWD_CH_NUM) as ID132,SUM(FWD_CH_RLB_NUM) as ID133,SUM(FWD_CH_MAX_NUM) as ID134,CASE WHEN SUM(FWD_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(FWD_CH_MAX_NUM) / SUM(FWD_CH_RLB_NUM)*100,4) END as ID135,SUM(REV_CH_NUM) as ID136,SUM(REV_CH_RLB_NUM) as ID137,SUM(REV_CH_MAX_NUM) as ID138,CASE WHEN SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(REV_CH_MAX_NUM)/SUM(REV_CH_RLB_NUM)*100,4) END as ID139,SUM(RETX_FRM_NUM_FWD_1X) as ID140,SUM(TX_FRM_NUM_FWD_1X) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,SUM(RETX_FRM_NUM_REV_1X) as ID146,SUM(TX_FRM_NUM_REV_1X) as ID147,null as ID148,CASE WHEN SUM(TX_FRM_NUM_REV_1X)=0 THEN 0 ELSE ROUND(SUM(RETX_FRM_NUM_REV_1X)/SUM(TX_FRM_NUM_REV_1X) * 100,2) END as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID160,round(AVG(WIRELESS_CAPACITY),2) as ID161,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID162,case when SUM(WIRELESS_CAPACITY) = 0 then 0 else ROUND(SUM(SHO_TRAFFIC_CS) / SUM(WIRELESS_CAPACITY) * 100, 2) end  as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT) * 100,2) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)),2) END as ID176,null as ID177,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211
  from perf_bsc_c c, cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.vendor ='ZY0804' and c.CITY_ID=b.city_id group by b.mscname, start_time order by b.mscname, start_time)
   t1 left join (select b.mscname as MSC,start_time,b.mscname,SUM(BTS_283_NUM) as ID301,SUM(BTS_201_NUM) as ID302,SUM(BTS_242_NUM) as ID303,SUM(BTS_160_NUM) as ID304,SUM(ONEX_CARR_TOTAL_NUM) as ID305,SUM(ONEX_BTS_TOTAL_NUM) as ID306,SUM(ONEX_1CARR_BTS_NUM) as ID307,SUM(ONEX_2CARR_BTS_NUM) as ID308,SUM(ONEX_3CARR_BTS_NUM) as ID309,SUM(ONEX_4CARR_BTS_NUM) as ID310,SUM(ONEX_CELL_TOTAL_NUM) as ID311,SUM(ONEX_1CARR_CELL_NUM) as ID312,SUM(ONEX_2CARR_CELL_NUM) as ID313,SUM(ONEX_3CARR_CELL_NUM) as ID314,SUM(ONEX_4CARR_CELL_NUM) as ID315,null as ID316,null as  ID317,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID318,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID319,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(IDLE_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID320,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID321,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID322,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(ABNORMAL_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID323,SUM(TRAFFIC_283) as ID324,SUM(TRAFFIC_201) as ID325,SUM(TRAFFIC_242) as ID326,SUM(TRAFFIC_160) as ID327,SUM(EX_BUSY_SECTOR_NUM) as ID328,SUM(BUSY_SECTOR_NUM) as ID329,SUM(IDLE_SECTOR_NUM) as ID330,SUM(ABNORMAL_SECTOR_NUM) as ID331,SUM(EX_OVERFLOW_BTS_NUM) as ID332,SUM(OVERFLOW_BTS_NUM) as ID333
    from perf_bsc_resource c,cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.CITY_ID=b.city_id group by b.mscname,start_time order by b.mscname, start_time)
    t2 on to_date(t1.start_time, 'YYYY-MM-DD HH24:MI:SS')=t2.start_time and  t1.mscname=t2.mscname</sql>
			</mapping>
			<mapping name="${province_en}_PERF_MSC_DO_%%Y%%M%%D.csv" templet="性能数据模板MSCDO.ftl">
				<sql>select t1.MSC,t1.start_time,t1.mscname,t1.proname,t1.city_name,t2.ID301,t2.ID302,t2.ID303,t2.ID304,t2.ID305,t2.ID306,t1.ID7,t1.ID8,t1.ID9,t1.ID10,t1.ID11,t2.ID307,t1.ID13,t1.ID14,t1.ID15,t1.ID16,t1.ID17,t1.ID18,t1.ID19,t1.ID20,t2.ID308,t2.ID309,t1.ID23,t1.ID24,t1.ID25,t1.ID26,t1.ID27,t1.ID28,t1.ID29,t1.ID30,t1.ID31,t1.ID32,t1.ID33,t1.ID34,t1.ID35,t1.ID36,t1.ID37,t1.ID38,t1.ID39,t1.ID40,t1.ID41,t1.ID42,t1.ID43,t1.ID44,t1.ID45,t1.ID46,t1.ID47,t1.ID48,t1.ID49,t1.ID50,t1.ID51,t1.ID52,t1.ID53,t1.ID54,t1.ID55,t1.ID56,t1.ID57,t1.ID58,t1.ID59,t1.ID60,t1.ID61,t1.ID62,t1.ID63,t1.ID64,t1.ID65,t1.ID66,t1.ID67,t1.ID68,t1.ID69,t1.ID70,t1.ID71,t1.ID72,t1.ID73,t1.ID74,t1.ID75,t1.ID76,t1.ID77,t1.ID78,t1.ID79,t1.ID80,t1.ID81,t1.ID82,t1.ID83,t1.ID84,t1.ID85,t1.ID86,t1.ID87,t1.ID88,t1.ID89,t1.ID90,t1.ID91,t1.ID92,t1.ID93,t1.ID94,t1.ID95,t1.ID96,t1.ID97,t1.ID98,t1.ID99,t1.ID100,t1.ID101,t1.ID102,t1.ID103,t1.ID104,t1.ID105,t1.ID106,t1.ID107,t1.ID108,t1.ID109,t1.ID110,t1.ID111,t1.ID112,t1.ID113,t1.ID114,t1.ID115,t1.ID116,t1.ID117,t1.ID118,t1.ID119,t1.ID120,t1.ID121,t1.ID122,t1.ID123,t2.ID310,t2.ID311,t2.ID312,t2.ID313,t2.ID314,t2.ID315,t2.ID316,t2.ID317,t2.ID318,t2.ID319,t2.ID320,t1.ID135,t1.ID136,t1.ID137,t1.ID138,t1.ID139,t1.ID140,t1.ID141,t1.ID142,t1.ID143,t1.ID144,t1.ID145,t1.ID146,t1.ID147,t1.ID148,t1.ID149,t1.ID150,t1.ID151,t1.ID152,t1.ID153,t1.ID154,t1.ID155,t1.ID156 from (
select b.mscname as MSC,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,b.mscname,'${province_cn}' as proname,(select mapcity2.city_name from (select rownum as num,mapcity.* from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity)mapcity2 where mapcity2.num in(select min(num) from (
select rownum as num,mapcity.msc from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity) group by msc) and mapcity2.msc=b.mscname) as city_name,null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,null as ID7,null as ID8,null as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0)) )=0 THEN 0 WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))&gt;=(SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) THEN 99.99 ELSE ROUND((SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))) / (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) * 100, 5) END as ID23,CASE WHEN SUM(nvl(AT_INIT_ATT_CONN,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))/SUM(nvl(AT_INIT_ATT_CONN,0))*100,4) END as ID24,DECODE(SUM(AN_INIT_ATT_CONN),0,0,ROUND(SUM(AN_INIT_ESTABLISHED_CONN)/SUM(AN_INIT_ATT_CONN),4)*100) as ID25,SUM(nvl(AT_INIT_ATT_CONN,0)) as ID26,SUM(nvl(AN_INIT_ATT_CONN,0)) as ID27,SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) as ID28,SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,null as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,null as ID39,null as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN (SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))=0 THEN 0 ELSE ROUND((SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))/(SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100,2) END as ID45,null as ID46,CASE WHEN (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME) / (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)) * 100, 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))&gt;=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(nvl(UATI_ATT_NUM,0))-SUM(nvl(UATI_SUC_NUM,0)) as ID54,null as ID55,null as ID56,null as ID57,null as ID58,null as ID59,null as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,null as ID64,null as ID65,null as ID66,null as ID67,null as ID68,null as ID69,CASE WHEN SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/(SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO))*100,4) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(EQU_USER_NUM_DO) as ID81,SUM(TCH_OCC) as ID82,null as ID83,null as ID84,null as ID85,null as ID86,null as ID87,null as ID88,null as ID89,null as ID90,null as ID91,null as ID92,null as ID93,ROUND(SUM(FWD_RLP_DATA)*8/(1000*3600),4) as ID94,CASE WHEN SUM(FWD_RLP_DATA)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_DATA)*100,4) END as ID95,ROUND(SUM(RLP_RXED_RTC)*8/(100*3600),4) as ID96,CASE WHEN SUM(RTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(MISSING_RLP_REQ_RTC)/SUM(RTCH_RLP_TX_DO)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FWD_RLP_TOT_SLOT)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/1000/(SUM(FWD_RLP_TOT_SLOT)*0.001667),4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(NUM_SUBPKTS_RL)=0 THEN 0 ELSE ROUND(SUM(REV_PHY_AVG_BYTE)*(8*1000)/(SUM(NUM_SUBPKTS_RL)* 0.00667),4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),3) as ID102,null as ID103,null as ID104,null as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))&gt;=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,null as ID109,null as ID110,null as ID111,null as ID112,null as ID113,null as ID114,null as ID115,null as ID116,null as ID117,null as ID118,null as ID119,null as ID120,null as ID121,null as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,null as ID135,CASE WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))=0 THEN 0 ELSE ROUND((SUM(EVM_AVG_DRC_POINTED_USERS)*3600*(SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)))/(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))),2) END as ID136,null as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_DATA) as ID139,SUM(MISSING_RLP_REQ_RTC) as ID140,SUM(RTCH_RLP_TX_DO) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FWD_RLP_TOT_SLOT)*0.001667 as ID149,SUM(REV_PHY_AVG_BYTE)*(8*1000000) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
  from perf_bsc_c c, cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
   and c.vendor ='ZY0810' and c.CITY_ID = b.city_id group by b.mscname, start_time order by b.mscname, start_time) t1 
   left join (select b.mscname as MSC,start_time,b.mscname,
   SUM(DO_BTS_TOTAL_NUM) as ID301,SUM(ONE_CARR_BTS_NUM_DO) as ID302,SUM(TWO_CARR_BTS_NUM_DO) as ID303,SUM(THREE_CARR_BTS_NUM_DO) as ID304,SUM(FOUR_CARR_BTS_NUM_DO) as ID305,SUM(DO_CARR_TOTAL_NUM) as ID306,SUM(PCF_TOTAL_NUM) as ID307,SUM(EX_BUSY_BTS_NUM_DO) as ID308,SUM(IDLE_BTS_NUM_DO) as ID309,SUM(CARR_NUM_37) as ID310,SUM(CARR_NUM_78) as ID311,SUM(CARR_NUM_119) as ID312,SUM(DO_CARR_TOTAL_NUM) as ID313,SUM(TRAFFIC_37) as ID314,SUM(TRAFFIC_78) as ID315,SUM(TRAFFIC_119) as ID316,SUM(DO_1CARR_CELL_NUM) as ID317,SUM(DO_2CARR_CELL_NUM) as ID318,SUM(DO_3CARR_CELL_NUM) as ID319,SUM(DO_CELL_TOTAL_NUM) as ID320 
   from perf_bsc_resource c,cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.CITY_ID=b.city_id group by b.mscname,start_time order by b.mscname, start_time) t2 on to_date(t1.start_time, 'YYYY-MM-DD HH24:MI:SS')=t2.start_time and  t1.mscname=t2.mscname</sql>
				<sql>select t1.MSC,t1.start_time,t1.mscname,t1.proname,t1.city_name,t2.ID301,t2.ID302,t2.ID303,t2.ID304,t2.ID305,t2.ID306,t1.ID7,t1.ID8,t1.ID9,t1.ID10,t1.ID11,t2.ID307,t1.ID13,t1.ID14,t1.ID15,t1.ID16,t1.ID17,t1.ID18,t1.ID19,t1.ID20,t2.ID308,t2.ID309,t1.ID23,t1.ID24,t1.ID25,t1.ID26,t1.ID27,t1.ID28,t1.ID29,t1.ID30,t1.ID31,t1.ID32,t1.ID33,t1.ID34,t1.ID35,t1.ID36,t1.ID37,t1.ID38,t1.ID39,t1.ID40,t1.ID41,t1.ID42,t1.ID43,t1.ID44,t1.ID45,t1.ID46,t1.ID47,t1.ID48,t1.ID49,t1.ID50,t1.ID51,t1.ID52,t1.ID53,t1.ID54,t1.ID55,t1.ID56,t1.ID57,t1.ID58,t1.ID59,t1.ID60,t1.ID61,t1.ID62,t1.ID63,t1.ID64,t1.ID65,t1.ID66,t1.ID67,t1.ID68,t1.ID69,t1.ID70,t1.ID71,t1.ID72,t1.ID73,t1.ID74,t1.ID75,t1.ID76,t1.ID77,t1.ID78,t1.ID79,t1.ID80,t1.ID81,t1.ID82,t1.ID83,t1.ID84,t1.ID85,t1.ID86,t1.ID87,t1.ID88,t1.ID89,t1.ID90,t1.ID91,t1.ID92,t1.ID93,t1.ID94,t1.ID95,t1.ID96,t1.ID97,t1.ID98,t1.ID99,t1.ID100,t1.ID101,t1.ID102,t1.ID103,t1.ID104,t1.ID105,t1.ID106,t1.ID107,t1.ID108,t1.ID109,t1.ID110,t1.ID111,t1.ID112,t1.ID113,t1.ID114,t1.ID115,t1.ID116,t1.ID117,t1.ID118,t1.ID119,t1.ID120,t1.ID121,t1.ID122,t1.ID123,t2.ID310,t2.ID311,t2.ID312,t2.ID313,t2.ID314,t2.ID315,t2.ID316,t2.ID317,t2.ID318,t2.ID319,t2.ID320,t1.ID135,t1.ID136,t1.ID137,t1.ID138,t1.ID139,t1.ID140,t1.ID141,t1.ID142,t1.ID143,t1.ID144,t1.ID145,t1.ID146,t1.ID147,t1.ID148,t1.ID149,t1.ID150,t1.ID151,t1.ID152,t1.ID153,t1.ID154,t1.ID155,t1.ID156 
from (select b.mscname as MSC,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,b.mscname,'${province_cn}' as proname,(select mapcity2.city_name from (select rownum as num,mapcity.* from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity)mapcity2 where mapcity2.num in(select min(num) from (
select rownum as num,mapcity.msc from (select distinct b.mscname as msc, d.city_name
  from cfg_bsc_map_city b, cfg_city d
 where b.city_id = d.city_id
 order by b.mscname)mapcity) group by msc) and mapcity2.msc=b.mscname) as city_name,null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,CASE WHEN SUM(RCE_RLB_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RCE_MAX_BUSY_NUM_DO) / SUM(RCE_RLB_NUM_DO) * 100, 2) END  as ID7,SUM(RCE_MAX_BUSY_NUM_DO) as ID8,SUM(RCE_RLB_NUM_DO) as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN SUM(nvl(DO_CONN_ATT,0))=0 THEN 0 WHEN SUM(nvl(DO_SUC_CONN_NUM,0))&gt;=SUM(nvl(DO_CONN_ATT,0)) THEN 99.99 ELSE ROUND(SUM(nvl(DO_SUC_CONN_NUM,0)) / SUM(nvl(DO_CONN_ATT,0)) * 100, 2) END as ID23,CASE WHEN SUM(nvl(AT_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_CONN_SUC_DO,0))/SUM(nvl(AT_CONN_ATT_DO,0))*100,4) END as ID24,CASE WHEN SUM(nvl(AN_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AN_CONN_SUC_DO,0))/SUM(nvl(AN_CONN_ATT_DO,0))*100,4) END as ID25,SUM(nvl(AT_CONN_ATT_DO,0)) as ID26,SUM(nvl(AN_CONN_ATT_DO,0)) as ID27,SUM(nvl(AT_CONN_SUC_DO,0)) as ID28,SUM(nvl(AN_CONN_SUC_DO,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,SUM(CONN_SETUP_FAILED_RESF_DO) as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))-SUM(REL_NUM_PDSN_DO) as ID39,SUM(REL_NUM_PDSN_DO) as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))=0 THEN 0 ELSE ROUND((SUM(REL_NUM_PDSN_DO)+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100/SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)),4) END as ID45,CASE WHEN (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_SETUP_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID46,CASE WHEN  (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))&gt;=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(UATI_ATT_FAILED_NUM_DO) as ID54,SUM(UATI_AVG_SETUP_DURATION_DO) as ID55,CASE WHEN SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(AUTH_SUC_DO)/(SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO))*100,4) END as ID56,SUM(AUTH_SUC_DO) as ID57,SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO) as ID58,SUM(AUTH_DENY_NUM_DO) as ID59,SUM(AUTH_FAILED_NUM_DO) as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,CASE WHEN SUM(SESS_INTER_AN_DORMHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_INTER_AN_DORMHO_SUC_DO)/SUM(SESS_INTER_AN_DORMHO_ATT_DO)*100,4) END as ID64,SUM(SESS_INTER_AN_DORMHO_ATT_DO) as ID65,SUM(SESS_INTER_AN_DORMHO_SUC_DO) as ID66,SUM(SESSION_ACTIVE_NUM_DO)+SUM(SESSION_NON_ACTIVE_NUM_DO) as ID67,SUM(SESSION_ACTIVE_NUM_DO) as ID68,SUM(SESSION_NON_ACTIVE_NUM_DO) as ID69,CASE WHEN (SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO)) /(SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO)) * 100, 2) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AN_DOR2ACT_SUC_DO)/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(TRAFFIC_DO) as ID81,SUM(TRAFFIC_DO) as ID82,SUM(TRAFFIC_DO)+SUM(SFT_HO_TRAFFIC_DO) as ID83,SUM(SFT_HO_TRAFFIC_DO) as ID84,CASE WHEN SUM(TRAFFIC_DO)=0 THEN 0 ELSE ROUND(SUM(SFT_HO_TRAFFIC_DO)/SUM(TRAFFIC_DO)*100,4) END as ID85,SUM(REV_THROUGHOUT_PCF_DO) as ID86,SUM(FWD_THROUGHOUT_PCF_DO) as ID87,SUM(REV_PAK_TOTAL_NUM_DO) as ID88,SUM(FWD_PAK_TOTAL_NUM_DO) as ID89,null as ID90,SUM(FWD_PAK_DISCARD_NUM_DO) as ID91,null as ID92,CASE WHEN SUM(FWD_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(FWD_PAK_DISCARD_NUM_DO)/SUM(FWD_PAK_TOTAL_NUM_DO),4) END as ID93,ROUND(SUM(RLP_TXBYTENUM) * 8.0 / 1000 / 3600,4) as ID94,CASE WHEN SUM(FWD_RLP_AVG_THROUGHPUT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_AVG_THROUGHPUT_DO)/1000/3600*8*100,4) END as ID95,ROUND(SUM(DO_RTCH_RLP_TX) * 8.0 / 1000 / 3600,4) as ID96,CASE WHEN SUM(DO_RTCH_RLP_TX)=0 THEN 0 ELSE ROUND(SUM(RTCH_RLP_RETX_DO)/SUM(DO_RTCH_RLP_TX)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FTCH_PHY_SLOT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/SUM(FTCH_PHY_SLOT_DO)*100,4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(RLP_CALLKDURATION)=0 THEN 0 ELSE ROUND(SUM(RTCH_PHY_TX_BIT_DO)/SUM(RLP_CALLKDURATION)*100,4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),4) as ID102,ROUND(AVG(FWD_PHY_CCH_SLOT_RATE_DO),4) as ID103,null as ID104,CASE WHEN SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RAB_BUSY_NUM_DO)/(SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO))*100,4) END as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))&gt;=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,CASE WHEN SUM(INN_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_BS_SHO_SUC_DO)/SUM(INN_BS_SHO_ATT_DO),4) END as ID109,SUM(INN_BS_SHO_ATT_DO) as ID110,SUM(INN_BS_SHO_SUC_DO) as ID111,CASE WHEN SUM(INTER_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_BS_SHO_SUC_DO)/SUM(INTER_BS_SHO_ATT_DO),4) END as ID112,SUM(INTER_BS_SHO_ATT_DO) as ID113,SUM(INTER_BS_SHO_SUC_DO) as ID114,CASE WHEN SUM(INN_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_AN_HHO_SUC_DO)/SUM(INN_AN_HHO_ATT_DO)*100,4) END as ID115,SUM(INN_AN_HHO_ATT_DO) as ID116,SUM(INN_AN_HHO_SUC_DO) as ID117,CASE WHEN SUM(INTER_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_AN_HHO_ATT_DO)/SUM(INTER_AN_HHO_ATT_DO),4) END as ID118,SUM(INTER_AN_HHO_ATT_DO) as ID119,SUM(INTER_AN_HHO_SUC_DO) as ID120,CASE WHEN SUM(PAGE_ATT_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(PAGE_SUC_NUM_DO)/SUM(PAGE_ATT_NUM_DO)*100,4) END as ID121,SUM(PAGE_ATT_NUM_DO) as ID122,SUM(PAGE_SUC_NUM_DO) as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,SUM(DO_SETUP_TIME) as ID135,SUM(DO_CONNECT_TIME) as ID136,SUM(SESS_SETUP_TOTAL_DUR_DO) as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_AVG_THROUGHPUT_DO)*1024 as ID139,SUM(RTCH_RLP_RETX_DO) as ID140,SUM(DO_RTCH_RLP_TX) as ID141,SUM(RAB_BUSY_NUM_DO) as ID142,SUM(RAB_IDLE_NUM_DO) as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FTCH_PHY_SLOT_DO) as ID149,SUM(RTCH_PHY_TX_BIT_DO) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
 from perf_bsc_c c, cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.vendor ='ZY0804' 
 and c.CITY_ID=b.city_id group by b.mscname, start_time order by b.mscname, start_time) 
  t1 left join (select b.mscname as MSC,start_time,b.mscname,
  SUM(DO_BTS_TOTAL_NUM) as ID301,SUM(ONE_CARR_BTS_NUM_DO) as ID302,SUM(TWO_CARR_BTS_NUM_DO) as ID303,SUM(THREE_CARR_BTS_NUM_DO) as ID304,SUM(FOUR_CARR_BTS_NUM_DO) as ID305,SUM(DO_CARR_TOTAL_NUM) as ID306,SUM(PCF_TOTAL_NUM) as ID307,SUM(EX_BUSY_BTS_NUM_DO) as ID308,SUM(IDLE_BTS_NUM_DO) as ID309,SUM(CARR_NUM_37) as ID310,SUM(CARR_NUM_78) as ID311,SUM(CARR_NUM_119) as ID312,SUM(DO_CARR_TOTAL_NUM) as ID313,SUM(TRAFFIC_37) as ID314,SUM(TRAFFIC_78) as ID315,SUM(TRAFFIC_119) as ID316,SUM(DO_1CARR_CELL_NUM) as ID317,SUM(DO_2CARR_CELL_NUM) as ID318,SUM(DO_3CARR_CELL_NUM) as ID319,SUM(DO_CELL_TOTAL_NUM) as ID320
   from perf_bsc_resource c,cfg_bsc_map_city b where c.ne_sys_id = b.ne_bsc_id and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and c.CITY_ID=b.city_id group by b.mscname,start_time order by b.mscname, start_time) t2 on to_date(t1.start_time, 'YYYY-MM-DD HH24:MI:SS')=t2.start_time and  t1.mscname=t2.mscname</sql>
			</mapping>
			<mapping name="${province_en}_PERF_CITY_1X_%%Y%%M%%D.csv" templet="性能数据模板CITY1X后台.ftl">
				<sql>select b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,b2,b3,b4,ID1,ID2,ID3,ID4,ID5,ID6,ID7,ID8,ID9,ID10,ID11,ID12,ID13,ID14,ID15,ID16,ID17,ID18,ID19,ID20,ID21,ID22,ID23,ID24,ID25,ID26,ID27,ID28,ID29,ID30,ID31,ID32,ID33,ID34,ID35,ID36,ID37,ID38,ID39,ID40,ID41,ID42,ID43,ID44,ID45,ID46,ID47,ID48,ID49,ID50,ID51,ID52,ID53,ID54,ID55,ID56,ID57,ID58,ID59,ID60,ID61,ID62,ID63,ID64,ID65,ID66,ID67,ID68,ID69,ID70,ID71,ID72,ID73,ID74,ID75,ID76,ID77,ID78,ID79,ID80,ID81,ID82,ID83,ID84,ID85,ID86,ID87,ID88,ID89,ID90,ID91,ID92,ID93,ID94,ID95,ID96,ID97,ID98,ID99,ID100,ID101,ID102,ID103,ID104,ID105,ID106,ID107,ID108,ID109,ID110,ID111,ID112,ID113,ID114,ID115,ID116,ID117,ID118,ID119,ID120,ID121,ID122,ID301,ID302,ID303,ID304,ID305,ID128,ID129,ID130,ID131,ID132,ID133,ID134,ID135,ID136,ID137,ID138,ID139,ID140,ID141,ID142,ID143,ID144,ID145,ID146,ID147,ID148,ID149,ID306,ID307,ID308,ID309,ID310,ID311,ID312,ID313,ID314,ID315,ID160,ID161,ID162,ID163,ID164,ID165,ID166,ID316,ID317,ID318,ID319,ID320,ID172,ID173,ID174,ID175,ID176,ID321,ID178,ID179,ID180,ID181,ID182,ID322,ID323,ID324,ID325,ID326,ID327,ID328,ID329,ID330,ID331,ID193,ID194,ID195,ID196,ID197,ID198,ID199,ID200,ID201,ID202,ID203,ID204,ID205,ID206,ID207,ID208,ID209,ID210,ID211 
from (select t1.b1,t1.start_time,t1.b2,t1.b3,t1.b4,to_char(t1.ID1) as ID1,to_char(t1.ID2) as ID2,to_char(t1.ID3) as ID3,to_char(t1.ID4) as ID4,to_char(t1.ID5) as ID5,to_char(t1.ID6) as ID6,to_char(t1.ID7) as ID7,to_char(t1.ID8) as ID8,to_char(t1.ID9) as ID9,to_char(t1.ID10) as ID10,to_char(t1.ID11) as ID11,to_char(t1.ID12) as ID12,to_char(t1.ID13) as ID13,to_char(t1.ID14) as ID14,to_char(t1.ID15) as ID15,to_char(t1.ID16) as ID16,to_char(t1.ID17) as ID17,to_char(t1.ID18) as ID18,to_char(t1.ID19) as ID19,to_char(t1.ID20) as ID20,to_char(t1.ID21) as ID21,to_char(t1.ID22) as ID22,to_char(t1.ID23) as ID23,to_char(t1.ID24) as ID24,to_char(t1.ID25) as ID25,to_char(t1.ID26) as ID26,to_char(t1.ID27) as ID27,to_char(t1.ID28) as ID28,to_char(t1.ID29) as ID29,to_char(t1.ID30) as ID30,to_char(t1.ID31) as ID31,to_char(t1.ID32) as ID32,to_char(t1.ID33) as ID33,to_char(t1.ID34) as ID34,to_char(t1.ID35) as ID35,to_char(t1.ID36) as ID36,to_char(t1.ID37) as ID37,to_char(t1.ID38) as ID38,to_char(t1.ID39) as ID39,to_char(t1.ID40) as ID40,to_char(t1.ID41) as ID41,to_char(t1.ID42) as ID42,to_char(t1.ID43) as ID43,to_char(t1.ID44) as ID44,to_char(t1.ID45) as ID45,to_char(t1.ID46) as ID46,to_char(t1.ID47) as ID47,to_char(t1.ID48) as ID48,to_char(t1.ID49) as ID49,to_char(t1.ID50) as ID50,to_char(t1.ID51) as ID51,to_char(t1.ID52) as ID52,to_char(t1.ID53) as ID53,to_char(t1.ID54) as ID54,to_char(t1.ID55) as ID55,to_char(t1.ID56) as ID56,to_char(t1.ID57) as ID57,to_char(t1.ID58) as ID58,to_char(t1.ID59) as ID59,to_char(t1.ID60) as ID60,to_char(t1.ID61) as ID61,to_char(t1.ID62) as ID62,to_char(t1.ID63) as ID63,to_char(t1.ID64) as ID64,to_char(t1.ID65) as ID65,to_char(t1.ID66) as ID66,to_char(t1.ID67) as ID67,to_char(t1.ID68) as ID68,to_char(t1.ID69) as ID69,to_char(t1.ID70) as ID70,to_char(t1.ID71) as ID71,to_char(t1.ID72) as ID72,to_char(t1.ID73) as ID73,to_char(t1.ID74) as ID74,to_char(t1.ID75) as ID75,to_char(t1.ID76) as ID76,to_char(t1.ID77) as ID77,to_char(t1.ID78) as ID78,to_char(t1.ID79) as ID79,to_char(t1.ID80) as ID80,to_char(t1.ID81) as ID81,to_char(t1.ID82) as ID82,to_char(t1.ID83) as ID83,to_char(t1.ID84) as ID84,to_char(t1.ID85) as ID85,to_char(t1.ID86) as ID86,to_char(t1.ID87) as ID87,to_char(t1.ID88) as ID88,to_char(t1.ID89) as ID89,to_char(t1.ID90) as ID90,to_char(t1.ID91) as ID91,to_char(t1.ID92) as ID92,to_char(t1.ID93) as ID93,to_char(t1.ID94) as ID94,to_char(t1.ID95) as ID95,to_char(t1.ID96) as ID96,to_char(t1.ID97) as ID97,to_char(t1.ID98) as ID98,to_char(t1.ID99) as ID99,to_char(t1.ID100) as ID100,to_char(t1.ID101) as ID101,to_char(t1.ID102) as ID102,to_char(t1.ID103) as ID103,to_char(t1.ID104) as ID104,to_char(t1.ID105) as ID105,to_char(t1.ID106) as ID106,to_char(t1.ID107) as ID107,to_char(t1.ID108) as ID108,to_char(t1.ID109) as ID109,to_char(t1.ID110) as ID110,to_char(t1.ID111) as ID111,to_char(t1.ID112) as ID112,to_char(t1.ID113) as ID113,to_char(t1.ID114) as ID114,to_char(t1.ID115) as ID115,to_char(t1.ID116) as ID116,to_char(t1.ID117) as ID117,to_char(t1.ID118) as ID118,to_char(t1.ID119) as ID119,to_char(t1.ID120) as ID120,to_char(t1.ID121) as ID121,to_char(t1.ID122) as ID122,to_char(t2.ID301) as ID301,to_char(t2.ID302) as ID302,to_char(t2.ID303) as ID303,to_char(t2.ID304) as ID304,to_char(t2.ID305) as ID305,to_char(t1.ID128) as ID128,to_char(t1.ID129) as ID129,to_char(t1.ID130) as ID130,to_char(t1.ID131) as ID131,to_char(t1.ID132) as ID132,to_char(t1.ID133) as ID133,to_char(t1.ID134) as ID134,to_char(t1.ID135) as ID135,to_char(t1.ID136) as ID136,to_char(t1.ID137) as ID137,to_char(t1.ID138) as ID138,to_char(t1.ID139) as ID139,to_char(t1.ID140) as ID140,to_char(t1.ID141) as ID141,to_char(t1.ID142) as ID142,to_char(t1.ID143) as ID143,to_char(t1.ID144) as ID144,to_char(t1.ID145) as ID145,to_char(t1.ID146) as ID146,to_char(t1.ID147) as ID147,to_char(t1.ID148) as ID148,to_char(t1.ID149) as ID149,to_char(t2.ID306) as ID306,to_char(t2.ID307) as ID307,to_char(t2.ID308) as ID308,to_char(t2.ID309) as ID309,to_char(t2.ID310) as ID310,to_char(t2.ID311) as ID311,to_char(t2.ID312) as ID312,to_char(t2.ID313) as ID313,to_char(t2.ID314) as ID314,to_char(t2.ID315) as ID315,to_char(t1.ID160) as ID160,to_char(t1.ID161) as ID161,to_char(t1.ID162) as ID162,to_char(t1.ID163) as ID163,to_char(t1.ID164) as ID164,to_char(t1.ID165) as ID165,to_char(t1.ID166) as ID166,to_char(t2.ID316) as ID316,to_char(t2.ID317) as ID317,to_char(t2.ID318) as ID318,to_char(t2.ID319) as ID319,to_char(t2.ID320) as ID320,to_char(t1.ID172) as ID172,to_char(t1.ID173) as ID173,to_char(t1.ID174) as ID174,to_char(t1.ID175) as ID175,to_char(t1.ID176) as ID176,to_char(t2.ID321) as ID321,to_char(t1.ID178) as ID178,to_char(t1.ID179) as ID179,to_char(t1.ID180) as ID180,to_char(t1.ID181) as ID181,to_char(t1.ID182) as ID182,to_char(t2.ID322) as ID322,to_char(t2.ID323) as ID323,to_char(t2.ID324) as ID324,to_char(t2.ID325) as ID325,to_char(t2.ID326) as ID326,to_char(t2.ID327) as ID327,to_char(t2.ID328) as ID328,to_char(t2.ID329) as ID329,to_char(t2.ID330) as ID330,to_char(t2.ID331) as ID331,to_char(t1.ID193) as ID193,to_char(t1.ID194) as ID194,to_char(t1.ID195) as ID195,to_char(t1.ID196) as ID196,to_char(t1.ID197) as ID197,to_char(t1.ID198) as ID198,to_char(t1.ID199) as ID199,to_char(t1.ID200) as ID200,to_char(t1.ID201) as ID201,to_char(t1.ID202) as ID202,to_char(t1.ID203) as ID203,to_char(t1.ID204) as ID204,to_char(t1.ID205) as ID205,to_char(t1.ID206) as ID206,to_char(t1.ID207) as ID207,to_char(t1.ID208) as ID208,to_char(t1.ID209) as ID209,to_char(t1.ID210) as ID210,to_char(t1.ID211) as ID211 
from (select '城市' as b1,start_time,c.CITY_NAME as b2,'${province_cn}' as b3,c.CITY_NAME as b4,  
sum(nvl(CALL_ATT,0))+sum(nvl(CALL_ATT_NUM_PS,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(CMO_CALLSUCCNUM_PS,0))+sum(nvl(PAG_SUCC_NUM_PS,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0)))&gt;=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0))+SUM(nvl(PAG_SUCC_NUM_PS,0)))/(SUM(CALL_ATT) + SUM(CALL_ATT_NUM_PS)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))&gt;=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,SUM(CALL_ATT_NUM_PS) as ID7,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS) as ID8,CASE WHEN SUM(CALL_ATT_NUM_PS)=0 THEN 0 WHEN (SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))&gt;=SUM(CALL_ATT_NUM_PS) THEN 99.99ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))/SUM(CALL_ATT_NUM_PS)* 100, 4) END  as ID9,SUM(SHO_TRAFFIC_CS)+SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(TRAFFIC_CS)+SUM(SFT_HO_TRAFFIC_CS) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS)+SUM(SSHO_TRAFFIC_PS) as ID20,SUM(SHO_TRAFFIC_PS) as ID21,SUM(SSHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_TRAFFIC_PS)/SUM(TRAFFIC_PS)* 100, 4) END  as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATE_DROP_NUM,0)) as ID24,CASE WHEN (SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(DATA_SRLSNUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))&lt;=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))/(SUM(TCH_ASSIGN_SUC) + SUM(DATA_SRLSNUM_PS)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,SUM(DATE_DROP_NUM) as ID30,CASE WHEN SUM(DATA_SRLSNUM_PS)=0 THEN 0 WHEN SUM(DATE_DROP_NUM)&lt;=0 THEN 0.01 ELSE ROUND(SUM(DATE_DROP_NUM)/SUM(DATA_SRLSNUM_PS),4)*100 END as ID31,CASE WHEN SUM(DATE_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/SUM(DATE_DROP_NUM),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID33,SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID34,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID35,CASE WHEN (SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM))/(SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)-(SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)) as ID39,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS))=0 THEN 0 ELSE ROUND(((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,2) END as ID40,SUM(TCH_BLOCK_COUNT)+ SUM(TCH_BLOCK_NUM_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT) + SUM(TCH_BLOCK_NUM_PS))*100/SUM(TCH_SETUP_ATT),2) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0   ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT),4)*100 END as ID52,SUM(BSS_HHO_ATT) as ID53,SUM(BSS_HHO_SUC) as ID54,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND((SUM(BSS_HHO_ATT) - SUM(BSS_HHO_SUC)) / SUM(BSS_HHO_ATT) * 100,4) END as ID55,SUM(S_SHO_ATT) as ID56,SUM(S_SHO_SUC) as ID57,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(S_SHO_ATT) - SUM(S_SHO_SUC)) / SUM(S_SHO_ATT) * 100,4) END as ID58,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID59,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID60,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID61,CASE WHEN SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(HHO_SUC_NUM_PS) + SUM(SHO_SUC_NUM_PS) +SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS))*100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(TCH_ASSIGN_SUC_PS) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(TCH_ASSIGN_SUC_PS) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_PS)/SUM(TCH_ASSIGN_ATT_PS) * 100,2) END as ID66,SUM(TCH_BLOCK_NUM_PS) as ID67,CASE WHEN (SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_NUM_PS)/(SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID68,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID69,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID70,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_PS)-SUM(TCH_ASSIGN_SUC_HHO_PS))/SUM(TCH_ASSIGN_ATT_HHO_PS) * 100,2) END as ID71,SUM(TCH_ASSIGN_ATT_SHO_PS) as ID72,SUM(TCH_ASSIGN_SUC_SHO_PS) as ID73,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_PS)-SUM(TCH_ASSIGN_SUC_SHO_PS))/SUM(TCH_ASSIGN_ATT_SHO_PS) * 100,2) END as ID74,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID75,SUM(INNER_BSC_HHO_SUCC)+ SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC) as ID76,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC))*100/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT)),2) END as ID77,SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT) as ID78,SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC) as ID79,CASE WHEN (SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)) = 0 THEN 0 ELSE  ROUND( (SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC))/(SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)), 3) * 100 END as ID80,SUM(BSS_HHO_ATT) as ID81,SUM(BSS_HHO_SUC) as ID82,CASE WHEN SUM(BSS_HHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT),4) * 100 END as ID83,SUM(S_SHO_ATT)-SUM(S_SSHO_ATT) as ID84,SUM(S_SHO_SUC)-SUM(S_SSHO_SUC) as ID85,CASE WHEN (SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)) = 0 THEN 0 ELSE  ROUND((SUM(S_SHO_SUC)-SUM(S_SSHO_SUC))/(SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)),4) * 100 END as ID86,SUM(S_SSHO_ATT) as ID87,SUM(S_SSHO_SUC) as ID88,CASE WHEN SUM(S_SSHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(S_SSHO_SUC)/SUM(S_SSHO_ATT),4) * 100 END as ID89,SUM(DATE_HO_ATT_NUM) as ID90,SUM(DATA_HO_SUCC_NUM) as ID91,CASE WHEN SUM(DATE_HO_ATT_NUM)=0 THEN 0 ELSE ROUND(SUM(DATA_HO_SUCC_NUM)/SUM(DATE_HO_ATT_NUM) * 100,2) END as ID92,SUM(HHO_ATT_NUM_PS) as ID93,SUM(HHO_SUC_NUM_PS) as ID94,CASE WHEN SUM(HHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(HHO_SUC_NUM_PS)/SUM(HHO_ATT_NUM_PS) * 100,2) END as ID95,SUM(SHO_ATT_NUM_PS) as ID96,SUM(SHO_SUC_NUM_PS) as ID97,CASE WHEN SUM(SHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_SUC_NUM_PS)/SUM(SHO_ATT_NUM_PS) * 100,2) END as ID98,SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID99,SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID100,CASE WHEN SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)) * 100,4) END as ID101,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT) as ID102,SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC) as ID103,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC))/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)) * 100,2) END as ID104,SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID105,SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC) as ID106,CASE WHEN SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC))/(SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)) * 100,4) END as ID107,SUM(INNER_BSC_HHO_ATT) as ID108,SUM(INNER_BSC_HHO_SUCC) as ID109,CASE WHEN SUM(INNER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_HHO_SUCC) / SUM(INNER_BSC_HHO_ATT) * 100,4) END as ID110,SUM(INNER_BSC_SHO_ATT) as ID111,SUM(INNER_BSC_SHO_SUCC) as ID112,CASE WHEN SUM(INNER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SHO_SUCC) / SUM(INNER_BSC_SHO_ATT) * 100,4) END as ID113,SUM(INNER_BSC_SOFTERHO_ATT) as ID114,SUM(INNER_BSC_SOFTERHO_SUCC) as ID115,CASE WHEN SUM(INNER_BSC_SOFTERHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SOFTERHO_SUCC) / SUM(INNER_BSC_SOFTERHO_ATT) * 100,4) END as ID116,SUM(INTER_BSC_HHO_ATT) as ID117,SUM(INTER_BSC_HHO_SUCC) as ID118,CASE WHEN SUM(INTER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_HHO_SUCC) / SUM(INTER_BSC_HHO_ATT) * 100,4) END as ID119,SUM(INTER_BSC_SHO_ATT) as ID120,SUM(INTER_BSC_SHO_SUCC) as ID121,CASE WHEN SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_SHO_SUCC) / SUM(INTER_BSC_SHO_ATT) * 100,4) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID128,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID129,SUM(FWD_CH_MAX_NUM)+SUM(REV_CH_MAX_NUM) as ID130,CASE WHEN SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND((SUM(FWD_CH_MAX_NUM) + SUM(REV_CH_MAX_NUM))/(SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)) * 100,4) END as ID131,SUM(FWD_CH_NUM) as ID132,SUM(FWD_CH_RLB_NUM) as ID133,SUM(FWD_CH_MAX_NUM) as ID134,CASE WHEN SUM(FWD_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(FWD_CH_MAX_NUM) / SUM(FWD_CH_RLB_NUM)*100,4) END as ID135,SUM(REV_CH_NUM) as ID136,SUM(REV_CH_RLB_NUM) as ID137,SUM(REV_CH_MAX_NUM) as ID138,CASE WHEN SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(REV_CH_MAX_NUM)/SUM(REV_CH_RLB_NUM)*100,4) END as ID139,SUM(RETX_FRM_NUM_FWD_1X) as ID140,SUM(TX_FRM_NUM_FWD_1X) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,SUM(RETX_FRM_NUM_REV_1X) as ID146,SUM(TX_FRM_NUM_REV_1X) as ID147,null as ID148,CASE WHEN SUM(TX_FRM_NUM_REV_1X)=0 THEN 0 ELSE ROUND(SUM(RETX_FRM_NUM_REV_1X)/SUM(TX_FRM_NUM_REV_1X) * 100,2) END as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID160,round(AVG(WIRELESS_CAPACITY),2) as ID161,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID162,case when SUM(WIRELESS_CAPACITY) = 0 then 0 else ROUND(SUM(SHO_TRAFFIC_CS) / SUM(WIRELESS_CAPACITY) * 100, 2) end as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT) * 100,2) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)),2) END as ID176,null as ID177,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211   
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0804'
and d.city_id &lt;&gt; 728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '城市' as b1,start_time,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b2,'${province_cn}' as b3,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b4,  
sum(nvl(CALL_ATT,0))+sum(nvl(CALL_ATT_NUM_PS,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(CMO_CALLSUCCNUM_PS,0))+sum(nvl(PAG_SUCC_NUM_PS,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0)))&gt;=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0))+SUM(nvl(PAG_SUCC_NUM_PS,0)))/(SUM(CALL_ATT) + SUM(CALL_ATT_NUM_PS)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))&gt;=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,SUM(CALL_ATT_NUM_PS) as ID7,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS) as ID8,CASE WHEN SUM(CALL_ATT_NUM_PS)=0 THEN 0 WHEN (SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))&gt;=SUM(CALL_ATT_NUM_PS) THEN 99.99ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))/SUM(CALL_ATT_NUM_PS)* 100, 4) END  as ID9,SUM(SHO_TRAFFIC_CS)+SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(TRAFFIC_CS)+SUM(SFT_HO_TRAFFIC_CS) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS)+SUM(SSHO_TRAFFIC_PS) as ID20,SUM(SHO_TRAFFIC_PS) as ID21,SUM(SSHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_TRAFFIC_PS)/SUM(TRAFFIC_PS)* 100, 4) END  as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATE_DROP_NUM,0)) as ID24,CASE WHEN (SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(DATA_SRLSNUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))&lt;=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))/(SUM(TCH_ASSIGN_SUC) + SUM(DATA_SRLSNUM_PS)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,SUM(DATE_DROP_NUM) as ID30,CASE WHEN SUM(DATA_SRLSNUM_PS)=0 THEN 0 WHEN SUM(DATE_DROP_NUM)&lt;=0 THEN 0.01 ELSE ROUND(SUM(DATE_DROP_NUM)/SUM(DATA_SRLSNUM_PS),4)*100 END as ID31,CASE WHEN SUM(DATE_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/SUM(DATE_DROP_NUM),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID33,SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID34,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID35,CASE WHEN (SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM))/(SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)-(SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)) as ID39,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS))=0 THEN 0 ELSE ROUND(((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,2) END as ID40,SUM(TCH_BLOCK_COUNT)+ SUM(TCH_BLOCK_NUM_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT) + SUM(TCH_BLOCK_NUM_PS))*100/SUM(TCH_SETUP_ATT),2) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0   ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT),4)*100 END as ID52,SUM(BSS_HHO_ATT) as ID53,SUM(BSS_HHO_SUC) as ID54,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND((SUM(BSS_HHO_ATT) - SUM(BSS_HHO_SUC)) / SUM(BSS_HHO_ATT) * 100,4) END as ID55,SUM(S_SHO_ATT) as ID56,SUM(S_SHO_SUC) as ID57,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(S_SHO_ATT) - SUM(S_SHO_SUC)) / SUM(S_SHO_ATT) * 100,4) END as ID58,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID59,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID60,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID61,CASE WHEN SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(HHO_SUC_NUM_PS) + SUM(SHO_SUC_NUM_PS) +SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS))*100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(TCH_ASSIGN_SUC_PS) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(TCH_ASSIGN_SUC_PS) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_PS)/SUM(TCH_ASSIGN_ATT_PS) * 100,2) END as ID66,SUM(TCH_BLOCK_NUM_PS) as ID67,CASE WHEN (SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_NUM_PS)/(SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID68,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID69,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID70,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_PS)-SUM(TCH_ASSIGN_SUC_HHO_PS))/SUM(TCH_ASSIGN_ATT_HHO_PS) * 100,2) END as ID71,SUM(TCH_ASSIGN_ATT_SHO_PS) as ID72,SUM(TCH_ASSIGN_SUC_SHO_PS) as ID73,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_PS)-SUM(TCH_ASSIGN_SUC_SHO_PS))/SUM(TCH_ASSIGN_ATT_SHO_PS) * 100,2) END as ID74,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID75,SUM(INNER_BSC_HHO_SUCC)+ SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC) as ID76,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC))*100/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT)),2) END as ID77,SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT) as ID78,SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC) as ID79,CASE WHEN (SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)) = 0 THEN 0 ELSE  ROUND( (SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC))/(SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)), 3) * 100 END as ID80,SUM(BSS_HHO_ATT) as ID81,SUM(BSS_HHO_SUC) as ID82,CASE WHEN SUM(BSS_HHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT),4) * 100 END as ID83,SUM(S_SHO_ATT)-SUM(S_SSHO_ATT) as ID84,SUM(S_SHO_SUC)-SUM(S_SSHO_SUC) as ID85,CASE WHEN (SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)) = 0 THEN 0 ELSE  ROUND((SUM(S_SHO_SUC)-SUM(S_SSHO_SUC))/(SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)),4) * 100 END as ID86,SUM(S_SSHO_ATT) as ID87,SUM(S_SSHO_SUC) as ID88,CASE WHEN SUM(S_SSHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(S_SSHO_SUC)/SUM(S_SSHO_ATT),4) * 100 END as ID89,SUM(DATE_HO_ATT_NUM) as ID90,SUM(DATA_HO_SUCC_NUM) as ID91,CASE WHEN SUM(DATE_HO_ATT_NUM)=0 THEN 0 ELSE ROUND(SUM(DATA_HO_SUCC_NUM)/SUM(DATE_HO_ATT_NUM) * 100,2) END as ID92,SUM(HHO_ATT_NUM_PS) as ID93,SUM(HHO_SUC_NUM_PS) as ID94,CASE WHEN SUM(HHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(HHO_SUC_NUM_PS)/SUM(HHO_ATT_NUM_PS) * 100,2) END as ID95,SUM(SHO_ATT_NUM_PS) as ID96,SUM(SHO_SUC_NUM_PS) as ID97,CASE WHEN SUM(SHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_SUC_NUM_PS)/SUM(SHO_ATT_NUM_PS) * 100,2) END as ID98,SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID99,SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID100,CASE WHEN SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)) * 100,4) END as ID101,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT) as ID102,SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC) as ID103,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC))/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)) * 100,2) END as ID104,SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID105,SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC) as ID106,CASE WHEN SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC))/(SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)) * 100,4) END as ID107,SUM(INNER_BSC_HHO_ATT) as ID108,SUM(INNER_BSC_HHO_SUCC) as ID109,CASE WHEN SUM(INNER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_HHO_SUCC) / SUM(INNER_BSC_HHO_ATT) * 100,4) END as ID110,SUM(INNER_BSC_SHO_ATT) as ID111,SUM(INNER_BSC_SHO_SUCC) as ID112,CASE WHEN SUM(INNER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SHO_SUCC) / SUM(INNER_BSC_SHO_ATT) * 100,4) END as ID113,SUM(INNER_BSC_SOFTERHO_ATT) as ID114,SUM(INNER_BSC_SOFTERHO_SUCC) as ID115,CASE WHEN SUM(INNER_BSC_SOFTERHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SOFTERHO_SUCC) / SUM(INNER_BSC_SOFTERHO_ATT) * 100,4) END as ID116,SUM(INTER_BSC_HHO_ATT) as ID117,SUM(INTER_BSC_HHO_SUCC) as ID118,CASE WHEN SUM(INTER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_HHO_SUCC) / SUM(INTER_BSC_HHO_ATT) * 100,4) END as ID119,SUM(INTER_BSC_SHO_ATT) as ID120,SUM(INTER_BSC_SHO_SUCC) as ID121,CASE WHEN SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_SHO_SUCC) / SUM(INTER_BSC_SHO_ATT) * 100,4) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID128,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID129,SUM(FWD_CH_MAX_NUM)+SUM(REV_CH_MAX_NUM) as ID130,CASE WHEN SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND((SUM(FWD_CH_MAX_NUM) + SUM(REV_CH_MAX_NUM))/(SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)) * 100,4) END as ID131,SUM(FWD_CH_NUM) as ID132,SUM(FWD_CH_RLB_NUM) as ID133,SUM(FWD_CH_MAX_NUM) as ID134,CASE WHEN SUM(FWD_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(FWD_CH_MAX_NUM) / SUM(FWD_CH_RLB_NUM)*100,4) END as ID135,SUM(REV_CH_NUM) as ID136,SUM(REV_CH_RLB_NUM) as ID137,SUM(REV_CH_MAX_NUM) as ID138,CASE WHEN SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(REV_CH_MAX_NUM)/SUM(REV_CH_RLB_NUM)*100,4) END as ID139,SUM(RETX_FRM_NUM_FWD_1X) as ID140,SUM(TX_FRM_NUM_FWD_1X) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,SUM(RETX_FRM_NUM_REV_1X) as ID146,SUM(TX_FRM_NUM_REV_1X) as ID147,null as ID148,CASE WHEN SUM(TX_FRM_NUM_REV_1X)=0 THEN 0 ELSE ROUND(SUM(RETX_FRM_NUM_REV_1X)/SUM(TX_FRM_NUM_REV_1X) * 100,2) END as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID160,round(AVG(WIRELESS_CAPACITY),2) as ID161,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID162,case when SUM(WIRELESS_CAPACITY) = 0 then 0 else ROUND(SUM(SHO_TRAFFIC_CS) / SUM(WIRELESS_CAPACITY) * 100, 2) end as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT) * 100,2) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)),2) END as ID176,null as ID177,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211   
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d, CFG_COUNTY ADM
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0804'
and d.city_id= 728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
and adm.city_id  = d.city_id
group by start_time,c.CITY_NAME,case when c.CITY_NAME = '江汉' then  case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else  c.CITY_NAME end
union all
select '城市' as b1,start_time,c.CITY_NAME as b2,'${province_cn}' as b3,c.CITY_NAME as b4,  
sum(nvl(CALL_ATT,0))+sum(nvl(DATACALLATT3G,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(ESTDATACALLS3G,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))&gt;=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))/(SUM(CALL_ATT) + SUM(DATACALLATT3G)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))&gt;=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,sum(DATACALLATT3G) as ID7,sum(ESTDATACALLS3G) as ID8,CASE WHEN sum(DATACALLATT3G)=0 THEN 0 WHEN sum(ESTDATACALLS3G)&gt;=sum(DATACALLATT3G) THEN 99.99 ELSE ROUND(sum(ESTDATACALLS3G)/sum(DATACALLATT3G) * 100,2) END as ID9,SUM(nvl(SHO_TRAFFIC_CS,0)) + SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(WALSHCODE_ERL_PS) as ID20,SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS) as ID21,SUM(WALSHCODE_ERL_PS)-SUM(SHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS))/SUM(TRAFFIC_PS) * 100,2) END as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATACALLSDROP,0)) as ID24,CASE WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))&lt;=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))/(SUM(CALL_SETUP_SUCC_CS) + SUM(ESTDATACALLS3G)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + sum(DATACALLSDROP))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + sum(DATACALLSDROP)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,sum(DATACALLSDROP) as ID30,CASE WHEN SUM(nvl(ESTDATACALLS3G,0))=0 THEN 0 WHEN sum(DATACALLSDROP)&lt;=0 THEN 0.01 ELSE ROUND(sum(DATACALLSDROP)/SUM(nvl(ESTDATACALLS3G,0)) * 100,2) END as ID31,CASE WHEN sum(DATACALLSDROP)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/sum(DATACALLSDROP),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(TCH_ASSIGN_ATT_HO_PS) as ID33,SUM(TCH_SETUP_SUC)+SUM(TCH_ASSIGN_SUC_HO_PS) as ID34,(SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC))+(SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS)) as ID35,CASE WHEN SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)) * 100,4) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID39,CASE WHEN SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND((SUM(nvl(CALL_SETUP_SUCC_CS, 0))+SUM(nvl(ESTDATACALLS3G, 0)))/(SUM(O_TCH_ASSIGN_ATT) + SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,4) END as ID40,SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS) -SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)) * 100,4) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC)*100/SUM(TCH_SETUP_ATT),2) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)*100/SUM(TCH_SETUP_ATT),2) END as ID52,SUM(VOICECALLHARDHOREQ) as ID53,SUM(VOICECALLHARDHOCOMPLET) as ID54,CASE WHEN SUM(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(VOICECALLHARDHOREQ)-SUM(VOICECALLHARDHOCOMPLET))/SUM(VOICECALLHARDHOREQ) * 100,4) END as ID55,SUM(TCH_SETUP_ATT)-SUM(TCH_ASSIGN_ATT_NUM)-SUM(BSS_HHO_ATT) as ID56,SUM(TCH_SETUP_SUC)-SUM(TCH_ASSIGN_SUC)-SUM(BSS_HHO_SUC) as ID57,CASE WHEN SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(((SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) -(SUM(TCH_SETUP_SUC) - SUM(TCH_ASSIGN_SUC) - SUM(BSS_HHO_SUC))) /(SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) * 100,4) END as ID58,SUM(TCH_ASSIGN_ATT_HO_PS) as ID59,SUM(TCH_ASSIGN_SUC_HO_PS) as ID60,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID61,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_HO_PS) / SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(nvl(ESTDATACALLS3G,0)) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(nvl(ESTDATACALLS3G, 0)) / SUM(TCH_ASSIGN_ATT_PS) * 100,4) END as ID66,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID67,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS))/SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID68,SUM(DATACALLHARDHOREQ) as ID69,SUM(DATACALLHARDHOCOMPLET) as ID70,CASE WHEN SUM(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(DATACALLHARDHOREQ)-SUM(DATACALLHARDHOCOMPLET))/SUM(DATACALLHARDHOREQ) * 100,4) END as ID71,SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ) as ID72,SUM(DATACALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTHOCOMPLET) as ID73,CASE WHEN SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(((SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ))-(SUM(DATACALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTHOCOMPLET)))/(SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ))*100,4) END as ID74,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID75,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID76,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID77,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID78,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID79,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID80,sum(VOICECALLHARDHOREQ) as ID81,sum(VOICECALLHARDHOCOMPLET) as ID82,CASE WHEN sum(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLHARDHOCOMPLET)*100/sum(VOICECALLHARDHOREQ),2) END as ID83,sum(VOICECALLSOFTHOREQ) as ID84,sum(VOICECALLSOFTHOCOMPLET) as ID85,CASE WHEN sum(VOICECALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTHOCOMPLET)*100/sum(VOICECALLSOFTHOREQ),2) END as ID86,sum(VOICECALLSOFTERHOREQ) as ID87,sum(VOICECALLSOFTERHOCOMPLET) as ID88,CASE WHEN sum(VOICECALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTERHOCOMPLET)*100/sum(VOICECALLSOFTERHOREQ),2) END as ID89,sum(DATACALLHOREQ) as ID90,sum(DATACALLHOCOMPLET) as ID91,CASE WHEN sum(DATACALLHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHOCOMPLET)/sum(DATACALLHOREQ) * 100,2) END as ID92,sum(DATACALLHARDHOREQ) as ID93,sum(DATACALLHARDHOCOMPLET) as ID94,CASE WHEN sum(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHARDHOCOMPLET)/sum(DATACALLHARDHOREQ) * 100,2) END as ID95,sum(DATACALLSOFTHOREQ) as ID96,sum(DATACALLSOFTHOCOMPLET) as ID97,CASE WHEN sum(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLSOFTHOCOMPLET)/sum(DATACALLSOFTHOREQ) * 100,2) END as ID98,SUM(DATACALLSOFTERHOREQ) as ID99,SUM(DATACALLSOFTERHOCOMPLET) as ID100,CASE WHEN SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(SUM(DATACALLSOFTERHOCOMPLET)/SUM(DATACALLSOFTERHOREQ) * 100,2) END as ID101,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID102,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTRAMSCSOFTHOCOMPLET)+SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID103,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTRAMSCSOFTHOCOMPLET) +SUM(VOICECALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTERHOCOMPLET)) /(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ) +SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)) * 100,4) END as ID104,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTERMSCSOFTHOREQ) as ID105,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTERMSCSOFTHOCOMPLET) as ID106,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTERMSCSOFTHOCOMPLET))/(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)) * 100,4) END as ID107,sum(THEINTERMSCHARDHOREQ) as ID108,sum(THEINTERMSCHARDHOCOMPLET) as ID109,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID110,SUM(THEINTRAMSCSOFTHOREQ) as ID111,SUM(THEINTRAMSCSOFTHOCOMPLET) as ID112,CASE WHEN SUM(THEINTRAMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTRAMSCSOFTHOCOMPLET)/SUM(THEINTRAMSCSOFTHOREQ) * 100,2) END as ID113,SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID114,SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID115,CASE WHEN (SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ))=0 THEN 0 ELSE ROUND((SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET))/(SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ)) * 100,2) END as ID116,sum(THEINTERMSCHARDHOREQ) as ID117,sum(THEINTERMSCHARDHOCOMPLET) as ID118,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID119,SUM(THEINTERMSCSOFTHOREQ) as ID120,SUM(THEINTERMSCSOFTHOCOMPLET) as ID121,CASE WHEN SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTERMSCSOFTHOCOMPLET)/SUM(THEINTERMSCSOFTHOREQ) * 100,2) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,SUM(CH_RLB_NUM) as ID129,SUM(CH_MAX_NUM) as ID130,CASE WHEN SUM(CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(CH_MAX_NUM)/SUM(CH_RLB_NUM)*100,4) END as ID131,null as ID132,null as ID133,null as ID134,null as ID135,null as ID136,null as ID137,null as ID138,null as ID139,null as ID140,SUM(FWD_RLP_DATA) as ID141,SUM(FTCH_RLP_TX_1X) as ID142,sum(TOTALRLPBYTESRETRFWDTRAFFIC) as ID143,null as ID144,null as ID145,null as ID146,SUM(TOTALFRAMESTRANSRESERVETRAFFIC) as ID147,SUM(RTCH_RLP_TX_1X) as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,round(AVG(WIRELESS_CAPACITY),2) as ID161,null as ID162,case when SUM(WIRELESS_CAPACITY) = 0 then 0 else ROUND(SUM(SHO_TRAFFIC_CS) / SUM(WIRELESS_CAPACITY) * 100, 2) end as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT)*100,4) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)) * 100,2) END as ID176,null as ID177,SUM(CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211  
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0810'
and d.city_id &lt;&gt; 728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '城市' as b1,start_time,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b2,'${province_cn}' as b3,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b4,  
sum(nvl(CALL_ATT,0))+sum(nvl(DATACALLATT3G,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(ESTDATACALLS3G,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))&gt;=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))/(SUM(CALL_ATT) + SUM(DATACALLATT3G)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))&gt;=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,sum(DATACALLATT3G) as ID7,sum(ESTDATACALLS3G) as ID8,CASE WHEN sum(DATACALLATT3G)=0 THEN 0 WHEN sum(ESTDATACALLS3G)&gt;=sum(DATACALLATT3G) THEN 99.99 ELSE ROUND(sum(ESTDATACALLS3G)/sum(DATACALLATT3G) * 100,2) END as ID9,SUM(nvl(SHO_TRAFFIC_CS,0)) + SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(WALSHCODE_ERL_PS) as ID20,SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS) as ID21,SUM(WALSHCODE_ERL_PS)-SUM(SHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS))/SUM(TRAFFIC_PS) * 100,2) END as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATACALLSDROP,0)) as ID24,CASE WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))&lt;=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))/(SUM(CALL_SETUP_SUCC_CS) + SUM(ESTDATACALLS3G)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + sum(DATACALLSDROP))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + sum(DATACALLSDROP)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,sum(DATACALLSDROP) as ID30,CASE WHEN SUM(nvl(ESTDATACALLS3G,0))=0 THEN 0 WHEN sum(DATACALLSDROP)&lt;=0 THEN 0.01 ELSE ROUND(sum(DATACALLSDROP)/SUM(nvl(ESTDATACALLS3G,0)) * 100,2) END as ID31,CASE WHEN sum(DATACALLSDROP)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/sum(DATACALLSDROP),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(TCH_ASSIGN_ATT_HO_PS) as ID33,SUM(TCH_SETUP_SUC)+SUM(TCH_ASSIGN_SUC_HO_PS) as ID34,(SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC))+(SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS)) as ID35,CASE WHEN SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)) * 100,4) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID39,CASE WHEN SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND((SUM(nvl(CALL_SETUP_SUCC_CS, 0))+SUM(nvl(ESTDATACALLS3G, 0)))/(SUM(O_TCH_ASSIGN_ATT) + SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,4) END as ID40,SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS) -SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)) * 100,4) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC)*100/SUM(TCH_SETUP_ATT),2) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)*100/SUM(TCH_SETUP_ATT),2) END as ID52,SUM(VOICECALLHARDHOREQ) as ID53,SUM(VOICECALLHARDHOCOMPLET) as ID54,CASE WHEN SUM(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(VOICECALLHARDHOREQ)-SUM(VOICECALLHARDHOCOMPLET))/SUM(VOICECALLHARDHOREQ) * 100,4) END as ID55,SUM(TCH_SETUP_ATT)-SUM(TCH_ASSIGN_ATT_NUM)-SUM(BSS_HHO_ATT) as ID56,SUM(TCH_SETUP_SUC)-SUM(TCH_ASSIGN_SUC)-SUM(BSS_HHO_SUC) as ID57,CASE WHEN SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(((SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) -(SUM(TCH_SETUP_SUC) - SUM(TCH_ASSIGN_SUC) - SUM(BSS_HHO_SUC))) /(SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) * 100,4) END as ID58,SUM(TCH_ASSIGN_ATT_HO_PS) as ID59,SUM(TCH_ASSIGN_SUC_HO_PS) as ID60,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID61,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_HO_PS) / SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(nvl(ESTDATACALLS3G,0)) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(nvl(ESTDATACALLS3G, 0)) / SUM(TCH_ASSIGN_ATT_PS) * 100,4) END as ID66,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID67,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS))/SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID68,SUM(DATACALLHARDHOREQ) as ID69,SUM(DATACALLHARDHOCOMPLET) as ID70,CASE WHEN SUM(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(DATACALLHARDHOREQ)-SUM(DATACALLHARDHOCOMPLET))/SUM(DATACALLHARDHOREQ) * 100,4) END as ID71,SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ) as ID72,SUM(DATACALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTHOCOMPLET) as ID73,CASE WHEN SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(((SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ))-(SUM(DATACALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTHOCOMPLET)))/(SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ))*100,4) END as ID74,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID75,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID76,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID77,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID78,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID79,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID80,sum(VOICECALLHARDHOREQ) as ID81,sum(VOICECALLHARDHOCOMPLET) as ID82,CASE WHEN sum(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLHARDHOCOMPLET)*100/sum(VOICECALLHARDHOREQ),2) END as ID83,sum(VOICECALLSOFTHOREQ) as ID84,sum(VOICECALLSOFTHOCOMPLET) as ID85,CASE WHEN sum(VOICECALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTHOCOMPLET)*100/sum(VOICECALLSOFTHOREQ),2) END as ID86,sum(VOICECALLSOFTERHOREQ) as ID87,sum(VOICECALLSOFTERHOCOMPLET) as ID88,CASE WHEN sum(VOICECALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTERHOCOMPLET)*100/sum(VOICECALLSOFTERHOREQ),2) END as ID89,sum(DATACALLHOREQ) as ID90,sum(DATACALLHOCOMPLET) as ID91,CASE WHEN sum(DATACALLHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHOCOMPLET)/sum(DATACALLHOREQ) * 100,2) END as ID92,sum(DATACALLHARDHOREQ) as ID93,sum(DATACALLHARDHOCOMPLET) as ID94,CASE WHEN sum(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHARDHOCOMPLET)/sum(DATACALLHARDHOREQ) * 100,2) END as ID95,sum(DATACALLSOFTHOREQ) as ID96,sum(DATACALLSOFTHOCOMPLET) as ID97,CASE WHEN sum(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLSOFTHOCOMPLET)/sum(DATACALLSOFTHOREQ) * 100,2) END as ID98,SUM(DATACALLSOFTERHOREQ) as ID99,SUM(DATACALLSOFTERHOCOMPLET) as ID100,CASE WHEN SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(SUM(DATACALLSOFTERHOCOMPLET)/SUM(DATACALLSOFTERHOREQ) * 100,2) END as ID101,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID102,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTRAMSCSOFTHOCOMPLET)+SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID103,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTRAMSCSOFTHOCOMPLET) +SUM(VOICECALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTERHOCOMPLET)) /(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ) +SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)) * 100,4) END as ID104,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTERMSCSOFTHOREQ) as ID105,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTERMSCSOFTHOCOMPLET) as ID106,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTERMSCSOFTHOCOMPLET))/(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)) * 100,4) END as ID107,sum(THEINTERMSCHARDHOREQ) as ID108,sum(THEINTERMSCHARDHOCOMPLET) as ID109,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID110,SUM(THEINTRAMSCSOFTHOREQ) as ID111,SUM(THEINTRAMSCSOFTHOCOMPLET) as ID112,CASE WHEN SUM(THEINTRAMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTRAMSCSOFTHOCOMPLET)/SUM(THEINTRAMSCSOFTHOREQ) * 100,2) END as ID113,SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID114,SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID115,CASE WHEN (SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ))=0 THEN 0 ELSE ROUND((SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET))/(SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ)) * 100,2) END as ID116,sum(THEINTERMSCHARDHOREQ) as ID117,sum(THEINTERMSCHARDHOCOMPLET) as ID118,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID119,SUM(THEINTERMSCSOFTHOREQ) as ID120,SUM(THEINTERMSCSOFTHOCOMPLET) as ID121,CASE WHEN SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTERMSCSOFTHOCOMPLET)/SUM(THEINTERMSCSOFTHOREQ) * 100,2) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,SUM(CH_RLB_NUM) as ID129,SUM(CH_MAX_NUM) as ID130,CASE WHEN SUM(CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(CH_MAX_NUM)/SUM(CH_RLB_NUM)*100,4) END as ID131,null as ID132,null as ID133,null as ID134,null as ID135,null as ID136,null as ID137,null as ID138,null as ID139,null as ID140,SUM(FWD_RLP_DATA) as ID141,SUM(FTCH_RLP_TX_1X) as ID142,sum(TOTALRLPBYTESRETRFWDTRAFFIC) as ID143,null as ID144,null as ID145,null as ID146,SUM(TOTALFRAMESTRANSRESERVETRAFFIC) as ID147,SUM(RTCH_RLP_TX_1X) as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,round(AVG(WIRELESS_CAPACITY),2) as ID161,null as ID162,case when SUM(WIRELESS_CAPACITY) = 0 then 0 else ROUND(SUM(SHO_TRAFFIC_CS) / SUM(WIRELESS_CAPACITY) * 100, 2) end as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT)*100,4) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)) * 100,2) END as ID176,null as ID177,SUM(CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211  
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d, CFG_COUNTY ADM
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0810'
and d.city_id= 728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
and adm.city_id  = d.city_id
group by start_time,c.CITY_NAME,case when c.CITY_NAME = '江汉' then  case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else  c.CITY_NAME end) t1 left join 
(select '城市' as b1,start_time,
                                                    c.CITY_NAME as b2,  
                                                  SUM(BTS_283_NUM) as ID301,SUM(BTS_201_NUM) as ID302,SUM(BTS_242_NUM) as ID303,SUM(BTS_160_NUM) as ID304,SUM(ONEX_CARR_TOTAL_NUM) as ID305,SUM(ONEX_BTS_TOTAL_NUM) as ID306,SUM(ONEX_1CARR_BTS_NUM) as ID307,SUM(ONEX_2CARR_BTS_NUM) as ID308,SUM(ONEX_3CARR_BTS_NUM) as ID309,SUM(ONEX_4CARR_BTS_NUM) as ID310,SUM(ONEX_CELL_TOTAL_NUM) as ID311,SUM(ONEX_1CARR_CELL_NUM) as ID312,SUM(ONEX_2CARR_CELL_NUM) as ID313,SUM(ONEX_3CARR_CELL_NUM) as ID314,SUM(ONEX_4CARR_CELL_NUM) as ID315,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID316,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID317,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(IDLE_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID318,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID319,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID320,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(ABNORMAL_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID321,SUM(TRAFFIC_283) as ID322,SUM(TRAFFIC_201) as ID323,SUM(TRAFFIC_242) as ID324,SUM(TRAFFIC_160) as ID325,SUM(EX_BUSY_SECTOR_NUM) as ID326,SUM(BUSY_SECTOR_NUM) as ID327,SUM(IDLE_SECTOR_NUM) as ID328,SUM(ABNORMAL_SECTOR_NUM) as ID329,SUM(EX_OVERFLOW_BTS_NUM) as ID330,SUM(OVERFLOW_BTS_NUM) as ID331  
                                               from perf_bsc_resource c,cfg_bsc_map_city b,cfg_city d
                                              where c.ne_sys_id = b.ne_bsc_id
                                                and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                                                and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS')                                                     
                                                and d.city_id &lt;&gt; 728
                                                and b.city_id=d.city_id
                                                and c.CITY_ID=d.city_id    
                                                group by start_time,c.CITY_NAME                               
                                                union all 
                                                select '城市' as b1,start_time,
                                                case  when c.CITY_NAME = '江汉' then
                                                          case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门'
                                                            when '潜江' then '潜江' 
                                                              when '仙桃' then '仙桃' end
                                                         else
                                                          c.CITY_NAME
                                                       end as b2,                                                
                                                SUM(BTS_283_NUM) as ID301,SUM(BTS_201_NUM) as ID302,SUM(BTS_242_NUM) as ID303,SUM(BTS_160_NUM) as ID304,SUM(ONEX_CARR_TOTAL_NUM) as ID305,SUM(ONEX_BTS_TOTAL_NUM) as ID306,SUM(ONEX_1CARR_BTS_NUM) as ID307,SUM(ONEX_2CARR_BTS_NUM) as ID308,SUM(ONEX_3CARR_BTS_NUM) as ID309,SUM(ONEX_4CARR_BTS_NUM) as ID310,SUM(ONEX_CELL_TOTAL_NUM) as ID311,SUM(ONEX_1CARR_CELL_NUM) as ID312,SUM(ONEX_2CARR_CELL_NUM) as ID313,SUM(ONEX_3CARR_CELL_NUM) as ID314,SUM(ONEX_4CARR_CELL_NUM) as ID315,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID316,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID317,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(IDLE_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID318,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID319,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID320,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(ABNORMAL_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID321,SUM(TRAFFIC_283) as ID322,SUM(TRAFFIC_201) as ID323,SUM(TRAFFIC_242) as ID324,SUM(TRAFFIC_160) as ID325,SUM(EX_BUSY_SECTOR_NUM) as ID326,SUM(BUSY_SECTOR_NUM) as ID327,SUM(IDLE_SECTOR_NUM) as ID328,SUM(ABNORMAL_SECTOR_NUM) as ID329,SUM(EX_OVERFLOW_BTS_NUM) as ID330,SUM(OVERFLOW_BTS_NUM) as ID331 
                                                from perf_bsc_resource c, cfg_bsc_map_city b,cfg_city d,CFG_COUNTY ADM
                                                where c.ne_sys_id = b.ne_bsc_id
                                                and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                                                and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS')                                                                                                     
                                                and d.city_id= 728
                                                and b.city_id=d.city_id
                                                and c.CITY_ID=d.city_id
                                                and adm.city_id  = d.city_id
                                                group by start_time,c.CITY_NAME,case
                                                             when c.CITY_NAME = '江汉' then
                                                              case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门'
                                                                when '潜江' then '潜江' 
                                                                  when '仙桃' then '仙桃' end
                                                             else
                                                              c.CITY_NAME
                                                           end) t2  on t1.start_time=t2.start_time and  t1.b2=t2.b2
                                             union all 
select '省' as b1,start_time,
'${province_cn}' as b2,'${province_cn}' as b3,'${province_cn}' as b4,  
null as ID1,null as ID2,'ID2/ID1' as ID3,null as ID4,null as ID5,'ID5/ID4' as ID6,null as ID7,null as ID8,'ID8/ID7' as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,'ID15/(ID13+ID15)' as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,'ID21/ID19' as ID23,null as ID24,'ID24/ID38' as ID25,'(ID11*60)/(ID24*100)' as ID26,null as ID27,'ID27/ID48' as ID28,'(ID13*60)/(ID27*100)' as ID29,null as ID30,'ID30/ID64' as ID31,'(ID19*60)/(ID30*100)' as ID32,null as ID33,null as ID34,null as ID35,'ID34/ID33' as ID36,null as ID37,null as ID38,null as ID39,'ID38/ID37' as ID40,null as ID41,'ID41/ID33' as ID42,null as ID43,null as ID44,null as ID45,'ID44/ID43' as ID46,null as ID47,null as ID48,null as ID49,'ID48/ID47' as ID50,null as ID51,'ID51/ID43' as ID52,null as ID53,null as ID54,'(ID53-ID54)/ID53' as ID55,null as ID56,null as ID57,'(ID56-ID57)/ID56' as ID58,null as ID59,null as ID60,null as ID61,'ID60/ID59' as ID62,null as ID63,null as ID64,null as ID65,'ID64/ID63' as ID66,null as ID67,'ID67/ID59' as ID68,null as ID69,null as ID70,'(ID69-ID70)/ID69' as ID71,null as ID72,null as ID73,'(ID72-ID73)/ID72' as ID74,null as ID75,null as ID76,'ID76/ID75' as ID77,null as ID78,null as ID79,'ID79/ID78' as ID80,null as ID81,null as ID82,'ID82/ID81' as ID83,null as ID84,null as ID85,'ID85/ID84' as ID86,null as ID87,null as ID88,'ID88/ID87' as ID89,null as ID90,null as ID91,'ID91/ID90' as ID92,null as ID93,null as ID94,'ID94/ID93' as ID95,null as ID96,null as ID97,'ID97/ID96' as ID98,null as ID99,null as ID100,'ID100/ID99' as ID101,null as ID102,null as ID103,'ID103/ID102' as ID104,null as ID105,null as ID106,'ID106/ID105' as ID107,null as ID108,null as ID109,'ID109/ID108' as ID110,null as ID111,null as ID112,'ID112/ID111' as ID113,null as ID114,null as ID115,'ID115/ID114' as ID116,null as ID117,null as ID118,'ID118/ID117' as ID119,null as ID120,null as ID121,'ID121/ID120' as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,'ID130/ID129' as ID131,null as ID132,null as ID133,null as ID134,'ID134/ID133' as ID135,null as ID136,null as ID137,null as ID138,'ID138/ID137' as ID139,null as ID140,null as ID141,null as ID142,null as ID143,null as ID144,'ID143/(1024*ID142)' as ID145,null as ID146,null as ID147,null as ID148,'ID146/ID147' as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,null as ID161,null as ID162,'ID180/ID161' as ID163,'(ID180-ID181)/ID181' as ID164,'ID178/ID160' as ID165,'ID179/ID199' as ID166,'ID326/ID311' as ID167,'ID327/ID311' as ID168,'ID328/ID311' as ID169,'ID330/ID306' as ID170,'ID331/ID306' as ID171,'ID202/ID201' as ID172,'ID204/ID203' as ID173,'ID205/(ID194+ID196)' as ID174,'ID205/ID197' as ID175,null as ID176,'ID329/ID311' as ID177,null as ID178,null as ID179,null as ID180,null as ID181,null as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,null as ID193,null as ID194,null as ID195,null as ID196,null as ID197,null as ID198,null as ID199,null as ID200,null as ID201,null as ID202,null as ID203,null as ID204,null as ID205,null as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor in ('ZY0804','ZY0810')
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time
) tt where b2 is not null ORDER BY START_TIME, B1</sql>
			</mapping>
			<mapping name="${province_en}_PERF_CITY_DO_%%Y%%M%%D.csv" templet="性能数据模板CITYDO后台.ftl">
				<sql>select b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,b2,b3,b4,ID301,ID302,ID303,ID304,ID305,ID306,ID7,ID8,ID9,ID10,ID11,ID307,ID13,ID14,ID15,ID16,ID17,ID18,ID19,ID20,ID308,ID309,ID23,ID24,ID25,ID26,ID27,ID28,ID29,ID30,ID31,ID32,ID33,ID34,ID35,ID36,ID37,ID38,ID39,ID40,ID41,ID42,ID43,ID44,ID45,ID46,ID47,ID48,ID49,ID50,ID51,ID52,ID53,ID54,ID55,ID56,ID57,ID58,ID59,ID60,ID61,ID62,ID63,ID64,ID65,ID66,ID67,ID68,ID69,ID70,ID71,ID72,ID73,ID74,ID75,ID76,ID77,ID78,ID79,ID80,ID81,ID82,ID83,ID84,ID85,ID86,ID87,ID88,ID89,ID90,ID91,ID92,ID93,ID94,ID95,ID96,ID97,ID98,ID99,ID100,ID101,ID102,ID103,ID104,ID105,ID106,ID107,ID108,ID109,ID110,ID111,ID112,ID113,ID114,ID115,ID116,ID117,ID118,ID119,ID120,ID121,ID122,ID123,ID310,ID311,ID312,ID313,ID314,ID315,ID316,ID317,ID318,ID319,ID320,ID135,ID136,ID137,ID138,ID139,ID140,ID141,ID142,ID143,ID144,ID145,ID146,ID147,ID148,ID149,ID150,ID151,ID152,ID153,ID154,ID155,ID156 from 
(select t1.b1,t1.start_time,t1.b2,t1.b3,t1.b4,to_char(t2.ID301) as ID301,to_char(t2.ID302) as ID302,to_char(t2.ID303) as ID303,to_char(t2.ID304) as ID304,to_char(t2.ID305) as ID305,to_char(t2.ID306) as ID306,to_char(t1.ID7) as ID7,to_char(t1.ID8) as ID8,to_char(t1.ID9) as ID9,to_char(t1.ID10) as ID10,to_char(t1.ID11) as ID11,to_char(t2.ID307) as ID307,to_char(t1.ID13) as ID13,to_char(t1.ID14) as ID14,to_char(t1.ID15) as ID15,to_char(t1.ID16) as ID16,to_char(t1.ID17) as ID17,to_char(t1.ID18) as ID18,to_char(t1.ID19) as ID19,to_char(t1.ID20) as ID20,to_char(t2.ID308) as ID308,to_char(t2.ID309) as ID309,to_char(t1.ID23) as ID23,to_char(t1.ID24) as ID24,to_char(t1.ID25) as ID25,to_char(t1.ID26) as ID26,to_char(t1.ID27) as ID27,to_char(t1.ID28) as ID28,to_char(t1.ID29) as ID29,to_char(t1.ID30) as ID30,to_char(t1.ID31) as ID31,to_char(t1.ID32) as ID32,to_char(t1.ID33) as ID33,to_char(t1.ID34) as ID34,to_char(t1.ID35) as ID35,to_char(t1.ID36) as ID36,to_char(t1.ID37) as ID37,to_char(t1.ID38) as ID38,to_char(t1.ID39) as ID39,to_char(t1.ID40) as ID40,to_char(t1.ID41) as ID41,to_char(t1.ID42) as ID42,to_char(t1.ID43) as ID43,to_char(t1.ID44) as ID44,to_char(t1.ID45) as ID45,to_char(t1.ID46) as ID46,to_char(t1.ID47) as ID47,to_char(t1.ID48) as ID48,to_char(t1.ID49) as ID49,to_char(t1.ID50) as ID50,to_char(t1.ID51) as ID51,to_char(t1.ID52) as ID52,to_char(t1.ID53) as ID53,to_char(t1.ID54) as ID54,to_char(t1.ID55) as ID55,to_char(t1.ID56) as ID56,to_char(t1.ID57) as ID57,to_char(t1.ID58) as ID58,to_char(t1.ID59) as ID59,to_char(t1.ID60) as ID60,to_char(t1.ID61) as ID61,to_char(t1.ID62) as ID62,to_char(t1.ID63) as ID63,to_char(t1.ID64) as ID64,to_char(t1.ID65) as ID65,to_char(t1.ID66) as ID66,to_char(t1.ID67) as ID67,to_char(t1.ID68) as ID68,to_char(t1.ID69) as ID69,to_char(t1.ID70) as ID70,to_char(t1.ID71) as ID71,to_char(t1.ID72) as ID72,to_char(t1.ID73) as ID73,to_char(t1.ID74) as ID74,to_char(t1.ID75) as ID75,to_char(t1.ID76) as ID76,to_char(t1.ID77) as ID77,to_char(t1.ID78) as ID78,to_char(t1.ID79) as ID79,to_char(t1.ID80) as ID80,to_char(t1.ID81) as ID81,to_char(t1.ID82) as ID82,to_char(t1.ID83) as ID83,to_char(t1.ID84) as ID84,to_char(t1.ID85) as ID85,to_char(t1.ID86) as ID86,to_char(t1.ID87) as ID87,to_char(t1.ID88) as ID88,to_char(t1.ID89) as ID89,to_char(t1.ID90) as ID90,to_char(t1.ID91) as ID91,to_char(t1.ID92) as ID92,to_char(t1.ID93) as ID93,to_char(t1.ID94) as ID94,to_char(t1.ID95) as ID95,to_char(t1.ID96) as ID96,to_char(t1.ID97) as ID97,to_char(t1.ID98) as ID98,to_char(t1.ID99) as ID99,to_char(t1.ID100) as ID100,to_char(t1.ID101) as ID101,to_char(t1.ID102) as ID102,to_char(t1.ID103) as ID103,to_char(t1.ID104) as ID104,to_char(t1.ID105) as ID105,to_char(t1.ID106) as ID106,to_char(t1.ID107) as ID107,to_char(t1.ID108) as ID108,to_char(t1.ID109) as ID109,to_char(t1.ID110) as ID110,to_char(t1.ID111) as ID111,to_char(t1.ID112) as ID112,to_char(t1.ID113) as ID113,to_char(t1.ID114) as ID114,to_char(t1.ID115) as ID115,to_char(t1.ID116) as ID116,to_char(t1.ID117) as ID117,to_char(t1.ID118) as ID118,to_char(t1.ID119) as ID119,to_char(t1.ID120) as ID120,to_char(t1.ID121) as ID121,to_char(t1.ID122) as ID122,to_char(t1.ID123) as ID123,to_char(t2.ID310) as ID310,to_char(t2.ID311) as ID311,to_char(t2.ID312) as ID312,to_char(t2.ID313) as ID313,to_char(t2.ID314) as ID314,to_char(t2.ID315) as ID315,to_char(t2.ID316) as ID316,to_char(t2.ID317) as ID317,to_char(t2.ID318) as ID318,to_char(t2.ID319) as ID319,to_char(t2.ID320) as ID320,to_char(t1.ID135) as ID135,to_char(t1.ID136) as ID136,to_char(t1.ID137) as ID137,to_char(t1.ID138) as ID138,to_char(t1.ID139) as ID139,to_char(t1.ID140) as ID140,to_char(t1.ID141) as ID141,to_char(t1.ID142) as ID142,to_char(t1.ID143) as ID143,to_char(t1.ID144) as ID144,to_char(t1.ID145) as ID145,to_char(t1.ID146) as ID146,to_char(t1.ID147) as ID147,to_char(t1.ID148) as ID148,to_char(t1.ID149) as ID149,to_char(t1.ID150) as ID150,to_char(t1.ID151) as ID151,to_char(t1.ID152) as ID152,to_char(t1.ID153) as ID153,to_char(t1.ID154) as ID154,to_char(t1.ID155) as ID155,to_char(t1.ID156) as ID156 
from (select '城市' as b1,start_time,c.CITY_NAME as b2,'${province_cn}' as b3,c.CITY_NAME as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,CASE WHEN SUM(RCE_RLB_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RCE_MAX_BUSY_NUM_DO) / SUM(RCE_RLB_NUM_DO) * 100, 2) END  as ID7,SUM(RCE_MAX_BUSY_NUM_DO) as ID8,SUM(RCE_RLB_NUM_DO) as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN SUM(nvl(DO_CONN_ATT,0))=0 THEN 0 WHEN SUM(nvl(DO_SUC_CONN_NUM,0))&gt;=SUM(nvl(DO_CONN_ATT,0)) THEN 99.99 ELSE ROUND(SUM(nvl(DO_SUC_CONN_NUM,0)) / SUM(nvl(DO_CONN_ATT,0)) * 100, 2) END as ID23,CASE WHEN SUM(nvl(AT_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_CONN_SUC_DO,0))/SUM(nvl(AT_CONN_ATT_DO,0))*100,4) END as ID24,CASE WHEN SUM(nvl(AN_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AN_CONN_SUC_DO,0))/SUM(nvl(AN_CONN_ATT_DO,0))*100,4) END as ID25,SUM(nvl(AT_CONN_ATT_DO,0)) as ID26,SUM(nvl(AN_CONN_ATT_DO,0)) as ID27,SUM(nvl(AT_CONN_SUC_DO,0)) as ID28,SUM(nvl(AN_CONN_SUC_DO,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,SUM(CONN_SETUP_FAILED_RESF_DO) as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))-SUM(REL_NUM_PDSN_DO) as ID39,SUM(REL_NUM_PDSN_DO) as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))=0 THEN 0 ELSE ROUND((SUM(REL_NUM_PDSN_DO)+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100/SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)),4) END as ID45,CASE WHEN (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_SETUP_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID46,CASE WHEN  (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))&gt;=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(UATI_ATT_FAILED_NUM_DO) as ID54,SUM(UATI_AVG_SETUP_DURATION_DO) as ID55,CASE WHEN SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(AUTH_SUC_DO)/(SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO))*100,4) END as ID56,SUM(AUTH_SUC_DO) as ID57,SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO) as ID58,SUM(AUTH_DENY_NUM_DO) as ID59,SUM(AUTH_FAILED_NUM_DO) as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,CASE WHEN SUM(SESS_INTER_AN_DORMHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_INTER_AN_DORMHO_SUC_DO)/SUM(SESS_INTER_AN_DORMHO_ATT_DO)*100,4) END as ID64,SUM(SESS_INTER_AN_DORMHO_ATT_DO) as ID65,SUM(SESS_INTER_AN_DORMHO_SUC_DO) as ID66,SUM(SESSION_ACTIVE_NUM_DO)+SUM(SESSION_NON_ACTIVE_NUM_DO) as ID67,SUM(SESSION_ACTIVE_NUM_DO) as ID68,SUM(SESSION_NON_ACTIVE_NUM_DO) as ID69,CASE WHEN (SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO)) /(SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO)) * 100, 2) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AN_DOR2ACT_SUC_DO)/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(TRAFFIC_DO) as ID81,SUM(TRAFFIC_DO) as ID82,SUM(TRAFFIC_DO)+SUM(SFT_HO_TRAFFIC_DO) as ID83,SUM(SFT_HO_TRAFFIC_DO) as ID84,CASE WHEN SUM(TRAFFIC_DO)=0 THEN 0 ELSE ROUND(SUM(SFT_HO_TRAFFIC_DO)/SUM(TRAFFIC_DO)*100,4) END as ID85,SUM(REV_THROUGHOUT_PCF_DO) as ID86,SUM(FWD_THROUGHOUT_PCF_DO) as ID87,SUM(REV_PAK_TOTAL_NUM_DO) as ID88,SUM(FWD_PAK_TOTAL_NUM_DO) as ID89,null as ID90,SUM(FWD_PAK_DISCARD_NUM_DO) as ID91,null as ID92,CASE WHEN SUM(FWD_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(FWD_PAK_DISCARD_NUM_DO)/SUM(FWD_PAK_TOTAL_NUM_DO),4) END as ID93,ROUND(SUM(RLP_TXBYTENUM) * 8.0 / 1000 / 3600,4) as ID94,CASE WHEN SUM(FWD_RLP_AVG_THROUGHPUT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_AVG_THROUGHPUT_DO)/1000/3600*8*100,4) END as ID95,ROUND(SUM(DO_RTCH_RLP_TX) * 8.0 / 1000 / 3600,4) as ID96,CASE WHEN SUM(DO_RTCH_RLP_TX)=0 THEN 0 ELSE ROUND(SUM(RTCH_RLP_RETX_DO)/SUM(DO_RTCH_RLP_TX)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FTCH_PHY_SLOT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/SUM(FTCH_PHY_SLOT_DO)*100,4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(RLP_CALLKDURATION)=0 THEN 0 ELSE ROUND(SUM(RTCH_PHY_TX_BIT_DO)/SUM(RLP_CALLKDURATION)*100,4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),4) as ID102,to_char(ROUND(AVG(FWD_PHY_CCH_SLOT_RATE_DO),4)) as ID103,'0' as ID104,CASE WHEN SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RAB_BUSY_NUM_DO)/(SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO))*100,4) END as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))&gt;=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,CASE WHEN SUM(INN_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_BS_SHO_SUC_DO)/SUM(INN_BS_SHO_ATT_DO),4) END as ID109,SUM(INN_BS_SHO_ATT_DO) as ID110,SUM(INN_BS_SHO_SUC_DO) as ID111,CASE WHEN SUM(INTER_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_BS_SHO_SUC_DO)/SUM(INTER_BS_SHO_ATT_DO),4) END as ID112,SUM(INTER_BS_SHO_ATT_DO) as ID113,SUM(INTER_BS_SHO_SUC_DO) as ID114,CASE WHEN SUM(INN_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_AN_HHO_SUC_DO)/SUM(INN_AN_HHO_ATT_DO)*100,4) END as ID115,SUM(INN_AN_HHO_ATT_DO) as ID116,SUM(INN_AN_HHO_SUC_DO) as ID117,CASE WHEN SUM(INTER_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_AN_HHO_ATT_DO)/SUM(INTER_AN_HHO_ATT_DO),4) END as ID118,SUM(INTER_AN_HHO_ATT_DO) as ID119,SUM(INTER_AN_HHO_SUC_DO) as ID120,CASE WHEN SUM(PAGE_ATT_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(PAGE_SUC_NUM_DO)/SUM(PAGE_ATT_NUM_DO)*100,4) END as ID121,SUM(PAGE_ATT_NUM_DO) as ID122,SUM(PAGE_SUC_NUM_DO) as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,SUM(DO_SETUP_TIME) as ID135,SUM(DO_CONNECT_TIME) as ID136,SUM(SESS_SETUP_TOTAL_DUR_DO) as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_AVG_THROUGHPUT_DO)*1024 as ID139,SUM(RTCH_RLP_RETX_DO) as ID140,SUM(DO_RTCH_RLP_TX) as ID141,SUM(RAB_BUSY_NUM_DO) as ID142,SUM(RAB_IDLE_NUM_DO) as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FTCH_PHY_SLOT_DO) as ID149,SUM(RTCH_PHY_TX_BIT_DO) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156  
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0804'
and d.city_id &lt;&gt;728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME UNION ALL
select '城市' as b1,start_time,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b2,'${province_cn}' as b3,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,CASE WHEN SUM(RCE_RLB_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RCE_MAX_BUSY_NUM_DO) / SUM(RCE_RLB_NUM_DO) * 100, 2) END  as ID7,SUM(RCE_MAX_BUSY_NUM_DO) as ID8,SUM(RCE_RLB_NUM_DO) as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN SUM(nvl(DO_CONN_ATT,0))=0 THEN 0 WHEN SUM(nvl(DO_SUC_CONN_NUM,0))&gt;=SUM(nvl(DO_CONN_ATT,0)) THEN 99.99 ELSE ROUND(SUM(nvl(DO_SUC_CONN_NUM,0)) / SUM(nvl(DO_CONN_ATT,0)) * 100, 2) END as ID23,CASE WHEN SUM(nvl(AT_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_CONN_SUC_DO,0))/SUM(nvl(AT_CONN_ATT_DO,0))*100,4) END as ID24,CASE WHEN SUM(nvl(AN_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AN_CONN_SUC_DO,0))/SUM(nvl(AN_CONN_ATT_DO,0))*100,4) END as ID25,SUM(nvl(AT_CONN_ATT_DO,0)) as ID26,SUM(nvl(AN_CONN_ATT_DO,0)) as ID27,SUM(nvl(AT_CONN_SUC_DO,0)) as ID28,SUM(nvl(AN_CONN_SUC_DO,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,SUM(CONN_SETUP_FAILED_RESF_DO) as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))-SUM(REL_NUM_PDSN_DO) as ID39,SUM(REL_NUM_PDSN_DO) as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))=0 THEN 0 ELSE ROUND((SUM(REL_NUM_PDSN_DO)+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100/SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)),4) END as ID45,CASE WHEN (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_SETUP_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID46,CASE WHEN  (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))&gt;=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(UATI_ATT_FAILED_NUM_DO) as ID54,SUM(UATI_AVG_SETUP_DURATION_DO) as ID55,CASE WHEN SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(AUTH_SUC_DO)/(SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO))*100,4) END as ID56,SUM(AUTH_SUC_DO) as ID57,SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO) as ID58,SUM(AUTH_DENY_NUM_DO) as ID59,SUM(AUTH_FAILED_NUM_DO) as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,CASE WHEN SUM(SESS_INTER_AN_DORMHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_INTER_AN_DORMHO_SUC_DO)/SUM(SESS_INTER_AN_DORMHO_ATT_DO)*100,4) END as ID64,SUM(SESS_INTER_AN_DORMHO_ATT_DO) as ID65,SUM(SESS_INTER_AN_DORMHO_SUC_DO) as ID66,SUM(SESSION_ACTIVE_NUM_DO)+SUM(SESSION_NON_ACTIVE_NUM_DO) as ID67,SUM(SESSION_ACTIVE_NUM_DO) as ID68,SUM(SESSION_NON_ACTIVE_NUM_DO) as ID69,CASE WHEN (SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO)) /(SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO)) * 100, 2) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AN_DOR2ACT_SUC_DO)/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(TRAFFIC_DO) as ID81,SUM(TRAFFIC_DO) as ID82,SUM(TRAFFIC_DO)+SUM(SFT_HO_TRAFFIC_DO) as ID83,SUM(SFT_HO_TRAFFIC_DO) as ID84,CASE WHEN SUM(TRAFFIC_DO)=0 THEN 0 ELSE ROUND(SUM(SFT_HO_TRAFFIC_DO)/SUM(TRAFFIC_DO)*100,4) END as ID85,SUM(REV_THROUGHOUT_PCF_DO) as ID86,SUM(FWD_THROUGHOUT_PCF_DO) as ID87,SUM(REV_PAK_TOTAL_NUM_DO) as ID88,SUM(FWD_PAK_TOTAL_NUM_DO) as ID89,null as ID90,SUM(FWD_PAK_DISCARD_NUM_DO) as ID91,null as ID92,CASE WHEN SUM(FWD_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(FWD_PAK_DISCARD_NUM_DO)/SUM(FWD_PAK_TOTAL_NUM_DO),4) END as ID93,ROUND(SUM(RLP_TXBYTENUM) * 8.0 / 1000 / 3600,4) as ID94,CASE WHEN SUM(FWD_RLP_AVG_THROUGHPUT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_AVG_THROUGHPUT_DO)/1000/3600*8*100,4) END as ID95,ROUND(SUM(DO_RTCH_RLP_TX) * 8.0 / 1000 / 3600,4) as ID96,CASE WHEN SUM(DO_RTCH_RLP_TX)=0 THEN 0 ELSE ROUND(SUM(RTCH_RLP_RETX_DO)/SUM(DO_RTCH_RLP_TX)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FTCH_PHY_SLOT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/SUM(FTCH_PHY_SLOT_DO)*100,4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(RLP_CALLKDURATION)=0 THEN 0 ELSE ROUND(SUM(RTCH_PHY_TX_BIT_DO)/SUM(RLP_CALLKDURATION)*100,4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),4) as ID102,to_char(ROUND(AVG(FWD_PHY_CCH_SLOT_RATE_DO),4)) as ID103,'0' as ID104,CASE WHEN SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RAB_BUSY_NUM_DO)/(SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO))*100,4) END as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))&gt;=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,CASE WHEN SUM(INN_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_BS_SHO_SUC_DO)/SUM(INN_BS_SHO_ATT_DO),4) END as ID109,SUM(INN_BS_SHO_ATT_DO) as ID110,SUM(INN_BS_SHO_SUC_DO) as ID111,CASE WHEN SUM(INTER_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_BS_SHO_SUC_DO)/SUM(INTER_BS_SHO_ATT_DO),4) END as ID112,SUM(INTER_BS_SHO_ATT_DO) as ID113,SUM(INTER_BS_SHO_SUC_DO) as ID114,CASE WHEN SUM(INN_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_AN_HHO_SUC_DO)/SUM(INN_AN_HHO_ATT_DO)*100,4) END as ID115,SUM(INN_AN_HHO_ATT_DO) as ID116,SUM(INN_AN_HHO_SUC_DO) as ID117,CASE WHEN SUM(INTER_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_AN_HHO_ATT_DO)/SUM(INTER_AN_HHO_ATT_DO),4) END as ID118,SUM(INTER_AN_HHO_ATT_DO) as ID119,SUM(INTER_AN_HHO_SUC_DO) as ID120,CASE WHEN SUM(PAGE_ATT_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(PAGE_SUC_NUM_DO)/SUM(PAGE_ATT_NUM_DO)*100,4) END as ID121,SUM(PAGE_ATT_NUM_DO) as ID122,SUM(PAGE_SUC_NUM_DO) as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,SUM(DO_SETUP_TIME) as ID135,SUM(DO_CONNECT_TIME) as ID136,SUM(SESS_SETUP_TOTAL_DUR_DO) as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_AVG_THROUGHPUT_DO)*1024 as ID139,SUM(RTCH_RLP_RETX_DO) as ID140,SUM(DO_RTCH_RLP_TX) as ID141,SUM(RAB_BUSY_NUM_DO) as ID142,SUM(RAB_IDLE_NUM_DO) as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FTCH_PHY_SLOT_DO) as ID149,SUM(RTCH_PHY_TX_BIT_DO) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156  
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d, CFG_COUNTY ADM where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0804'
and d.city_id =728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id 
and adm.city_id  = d.city_id
group by start_time,c.CITY_NAME ,case when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end
UNION ALL
select '城市' as b1,start_time,
c.CITY_NAME as b2,'${province_cn}' as b3,c.CITY_NAME as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,null as ID7,null as ID8,null as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0)) )=0 THEN 0 WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))&gt;=(SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) THEN 99.99 ELSE ROUND((SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))) / (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) * 100, 5) END as ID23,CASE WHEN SUM(nvl(AT_INIT_ATT_CONN,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))/SUM(nvl(AT_INIT_ATT_CONN,0))*100,4) END as ID24,DECODE(SUM(AN_INIT_ATT_CONN),0,0,ROUND(SUM(AN_INIT_ESTABLISHED_CONN)/SUM(AN_INIT_ATT_CONN),4)*100) as ID25,SUM(nvl(AT_INIT_ATT_CONN,0)) as ID26,SUM(nvl(AN_INIT_ATT_CONN,0)) as ID27,SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) as ID28,SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,null as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,null as ID39,null as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN (SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))=0 THEN 0 ELSE ROUND((SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))/(SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100,2) END as ID45,null as ID46,CASE WHEN (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME) / (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)) * 100, 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))&gt;=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(nvl(UATI_ATT_NUM,0))-SUM(nvl(UATI_SUC_NUM,0)) as ID54,null as ID55,null as ID56,null as ID57,null as ID58,null as ID59,null as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,null as ID64,null as ID65,null as ID66,null as ID67,null as ID68,null as ID69,CASE WHEN SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/(SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO))*100,4) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(EQU_USER_NUM_DO) as ID81,SUM(TCH_OCC) as ID82,null as ID83,null as ID84,null as ID85,null as ID86,null as ID87,null as ID88,null as ID89,null as ID90,null as ID91,null as ID92,null as ID93,ROUND(SUM(FWD_RLP_DATA)*8/(1000*3600),4) as ID94,CASE WHEN SUM(FWD_RLP_DATA)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_DATA)*100,4) END as ID95,ROUND(SUM(RLP_RXED_RTC)*8/(100*3600),4) as ID96,CASE WHEN SUM(RTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(MISSING_RLP_REQ_RTC)/SUM(RTCH_RLP_TX_DO)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FWD_RLP_TOT_SLOT)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/1000/(SUM(FWD_RLP_TOT_SLOT)*0.001667),4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(NUM_SUBPKTS_RL)=0 THEN 0 ELSE ROUND(SUM(REV_PHY_AVG_BYTE)*(8*1000)/(SUM(NUM_SUBPKTS_RL)* 0.00667),4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),3) as ID102,'0' as ID103,'0' as ID104,null as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))&gt;=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,null as ID109,null as ID110,null as ID111,null as ID112,null as ID113,null as ID114,null as ID115,null as ID116,null as ID117,null as ID118,null as ID119,null as ID120,null as ID121,null as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,null as ID135,CASE WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))=0 THEN 0 ELSE ROUND((SUM(EVM_AVG_DRC_POINTED_USERS)*3600*(SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)))/(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))),2) END as ID136,null as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_DATA) as ID139,SUM(MISSING_RLP_REQ_RTC) as ID140,SUM(RTCH_RLP_TX_DO) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FWD_RLP_TOT_SLOT)*0.001667 as ID149,SUM(REV_PHY_AVG_BYTE)*(8*1000000) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156  
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0810'
and d.city_id &lt;&gt;728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME UNION ALL
select '城市' as b1,start_time,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b2,'${province_cn}' as b3,
case  when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,null as ID7,null as ID8,null as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0)) )=0 THEN 0 WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))&gt;=(SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) THEN 99.99 ELSE ROUND((SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))) / (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) * 100, 5) END as ID23,CASE WHEN SUM(nvl(AT_INIT_ATT_CONN,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))/SUM(nvl(AT_INIT_ATT_CONN,0))*100,4) END as ID24,DECODE(SUM(AN_INIT_ATT_CONN),0,0,ROUND(SUM(AN_INIT_ESTABLISHED_CONN)/SUM(AN_INIT_ATT_CONN),4)*100) as ID25,SUM(nvl(AT_INIT_ATT_CONN,0)) as ID26,SUM(nvl(AN_INIT_ATT_CONN,0)) as ID27,SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) as ID28,SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,null as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,null as ID39,null as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))&lt;=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN (SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))=0 THEN 0 ELSE ROUND((SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))/(SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100,2) END as ID45,null as ID46,CASE WHEN (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME) / (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)) * 100, 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))&gt;=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(nvl(UATI_ATT_NUM,0))-SUM(nvl(UATI_SUC_NUM,0)) as ID54,null as ID55,null as ID56,null as ID57,null as ID58,null as ID59,null as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,null as ID64,null as ID65,null as ID66,null as ID67,null as ID68,null as ID69,CASE WHEN SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/(SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO))*100,4) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(EQU_USER_NUM_DO) as ID81,SUM(TCH_OCC) as ID82,null as ID83,null as ID84,null as ID85,null as ID86,null as ID87,null as ID88,null as ID89,null as ID90,null as ID91,null as ID92,null as ID93,ROUND(SUM(FWD_RLP_DATA)*8/(1000*3600),4) as ID94,CASE WHEN SUM(FWD_RLP_DATA)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_DATA)*100,4) END as ID95,ROUND(SUM(RLP_RXED_RTC)*8/(100*3600),4) as ID96,CASE WHEN SUM(RTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(MISSING_RLP_REQ_RTC)/SUM(RTCH_RLP_TX_DO)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FWD_RLP_TOT_SLOT)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/1000/(SUM(FWD_RLP_TOT_SLOT)*0.001667),4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(NUM_SUBPKTS_RL)=0 THEN 0 ELSE ROUND(SUM(REV_PHY_AVG_BYTE)*(8*1000)/(SUM(NUM_SUBPKTS_RL)* 0.00667),4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),3) as ID102,'0' as ID103,'0' as ID104,null as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))&gt;=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,null as ID109,null as ID110,null as ID111,null as ID112,null as ID113,null as ID114,null as ID115,null as ID116,null as ID117,null as ID118,null as ID119,null as ID120,null as ID121,null as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,null as ID135,CASE WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))=0 THEN 0 ELSE ROUND((SUM(EVM_AVG_DRC_POINTED_USERS)*3600*(SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)))/(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))),2) END as ID136,null as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_DATA) as ID139,SUM(MISSING_RLP_REQ_RTC) as ID140,SUM(RTCH_RLP_TX_DO) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FWD_RLP_TOT_SLOT)*0.001667 as ID149,SUM(REV_PHY_AVG_BYTE)*(8*1000000) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156  
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d, CFG_COUNTY ADM
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0810'
and d.city_id =728
and b.city_id=d.city_id
and c.CITY_ID=d.city_id 
and adm.city_id  = d.city_id
group by start_time,c.CITY_NAME ,case when c.CITY_NAME = '江汉' then case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门' when '潜江' then '潜江'  when '仙桃' then '仙桃' end else c.CITY_NAME end)
 t1  left join 
(select '城市' as b1,start_time,
                                                    c.CITY_NAME as b2,  
                                                    SUM(DO_BTS_TOTAL_NUM) as ID301,SUM(ONE_CARR_BTS_NUM_DO) as ID302,SUM(TWO_CARR_BTS_NUM_DO) as ID303,SUM(THREE_CARR_BTS_NUM_DO) as ID304,SUM(FOUR_CARR_BTS_NUM_DO) as ID305,SUM(DO_CARR_TOTAL_NUM) as ID306,SUM(PCF_TOTAL_NUM) as ID307,SUM(EX_BUSY_BTS_NUM_DO) as ID308,SUM(IDLE_BTS_NUM_DO) as ID309,SUM(CARR_NUM_37) as ID310,SUM(CARR_NUM_78) as ID311,SUM(CARR_NUM_119) as ID312,SUM(DO_CARR_TOTAL_NUM) as ID313,SUM(TRAFFIC_37) as ID314,SUM(TRAFFIC_78) as ID315,SUM(TRAFFIC_119) as ID316,SUM(DO_1CARR_CELL_NUM) as ID317,SUM(DO_2CARR_CELL_NUM) as ID318,SUM(DO_3CARR_CELL_NUM) as ID319,SUM(DO_CELL_TOTAL_NUM) as ID320 
                                               from perf_bsc_resource c,cfg_bsc_map_city b,cfg_city d
                                              where c.ne_sys_id = b.ne_bsc_id
                                                and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                                                and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS')                                                     
                                                and d.city_id &lt;&gt; 728
                                                and b.city_id=d.city_id
                                                and c.CITY_ID=d.city_id    
                                                group by start_time,c.CITY_NAME                               
                                                union all 
                                                select '城市' as b1,start_time,
                                                case  when c.CITY_NAME = '江汉' then
                                                          case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门'
                                                            when '潜江' then '潜江' 
                                                              when '仙桃' then '仙桃' end
                                                         else
                                                          c.CITY_NAME
                                                       end as b2,                                                
                                                SUM(DO_BTS_TOTAL_NUM) as ID301,SUM(ONE_CARR_BTS_NUM_DO) as ID302,SUM(TWO_CARR_BTS_NUM_DO) as ID303,SUM(THREE_CARR_BTS_NUM_DO) as ID304,SUM(FOUR_CARR_BTS_NUM_DO) as ID305,SUM(DO_CARR_TOTAL_NUM) as ID306,SUM(PCF_TOTAL_NUM) as ID307,SUM(EX_BUSY_BTS_NUM_DO) as ID308,SUM(IDLE_BTS_NUM_DO) as ID309,SUM(CARR_NUM_37) as ID310,SUM(CARR_NUM_78) as ID311,SUM(CARR_NUM_119) as ID312,SUM(DO_CARR_TOTAL_NUM) as ID313,SUM(TRAFFIC_37) as ID314,SUM(TRAFFIC_78) as ID315,SUM(TRAFFIC_119) as ID316,SUM(DO_1CARR_CELL_NUM) as ID317,SUM(DO_2CARR_CELL_NUM) as ID318,SUM(DO_3CARR_CELL_NUM) as ID319,SUM(DO_CELL_TOTAL_NUM) as ID320 
                                                from perf_bsc_resource c, cfg_bsc_map_city b,cfg_city d,CFG_COUNTY ADM
                                                where c.ne_sys_id = b.ne_bsc_id
                                                and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                                                and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS')                                                                                                     
                                                and d.city_id= 728
                                                and b.city_id=d.city_id
                                                and c.CITY_ID=d.city_id
                                                and adm.city_id  = d.city_id
                                                group by start_time,c.CITY_NAME,case
                                                             when c.CITY_NAME = '江汉' then
                                                              case replace(ADM.COUNTY_NAME,'区','') when '天门' then '天门'
                                                                when '潜江' then '潜江' 
                                                                  when '仙桃' then '仙桃' end
                                                             else
                                                              c.CITY_NAME
                                                           end) t2 on  t1.b1=t2.b1 and  t1.start_time=t2.start_time and  t1.b2=t2.b2
 union all select '省' as b1,start_time,
'${province_cn}' as b2,'${province_cn}' as b3,'${province_cn}' as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,'ID8/ID9' as ID7,null as ID8,null as ID9,'ID11/ID144' as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,'0' as ID16,'0' as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,'(ID28+ID29)/(ID26+ID27)' as ID23,'ID28/ID26' as ID24,'ID29/ID27' as ID25,null as ID26,null as ID27,null as ID28,null as ID29,'ID31/ID32' as ID30,null as ID31,null as ID32,'ID34/(ID26+ID27)' as ID33,null as ID34,null as ID35,null as ID36,null as ID37,null as ID38,null as ID39,null as ID40,null as ID41,null as ID42,null as ID43,'(ID41+ID42+ID43)/(ID38+ID41+ID42+ID43)' as ID44,'(ID40+ID41+ID42+ID43)/(ID38+ID41+ID42+ID43)' as ID45,null as ID46,null as ID47,'ID145/(ID145+ID146+ID147)' as ID48,'ID146/(ID145+ID146+ID147)' as ID49,'ID147/(ID145+ID146+ID147)' as ID50,'ID53/ID52' as ID51,null as ID52,null as ID53,null as ID54,null as ID55,'ID57/ID58' as ID56,null as ID57,null as ID58,null as ID59,null as ID60,'ID62/(ID62+ID63)' as ID61,null as ID62,null as ID63,'ID66/ID65' as ID64,null as ID65,null as ID66,null as ID67,null as ID68,null as ID69,'ID72/ID71' as ID70,null as ID71,null as ID72,'ID75/ID74' as ID73,null as ID74,null as ID75,null as ID76,'ID79/ID78' as ID77,null as ID78,null as ID79,null as ID80,null as ID81,null as ID82,null as ID83,null as ID84,null as ID85,null as ID86,null as ID87,null as ID88,null as ID89,null as ID90,null as ID91,'ID90/ID88' as ID92,'ID91/ID89' as ID93,null as ID94,'ID138/ID139' as ID95,null as ID96,'ID140/ID141' as ID97,null as ID98,null as ID99,null as ID100,null as ID101,null as ID102,null as ID103,null as ID104,'ID142/(ID142+ID143)' as ID105,'ID108/ID107' as ID106,null as ID107,null as ID108,'ID111/ID110' as ID109,null as ID110,null as ID111,'ID114/ID113' as ID112,null as ID113,null as ID114,'ID117/ID116' as ID115,null as ID116,null as ID117,'ID120/ID119' as ID118,null as ID119,null as ID120,'ID123/ID122' as ID121,null as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,null as ID135,null as ID136,null as ID137,null as ID138,null as ID139,null as ID140,null as ID141,null as ID142,null as ID143,null as ID144,null as ID145,null as ID146,null as ID147,null as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time &gt;= to_date('%%Y-%%M-%%D 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time &lt;= to_date('%%Y-%%M-%%D 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor in ('ZY0808','ZY0804','ZY0810')
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time) tt  where b2 is not null ORDER BY START_TIME, B1</sql>
			</mapping>
		</resolve>
	</to>
	
	<!-- 传输接口, 当只有path属性在时候为本地接口，其他则为远程接口 -->
	<ti id="1" after="1">
		<property name="ftpip">192.168.0.131</property>
		<property name="port">21</property>
		<property name="username">litp</property>
		<property name="password">litp</property>
		<property name="path">/GZ/PERF/</property><!--可以配置通配符-->
		<property name="encode">UTF-8</property>
	</ti>
	<t>
		<action id="1" toid="1" tiid="1" strategyid="1"/><!--数据库方式-->
	</t>
	
	<!-- 默认失败不处理  0:正常   1:   2: -->
	<strategy id="1">
		<property name="failure">1,2,3</property>
	</strategy>
	
	<!-- before ,after ,exception -->
	<trigger id="1" class="" />
	<trigger id="2" class="" />
</config>