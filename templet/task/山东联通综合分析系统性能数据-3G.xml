<?xml version="1.0" encoding="utf-8" ?>
<config>
	<include>
       <property name="mapping">mapping.xml</property>
       <property name="loop">false</property>
    </include>
	<!-- 100: db 200:file(200:local file , 201: ftp file) 300:socket 400:others -->
	<ds id="1" type="100">
		<property name="url">jdbc:oracle:thin:@134.54.160.77:1521:wcdma1</property>
		<property name="driver">oracle.jdbc.driver.OracleDriver</property>
		<property name="username">wcdma</property>
		<property name="password">uwaysoft2010</property>
	</ds>
	<!-- to 与  resolve 是一对多关系, package为可选标签 -->

	<to id="1">
		<resolve dsid="1">

			<mapping name="WXWYPM08_%%Y%%M%%D%%H%%m_001.data" templet="山东联通综合分析系统性能数据BTS-3G.ftl">

				<sql>


<![CDATA[
select p.start_time,
       p.BTS_NAME,
       ne.bsc_id || '_' ||ne.bts_id,
       ne.EXT_OID,
       ROUND(AVG(ceUpUsageRatio),3) CEUPUSAGERATIO,
       ROUND(AVG(ceDownUsageRatio),3) CEDOWNUSAGERATIO,
       SUM(CSATERLTRAFFIC) CSATERLTRAFFIC,
       SUM(CSVTERLTRAFFIC) CSVTERLTRAFFIC,
       ROUND( SUM(NBRRABASSIGNTCPCONG)/(SUM(NBRRABASSIGNREQ ) + 0.0000001)*100,3) NBRRABASSIGNTCPCONGRATE,
       ROUND( SUM(NBRRABASSIGNDOWNSFCONG)/((SUM(NBRRABASSIGNREQ) ) + 0.0000001)*100,3) NBRRABASSIGNDOWNSFCONGRATE,
       ROUND( (SUM(NBRRABASSIGNUPCECONG+NBRRABASSIGNDOWNCECONG))/((SUM(NBRRABASSIGNREQ) ) + 0.0000001)*100,3) NBRRABASSIGNCECONGRATE,
       case when SUM(NBRR99RABASSIGNFAIL)  > SUM(NBRR99RABASSIGNSUC) then 100  else ROUND( SUM(NBRR99RABASSIGNFAIL)/((SUM(NBRR99RABASSIGNSUC) ) + 0.0000001)*100,3)  end  NBRR99RABASSIGNFAILRATE,
       ROUND( SUM(NBRRRCCONNSUCC_TYPE)/((SUM(NBRRRCCONNREQ_TYPE) ) + 0.0000001)*100,3) NBRRRCCONN_TYPERATE,
       ROUND( SUM(NBRR99RABASSIGNSUC)/((SUM(NBRR99RABASSIGNREQ) ) + 0.0000001)*100,3) NBRR99RABASSIGNRATE,
       decode(AVG(MEANCELLTCP)*AVG(NVL(P_CELL_TRX_POW,43)),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(NVL(P_CELL_TRX_POW,43))/10)*100,3)) MEANCELLTCPAVGRATE,
       ROUND(SUM(NBRRABASSIGNUPIUBCONG+NBRRABASSIGNDOWNIUBCONG)/SUM(NBRRABASSIGNREQ+0.0000001)*100,3) NBRRABASSIGNIUBCONGRATE,
       SUM(NBRBGRDRRCCONNREQ) NBRBGRDRRCCONNREQ,
       SUM(NBRBGRDRRCCONNSUCC) NBRBGRDRRCCONNSUCC,
       SUM(NBRCONVRRCCONNREQ) NBRCONVRRCCONNREQ,
       SUM(NBRCONVRRCCONNSUCC) NBRCONVRRCCONNSUCC,
       SUM(NBRCSINTERFREQHHOOUTREQ) NBRCSINTERFREQHHOOUTREQ,
       SUM(NBRCSINTERFREQHHOOUTSUCC) NBRCSINTERFREQHHOOUTSUCC,
       SUM(NBRCSINTRAFREQHHOOUTREQ) NBRCSINTRAFREQHHOOUTREQ,
       SUM(NBRCSINTRAFREQHHOOUTSUCC) NBRCSINTRAFREQHHOOUTSUCC,
       SUM(NBRINTACTRRCCONNREQ) NBRINTACTRRCCONNREQ,
       SUM(NBRINTACTRRCCONNSUCC) NBRINTACTRRCCONNSUCC,
       SUM(NBRPSINTERFREQHHOOUTREQ) NBRPSINTERFREQHHOOUTREQ,
       SUM(NBRPSINTERFREQHHOOUTSUCC) NBRPSINTERFREQHHOOUTSUCC,
       SUM(NBRPSINTRAFREQHHOOUTREQ) NBRPSINTRAFREQHHOOUTREQ,
       SUM(NBRPSINTRAFREQHHOOUTSUCC) NBRPSINTRAFREQHHOOUTSUCC,
       SUM(NBRPSR99DLBUSYTRAFFIC) NBRPSR99DLBUSYTRAFFIC,
       SUM(NBRPSR99ULBUSYTRAFFIC) NBRPSR99ULBUSYTRAFFIC,
       SUM(NBRR99RABASSIGNFAIL) NBRR99RABASSIGNFAIL,
       SUM(NBRR99RABASSIGNREQ) NBRR99RABASSIGNREQ,
       SUM(NBRR99RABASSIGNSUC) NBRR99RABASSIGNSUC,
       SUM(NBRRRCCONNREQ_TYPE) NBRRRCCONNREQ_TYPE,
       SUM(NBRRRCCONNSUCC_TYPE) NBRRRCCONNSUCC_TYPE,
       SUM(NBRSTRMRRCCONNREQ) NBRSTRMRRCCONNREQ,
       SUM(NBRSTRMRRCCONNSUCC) NBRSTRMRRCCONNSUCC,
       round(AVG(RLCCSATDOWNAVERRATE),3) RLCCSATDOWNAVERRATE,
       round(AVG(RLCCSATUPAVERRATE),3) RLCCSATUPAVERRATE,
       round(AVG(RLCCSDOWNAVERAVGRATE),3) RLCCSDOWNAVERAVGRATE,
       round(AVG(RLCCSUPAVERRATE),3) RLCCSUPAVERRATE,
       round(AVG(RLCCSVTDOWNAVERRATE),3) RLCCSVTDOWNAVERRATE,
       round(AVG(RLCCSVTUPAVERRATE),3) RLCCSVTUPAVERRATE,
       round(AVG(RLCPSDOWNAVERAVGRATE),3) RLCPSDOWNAVERAVGRATE,
       round(AVG(RLCPSR99DOWNAVERAVGRATE),3) RLCPSR99DOWNAVERAVGRATE,
       round(AVG(RLCPSR99UPAVERAVGRATE),3) RLCPSR99UPAVERAVGRATE,
       round(AVG(RLCPSUPAVERRATE),3) RLCPSUPAVERRATE,
       decode(AVG(MEANCELLTCP)*AVG(P_CELL_TRX_POW),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(P_CELL_TRX_POW)/10)*100,3)) DOWNLINKLOAD,
       CASE WHEN MAX(MEANCELLRWTP-NOISE_FLOOR)>=1000 THEN 1 ELSE round  ((1-1/(POWER(10,(CASE  WHEN  MAX(MEANCELLRWTP-NOISE_FLOOR)<=0  THEN 0 ELSE MAX(MEANCELLRWTP-NOISE_FLOOR) END)/10)))*100,3) END UPLINKLOAD,
       CASE  WHEN  MAX(MEANCELLRWTP-NOISE_FLOOR)<=0  THEN 0 ELSE MAX(MEANCELLRWTP-NOISE_FLOOR) END NOISERISE,
       ROUND(avg(MAXR99CELLFREQTCP)/max(MEANR99CELLFREQTCP+0.0000001)*100,3) MEANR99CELLTCPAVGRATE,
       round(AVG(DROP3G),4) DROP3G,
       round(sum(nbrcsuser),3) NBRCSUSER,
       ROUND(SUM(nbrrefthroughput),3) NBRREFTHROUGHPUT,
       DECODE(SUM(NBR2GTO3GHOINREQ),0,100,ROUND( (SUM(NBR2GTO3GHOINSUCC)/((SUM(NBR2GTO3GHOINREQ) ) ))*100,3)) NBR2GTO3GHOINSUCCRATIO,
       CASE  WHEN  SUM(NBR3GTO2GHOOUTSUCC)>SUM(NBR3GTO2GHOOUTREQ) THEN 100 ELSE  DECODE(SUM(NBR3GTO2GHOOUTREQ),0,100,ROUND( (SUM(NBR3GTO2GHOOUTSUCC)/((SUM(NBR3GTO2GHOOUTREQ) ) ))*100,3))  END NBR3GTO2GHOOUTSUCCRAIO,
       DECODE(SUM(NBRCELLUPDREQ),0,100,ROUND( (SUM(NBRCELLUPDSUCC)/((SUM(NBRCELLUPDREQ) ) ))*100,3)) NBRCELLUPDSUCCRATIO,
       DECODE(SUM(NBRCNINTERRNCIAFHHOOUTREQ),0,100,ROUND( (SUM(NBRCNINTERRNCIAFHHOOUTSUCC)/((SUM(NBRCNINTERRNCIAFHHOOUTREQ) ) ))*100,3)) NBRCNINTERRNCIFHOSUCCRATIO,
       DECODE(SUM(NBRCNINTERRNCIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRIURHIERIEFHHOOUTSUCC)/((SUM(NBRCNINTERRNCIEFHHOOUTREQ) ) ))*100,3)) NBRCNIRIFHOSUCCRATIO,
       DECODE(SUM(NBRCS2GTO3GHOINREQ),0,100,ROUND( (SUM(NBRCS2GTO3GHOINSUCC)/((SUM(NBRCS2GTO3GHOINREQ) ) ))*100,3)) NBRCS2GTO3GHOINSUCCRATIO,
       CASE  WHEN  SUM(nbrCs3gto2gHoOutSucc)>SUM(nbrCs3gto2gHoOutReq) THEN 100 ELSE  DECODE(SUM(nbrCs3gto2gHoOutReq), 0, 100, ROUND(SUM(nbrCs3gto2gHoOutSucc) / SUM(nbrCs3gto2gHoOutReq)*100,3))  END NBRCS3GTO2GHOOUTSUCCRAIO,
       DECODE(SUM(NBRCSARELERAB),0,0,ROUND( (SUM(NBRCSAUNNORMRELERAB)/((SUM(NBRCSARELERAB) ) ))*100,3)) NBRCSAUNNORMRELERATIO,
       DECODE(SUM(NBRCSINTRANODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTRANODEBIEFHHOOUTSUCC)/((SUM(NBRCSINTRANODEBIEFHHOOUTREQ) ) ))*100,3)) NBRCSINIFHOSUCCRATIO,
       DECODE(SUM(NBRCSIERBINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTERRNCBIAFHHOOUTSUCC)/((SUM(NBRCSIERBINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRCSINTERRNCBIFHOSUCCRATE,
       DECODE(SUM(NBRCSIERBINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTERRNCBIEFHHOOUTSUCC)/((SUM(NBRCSIERBINTERFREQHHOOUTREQ) ) ))*100,3)) NBRCSIRIFHOSUCCRATIO,
       DECODE(SUM(NBRCSVRELERAB),0,0,ROUND( (SUM(NBRCSVUNNORMRELERAB)/((SUM(NBRCSVRELERAB) ) ))*100,3)) NBRCSKUNNORMRELERATIO,
       DECODE(SUM(NBRCSRABMODIFYREQ),0,100,ROUND( (SUM(NBRCSRABMODIFYSUCC)/((SUM(NBRCSRABMODIFYREQ) ) ))*100,3)) NBRCSRABMODIFYSUCCRATIO,
       DECODE(SUM(NBRCSINTERNODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTERNODEBIEFHHOOUTSUCC)/((SUM(NBRCSINTERNODEBIEFHHOOUTREQ) ) ))*100,3)) NBRCSRINIFHOSUCCRATIO,
       DECODE(SUM(NBRCSSHORLADDREQ),0,100,ROUND( (SUM(NBRCSSHORLADDSUCC)/((SUM(NBRCSSHORLADDREQ) ) ))*100,3)) NBRCSSHORLADDSUCCRATIO,
       DECODE(SUM(NBRCSSHOREQ),0,100,ROUND( (SUM(NBRCSSHOSUCC)/((SUM(NBRCSSHOREQ) ) ))*100,3)) NBRCSSHOSUCCRATIO,
       DECODE(SUM(NBRCSRELERAB),0,0,ROUND( (SUM(NBRCSUNNORMRELERAB)/((SUM(NBRCSRELERAB) ) ))*100,3)) NBRCSUNNORMRELERATIO,
       DECODE(SUM(NBRDCHTOEDCHREQ),0,100,ROUND( (SUM(NBRDCHTOEDCHSUCC)/((SUM(NBRDCHTOEDCHREQ) ) ))*100,3)) NBRDCHTOEDCHSUCCRATIO,
       DECODE(SUM(NBRDCHTOHSDSCHREQ),0,100,ROUND( (SUM(NBRDCHTOHSDSCHSUCC)/((SUM(NBRDCHTOHSDSCHREQ) ) ))*100,3)) NBRDCHTOHSDSCHSUCCRATIO,
       DECODE(SUM(NBREDCHTORACHREQ),0,100,ROUND( (SUM(NBREDCHTORACHSUCC)/((SUM(NBREDCHTORACHREQ) ) ))*100,3)) NBREDCHTORACHSUCCRATIO,
       DECODE(SUM(NBRFACHTOHSDSCHREQ),0,100,ROUND( (SUM(NBRFACHTOHSDSCHSUCC)/((SUM(NBRFACHTOHSDSCHREQ) ) ))*100,3)) NBRFACHTOHSDSCHSUCCRATIO,
       DECODE(SUM(NBRHSDPACELLCHANGEREQ),0,100,ROUND( (SUM(NBRHSDPACELLCHANGESUCC)/((SUM(NBRHSDPACELLCHANGEREQ) ) ))*100,3)) NBRHSDPACELLCHANGESUCCRATIO,
       DECODE(SUM(NBRHSDPARABASSIGNREQ),0,100,ROUND( (SUM(NBRHSDPARABASSIGNSUCC)/((SUM(NBRHSDPARABASSIGNREQ) ) ))*100,3)) NBRHSDPARABASSIGNSUCCRATIO,
       DECODE(SUM(NBRHSDSCHTODCHREQ),0,100,ROUND( (SUM(NBRHSDSCHTODCHSUSS)/((SUM(NBRHSDSCHTODCHREQ) ) ))*100,3)) NBRHSDSCHTODCHSUSSRATIO,
       DECODE(SUM(NBRHSDSCHTOFACHREQ),0,100,ROUND( (SUM(NBRHSDSCHTOFACHSUCC)/((SUM(NBRHSDSCHTOFACHREQ) ) ))*100,3)) NBRHSDSCHTOFACHSUCCRATIO,
       DECODE(SUM(NBRHSUPACELLCHANGEREQ),0,100,ROUND( (SUM(NBRHSUPACELLCHANGESUCC)/((SUM(NBRHSUPACELLCHANGEREQ) ) ))*100,3)) NBRHSUPACELLCHANGESUCCRATIO,
       DECODE(SUM(NBRHSUPARABASSIGNREQ),0,100,ROUND( (SUM(NBRHSUPARABASSIGNSUCC)/((SUM(NBRHSUPARABASSIGNREQ) ) ))*100,3)) NBRHSUPARABASSIGNSUCCRATIO,
       DECODE(SUM((nvl(NBREDCHTORACHSUCC,0)+NRBEDCHTODCHSUCC+NBRHSUPARABREL)),0,0,ROUND( (SUM(NBRHSUPARABDROP)/((SUM((nvl(NBREDCHTORACHSUCC,0)+NRBEDCHTODCHSUCC+NBRHSUPARABREL)) ) ))*100,3)) NBRHSUPARABDROPRATIO,
       DECODE(SUM(NBRINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTRAFREQHHOOUTSUCC)/((SUM(NBRINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRIFHOSUCCRATIO,
       DECODE(SUM(NBRINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERFREQHHOOUTSUCC)/((SUM(NBRINTERFREQHHOOUTREQ) ) ))*100,3)) NBRAIFHOSUCCRATIO,
       DECODE(SUM(NBRIURINTERRNCIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRIURINTERRNCIEFHHOOUTSUCC)/((SUM(NBRIURINTERRNCIEFHHOOUTREQ) ) ))*100,3)) NBRIIRIFHOSUCCRATIO,
       DECODE(SUM(NBRINTRANODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRINTRANODEBIEFHHOOUTSUCC)/((SUM(NBRINTRANODEBIEFHHOOUTREQ) ) ))*100,3)) NBRINIFHOSUCCRATIO,
       DECODE(SUM(NBRIERBINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERRNCBIAFHHOOUTSUCC)/((SUM(NBRIERBINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRINTERRNCBIFHOSUCCRATE,
       DECODE(SUM(NBRIERBINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERRNCBIEFHHOOUTSUCC)/((SUM(NBRIERBINTERFREQHHOOUTREQ) ) ))*100,3)) NBRIRIFHOSUCCRATIO,
       DECODE(SUM(NBRIUBRLADDREQ),0,100,ROUND( (SUM(NBRIUBRLADDSUCC)/((SUM(NBRIUBRLADDREQ) ) ))*100,3)) NBRIUBRLADDSUCCRATIO,
       DECODE(SUM(NBRIUBRLSETUPREQ),0,100,ROUND( (SUM(NBRIUBRLSETUPSUCC)/((SUM(NBRIUBRLSETUPREQ) ) ))*100,3)) NBRIUBRLSETUPSUCCRATIO,
       DECODE(SUM(NBRIURINTERRNCIAFHHOOUTREQ),0,100,ROUND( (SUM(NBRIURINTERRNCIAFHHOOUTSUCC)/((SUM(NBRIURINTERRNCIAFHHOOUTREQ) ) ))*100,3)) NBRIURINTERRNCIFHOSUCCRATIO,
       DECODE(SUM(NBRIURRLADDREQ),0,100,ROUND( (SUM(NBRIURRLADDSUCC)/((SUM(NBRIURRLADDREQ) ) ))*100,3)) NBRIURRLADDSUCCRATIO,
       DECODE(SUM(NBRIURRLSETUPREQ),0,100,ROUND( (SUM(NBRIURRLSETUPSUCC)/((SUM(NBRIURRLSETUPREQ) ) ))*100,3)) NBRIURRLSETUPSUCCRATIO,
       DECODE(SUM(NBRPS2GTO3GHOINREQ),0,100,ROUND( (SUM(NBRPS2GTO3GHOINSUCC)/((SUM(NBRPS2GTO3GHOINREQ) ) ))*100,3)) NBRPS2GTO3GHOINSUCCRATIO,
       CASE  WHEN  SUM(NBRPS3GTO2GHOOUTSUCC)>SUM(NBRPS3GTO2GHOOUTREQ) THEN 100 ELSE  DECODE(SUM(NBRPS3GTO2GHOOUTREQ),0,100,ROUND( (SUM(NBRPS3GTO2GHOOUTSUCC)/((SUM(NBRPS3GTO2GHOOUTREQ) ) ))*100,3))  END NBRPS3GTO2GHOOUTSUCCRAIO,
       DECODE(SUM(NBRPSINTRANODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTRANODEBIEFHHOOUTSUCC)/((SUM(NBRPSINTRANODEBIEFHHOOUTREQ) ) ))*100,3)) NBRPSINIFHOSUCCRATIO,
       DECODE(SUM(NBRPSIERBINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTERRNCBIAFHHOOUTSUCC)/((SUM(NBRPSIERBINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRPSINTERRNCBIFHOSUCCRATE,
       DECODE(SUM(NBRPSIERBINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTERRNCBIEFHHOOUTSUCC)/((SUM(NBRPSIERBINTERFREQHHOOUTREQ) ) ))*100,3)) NBRPSIRIFHOSUCCRATIO,
       DECODE(SUM(NBRPSRABMODIFYREQ),0,100,ROUND( (SUM(NBRPSRABMODIFYSUCC)/((SUM(NBRPSRABMODIFYREQ) ) ))*100,3)) NBRPSRABMODIFYSUCCRATIO,
       DECODE(SUM(NBRPSINTERNODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTERNODEBIEFHHOOUTSUCC)/((SUM(NBRPSINTERNODEBIEFHHOOUTREQ) ) ))*100,3)) NBRPSRINIFHOSUCCRATIO,
       DECODE(SUM(NBRPSSHORLADDREQ),0,100,ROUND( (SUM(NBRPSSHORLADDSUCC)/((SUM(NBRPSSHORLADDREQ) ) ))*100,3)) NBRPSSHORLADDSUCCRATIO,
       DECODE(SUM(NBRPSSHOREQ),0,100,ROUND( (SUM(NBRPSSHOSUCC)/((SUM(NBRPSSHOREQ) ) ))*100,3)) NBRPSSHOSUCCRATIO,
       DECODE(SUM(NBRPSRELERAB),0,0,ROUND( (SUM(NBRPSUNNORMRELERAB)/((SUM(NBRPSRELERAB) ) ))*100,3)) NBRPSUNNORMRELERATIO,
       DECODE(SUM(NBRRABASSIGNREQ),0,0,ROUND( (SUM(NBRRABASSIGNCONG)/((SUM(NBRRABASSIGNREQ) ) ))*100,3)) NBRRABASSIGNCONGRATIO,
       DECODE(SUM(NBRRABMODIFYREQ),0,100,ROUND( (SUM(NBRRABMODIFYSUCC)/((SUM(NBRRABMODIFYREQ) ) ))*100,3)) NBRRABMODIFYSUCCRATIO,
       DECODE(SUM(NBRRACHTOEDCHREQ),0,100,ROUND( (SUM(NBRRACHTOEDCHSUCC)/((SUM(NBRRACHTOEDCHREQ) ) ))*100,3)) NBRRACHTOEDCHSUCCRATIO,
       DECODE(SUM(NBRINTERNODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERNODEBIEFHHOOUTSUCC)/((SUM(NBRINTERNODEBIEFHHOOUTREQ) ) ))*100,3)) NBRRINIFHOSUCCRATIO,
       DECODE(SUM(NBRRRCRELEREQ),0,0,ROUND( (SUM(NBRRRCUNNORMRELE)/((SUM(NBRRRCRELEREQ) ) ))*100,3)) NBRRRCUNNORMRELERATIO,
       DECODE(SUM(NBRSHORLADDREQ),0,100,ROUND( (SUM(NBRSHORLADDSUCC)/((SUM(NBRSHORLADDREQ) ) ))*100,3)) NBRSHORLADDSUCCRATIO,
       DECODE(SUM(NBRSHOREQ),0,100,ROUND( (SUM(NBRSHOSUCC)/((SUM(NBRSHOREQ) ) ))*100,3)) NBRSHOSUCCRATIO,
       DECODE(SUM(NBRRELERAB),0,0,ROUND( (SUM(NBRUNNORMRELERAB)/((SUM(NBRRELERAB) ) ))*100,3)) NBRUNNORMRELERATIO,
       DECODE(SUM(NBRURAUPDREQ),0,100,ROUND( (SUM(NBRURAUPDSUCC)/((SUM(NBRURAUPDREQ) ) ))*100,3)) NBRURAUPDSUCCRATIO,
       DECODE(SUM(NRBEDCHTODCHREQ),0,100,ROUND( (SUM(NRBEDCHTODCHSUCC)/((SUM(NRBEDCHTODCHREQ) ) ))*100,3)) NRBEDCHTODCHSUCCRATIO,
       DECODE(SUM(NBRPSRLCDOWNTRANBLOCK),0,0,ROUND( (SUM(NBRPSRLCDOWNRETRANBLOCK)/((SUM(NBRPSRLCDOWNTRANBLOCK) ) ))*100,3)) PSRLCDOWNRETRANRATIO,
       CASE WHEN SUM(NBRRABASSIGNSUCC) >SUM(NBRRABASSIGNREQ) THEN 100 ELSE DECODE(SUM(NBRRABASSIGNREQ) ,0,100,ROUND((SUM(NBRRABASSIGNSUCC)/((SUM(NBRRABASSIGNREQ) ) ))*100,3)) END   RABASSIGNSUCCRATIO,
       DECODE(SUM(NBRCSARABASSIGNREQ),0,100,ROUND( (SUM(NBRCSARABASSIGNSUCC)/((SUM(NBRCSARABASSIGNREQ) ) ))*100,3)) RABCSAASSIGNSUCCRATIO,
       DECODE(SUM(NBRCSRABASSIGNREQ),0,100,ROUND( (SUM(NBRCSRABASSIGNSUCC)/((SUM(NBRCSRABASSIGNREQ) ) ))*100,3)) RABCSASSIGNSUCCRATIO,
       DECODE(SUM(NBRCSVRABASSIGNREQ),0,100,ROUND( (SUM(NBRCSVRABASSIGNSUCC)/((SUM(NBRCSVRABASSIGNREQ) ) ))*100,3)) RABCSKASSIGNSUCCRATIO,
       DECODE(SUM(NBRPSRABASSIGNREQ),0,100,ROUND( (SUM(NBRPSRABASSIGNSUCC)/((SUM(NBRPSRABASSIGNREQ) ) ))*100,3)) RABPSASSIGNSUCCRATIO,
       CASE WHEN DECODE(SUM(NBRRRCCONNREQ),0,100,ROUND( (SUM(NBRRRCCONNSUCC)/((SUM(NBRRRCCONNREQ) ) ))*100,3)) >100  THEN 100  ELSE DECODE(SUM(NBRRRCCONNREQ),0,100,ROUND( (SUM(NBRRRCCONNSUCC)/((SUM(NBRRRCCONNREQ) ) ))*100,3))   END RRCCONNSUCCRATIO,
       DECODE(SUM(NBRCS3GTO2GPREHOOUTREQ),0,100,ROUND(SUM(NBRCS3GTO2GPREHOOUTREQ-NBRCS3GTO2GPREHOOUTFAIL)/SUM(((NBRCS3GTO2GPREHOOUTREQ)) ) * 100,3)) NBRCS3GTO2GPREHOOUTSUCCRAIO,
       ROUND((SUM(NBRHSDPARABDROP)/(SUM(NBRHSDPARABREL+NBRHSDSCHTODCHSUSS+NBRHSDSCHTOFACHSUCC) + 0.0000001))* 100,3)  NBRHSDPARABDROPRATIO,
       CASE WHEN ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRRABASSIGNREQ),0,1,SUM(NBRRABASSIGNSUCC)/SUM(NBRRABASSIGNREQ))*100 ,3)  >100  THEN 100  ELSE ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRRABASSIGNREQ),0,1,SUM(NBRRABASSIGNSUCC)/SUM(NBRRABASSIGNREQ))*100 ,3) END RADIOCONNRATIO,
       CASE WHEN ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRCSRABASSIGNREQ),0,1,SUM(NBRCSRABASSIGNSUCC)/SUM(NBRCSRABASSIGNREQ))*100 ,3) >100  THEN 100  ELSE ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRCSRABASSIGNREQ),0,1,SUM(NBRCSRABASSIGNSUCC)/SUM(NBRCSRABASSIGNREQ))*100 ,3)  END RADIOCSCONNRATIO,
       CASE WHEN ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRPSRABASSIGNREQ),0,1,SUM(NBRPSRABASSIGNSUCC)/SUM(NBRPSRABASSIGNREQ))*100 ,3) >100  THEN 100  ELSE ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRPSRABASSIGNREQ),0,1,SUM(NBRPSRABASSIGNSUCC)/SUM(NBRPSRABASSIGNREQ))*100 ,3)  END RADIOPSCONNRATIO,
       DECODE(SUM(NBRCSRABASSIGNREQ),0,0,ROUND( (SUM(NBRCSRABASSIGNCONG)/((SUM(NBRCSRABASSIGNREQ) ) ))*100,3)) NBRCSRABASSIGNCONGRATIO,
       DECODE(SUM(NBRPSRABASSIGNREQ),0,0,ROUND( (SUM(NBRPSRABASSIGNCONG)/((SUM(NBRPSRABASSIGNREQ) ) ))*100,3)) NBRPSRABASSIGNCONGRATIO,
       ROUND(avg(nvl(NBRSF4USAGE/4,0) + nvl(NBRSF8USAGE/8,0) + nvl(NBRSF16USAGE/16,0) + nvl(NBRSF32USAGE/32,0) + nvl(NBRSF64USAGE/64,0) + nvl(NBRSF128USAGE/128,0) + nvl(NBRSF256USAGE/256,0))*100,3) NBRSFALL_RATE,
       ROUND(AVG(NBRHSDPASF16USAGE)/16*100,3) NBRHSDPASF16USAGE_RATE,
       case  when  sum(NBRCS3GTO2GHOOUTSUCC)  >  sum(NBRCSRABASSIGNSUCC)  then  100   else   round (sum(NBRCS3GTO2GHOOUTSUCC)/(sum(NBRCSRABASSIGNSUCC)+0.0000001)*100,3)  end NBRCS3GTO2GHOOUTRATE,
       ROUND(AVG(fachOccupRatio),3) FACHOCCUPRATIO,
       ROUND(AVG(rachOccupRatio),3) RACHOCCUPRATIO,
       ROUND(AVG(CqiVaule),3) CQIVAULE,
       ROUND(SUM(nbrSf4Usage),3) NBRSF4USAGE,
       ROUND(AVG(nbrSf16Usage),3) NBRSF16USAGE,
       ROUND(AVG(nbrSf128Usage),3) NBRSF128USAGE,
       ROUND(MAX(nbrMaxHsdpaSfUsage),3) NBRMAXHSDPASFUSAGE,
       ROUND(AVG(nbrSf8Usage),3) NBRSF8USAGE,
       ROUND(AVG(nbrSf64Usage),3) NBRSF64USAGE,
       ROUND(AVG(nbrHsdpaSf16Usage),3) NBRHSDPASF16USAGE,
       ROUND(AVG(nbrSf256Usage),3) NBRSF256USAGE,
       ROUND(AVG(nbrSf32Usage),3) NBRSF32USAGE,
       round(SUM(NBRSF4USAGE +NBRSF8USAGE + NBRSF16USAGE + NBRSF32USAGE +NBRSF64USAGE + NBRSF128USAGE  + NBRSF256USAGE), 2) CODE_NORMALIZE_SF256,
       ROUND(avg(nvl(NBRSF4USAGE/4,0) + nvl(NBRSF8USAGE/8,0) + nvl(NBRSF16USAGE/16,0) + nvl(NBRSF32USAGE/32,0) + nvl(NBRSF64USAGE/64,0) + nvl(NBRSF128USAGE/128,0) + nvl(NBRSF256USAGE/256,0)),3) NBRSFALLRATE,
       ROUND(AVG(NBRSF4USAGE)/4*100,3) NBRSF4USAGE_RATE,
       ROUND(AVG(NBRSF8USAGE)/8*100,3) NBRSF8USAGE_RATE,
       ROUND(AVG(NBRSF16USAGE)/16*100,3) NBRSF16USAGE_RATE,
       ROUND(AVG(NBRSF32USAGE)/32*100,3) NBRSF32SAGE_RATE,
       ROUND(AVG(NBRSF64USAGE)/64*100,3) NBRSF64USAGE_RATE,
       ROUND(AVG(NBRSF128USAGE)/128*100,3) NBRSF128USAGE_RATE,
       decode(AVG(MEANCELLTCP)*AVG(NVL(P_CELL_TRX_POW,43)),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(NVL(P_CELL_TRX_POW,43))/10)*100,3)) NBRDLTCPRATE,
       ROUND(MAX(maxCellTcp),3) MAXCELLTCP,
       ROUND(AVG(meanCellRwtp),3) MEANCELLRWTP,
       ROUND(AVG(maxR99CellFreqTcp),3) MAXR99CELLFREQTCP,
       ROUND(MAX(maxHsdpaCellFreqTcp),3) MAXHSDPACELLFREQTCP,
       ROUND(AVG(meanCellTcp),3) MEANCELLTCP,
       ROUND(MAX(maxCellRwtp),3) MAXCELLRWTP,
       ROUND(AVG(meanHsdpaCellFreqTcp),3) MEANHSDPACELLFREQTCP,
       ROUND(MAX(meanR99CellFreqTcp),3) MEANR99CELLFREQTCP,
       decode(MAX(MAXR99CELLFREQTCP)*AVG(P_CELL_TRX_POW),0,0,round(POWER(10,AVG(MAXR99CELLFREQTCP)/10)/POWER(10,MAX(P_CELL_TRX_POW)/10)*100,3)) MAXCTCP_MSDPAFREQTCP,
       ROUND(SUM(nbrHsupaActiveUe),3) NBRHSUPAACTIVEUE,
       ROUND(SUM(nbrHsdpaActiveUe),3) NBRHSDPAACTIVEUE,
       ROUND(SUM(upDchPdu),3) UPDCHPDU,
       ROUND(SUM(downDchPdu),3) DOWNDCHPDU,
       ROUND(SUM(rachPdu),3) RACHPDU,
       ROUND(SUM(RlcUpTraffic),3) RLCUPTRAFFIC,
       ROUND(SUM(fachPdu),3) FACHPDU,
       ROUND(SUM(RlcDownTraffic),3) RLCDOWNTRAFFIC,
       ROUND(SUM(rlcCsDownAverRate),3) RLCCSDOWNAVERRATE,
       ROUND(SUM(RlcCsUpTraffic),3) RLCCSUPTRAFFIC,
       ROUND(SUM(rlcPsDownAverRate),3) RLCPSDOWNAVERRATE,
       ROUND(SUM(rlcCsADownAverRate),3) RLCCSADOWNAVERRATE,
       ROUND(SUM(RlcCsAUpTraffic),3) RLCCSAUPTRAFFIC,
       ROUND(SUM(rlcCSvDownAverRate),3) RLCCSVDOWNAVERRATE,
       ROUND(SUM(RlcCsVUpTraffic),3) RLCCSVUPTRAFFIC,
       ROUND(SUM(hsdpaRlcDownBgrdTraffic),3) HSDPARLCDOWNBGRDTRAFFIC,
       ROUND(SUM(RlcPsUpTraffic),3) RLCPSUPTRAFFIC,
       ROUND(SUM(hsupaRlcUpTraffic),3) HSUPARLCUPTRAFFIC,
       ROUND((sum(nvl(NBRCSUSER,0))*50*3600/1024+sum(nvl(HSUPARLCUPTRAFFIC,0))*1.2*8/1024+SUM(NVL(NBRRRCCONNSUCC,0))*4*13.6/1024)/sum(nbrrefthroughput*0.9)*100,3) RADIORATIO,
       round((sum(nvl(NBRCSUSER,0))*50*3600/1024+sum(nvl(HSUPARLCUPTRAFFIC,0))*1.2*8/1024),3) TRAFFIC3G,
       round(sum(nvl(NBRCSUSER,0))*50*3600/1024,3) TRAFFICCS,
       ROUND((sum(nvl(NBRCSUSER,0))*50*3600/1024)/sum(nbrrefthroughput*0.9)*100,3) RADIORATIOCS,
       ROUND((sum(nvl(HSUPARLCUPTRAFFIC,0))*1.2*8/1024)/sum(nbrrefthroughput*0.9)*100,3) RADIORATIOPS,
       ROUND(SUM(nbrrefthroughput)*0.9,3) RADIORATIO_FENMU,
       ROUND((sum(nvl(NBRCSUSER_BUSY,0))*50*3600/1024+sum(nvl(HSUPARLCUPTRAFFIC_BUSY,0))*1.2*8/1024+sum(USE_SIG_TRAFFIC_BUSY))/sum(nbrrefthroughput_BUSY*0.9+0.0000001)*100,4) RADIORATIO_BUSY,
       ROUND(SUM(hsupaRlcUpTraffic_BUSY),3) HSUPARLCUPTRAFFIC_BUSY,
       round(sum(nbrcsuser_BUSY),3) NBRCSUSER_BUSY,
       ROUND(SUM(NBRREFTHROUGHPUT_BUSY),3) NBRREFTHROUGHPUT_BUSY,
       ROUND((sum(nvl(NBRCSUSER_BUSY,0))*50*3600/1024)/sum(nbrrefthroughput_BUSY*0.9)*100,3) RADIORATIOCS_BUSY,
       ROUND((sum(nvl(HSUPARLCUPTRAFFIC_BUSY,0))*1.2*8/1024)/sum(nbrrefthroughput_BUSY*0.9)*100,3) RADIORATIOPS_BUSY,
       ROUND(SUM(USE_SIG_TRAFFIC_BUSY),4) USE_SIG_TRAFFIC_BUSY,
       ROUND(SUM(NBRRRCCONNSUCC)*4*13.6/1024,4) USE_SIG_TRAFFIC,
       ROUND(SUM(csErlTraffic),3) CSERLTRAFFIC,
       ROUND(AVG(fachAverRate),3) FACHAVERRATE,
       ROUND(AVG(rachAverRate),3) RACHAVERRATE,
       ROUND(AVG(rlcDownAverRate),3) RLCDOWNAVERRATE,
       ROUND(AVG(hsupaRlcUpAverRate),3) HSUPARLCUPAVERRATE,
       ROUND(AVG(upDchAverRate),3) UPDCHAVERRATE,
       ROUND(AVG(rlcUpAverRate),3) RLCUPAVERRATE,
       ROUND(AVG(downDchAverRate),3) DOWNDCHAVERRATE,
       ROUND(AVG(hsupaRlcDownAverRate),3) HSUPARLCDOWNAVERRATE,
       ROUND(SUM(IubSPUpPdu),3) IUBSPUPPDU,
       ROUND(AVG(IubSPDownAverRate),3) IUBSPDOWNAVERRATE,
       ROUND(SUM(IubUPUpPdu),3) IUBUPUPPDU,
       ROUND(SUM(IubUPDownPdu),3) IUBUPDOWNPDU,
       ROUND(AVG(IubATMUpAverRate),3) IUBATMUPAVERRATE,
       ROUND(AVG(IubATMDownAverRate),3) IUBATMDOWNAVERRATE,
       ROUND(SUM(IubATMDownPdu),3) IUBATMDOWNPDU,
       ROUND(AVG(IubIPUpAverRate),3) IUBIPUPAVERRATE,
       ROUND(SUM(IubIPDownPdu),3) IUBIPDOWNPDU,
       ROUND(AVG(IubSPUpAverRate),3) IUBSPUPAVERRATE,
       ROUND(SUM(IubSPDownPdu),3) IUBSPDOWNPDU,
       ROUND(AVG(IubUPDownAverRate),3) IUBUPDOWNAVERRATE,
       ROUND(SUM(IubATMUpPdu),3) IUBATMUPPDU,
       ROUND(SUM(IubIPUpPdu),3) IUBIPUPPDU,
       ROUND(AVG(IubUPUpAverRate),3) IUBUPUPAVERRATE,
       ROUND(AVG(IubIPDownAverRate),3) IUBIPDOWNAVERRATE,
       ROUND(SUM(nbrMachsTranHAPdu),3) NBRMACHSTRANHAPDU,
       ROUND(SUM(nbrMaceTranHAPdu),3) NBRMACETRANHAPDU,
       ROUND(SUM(nbrMaceTranPdu),3) NBRMACETRANPDU,
       ROUND(SUM(nbrPsRlcDownTranBlock),3) NBRPSRLCDOWNTRANBLOCK,
       ROUND(SUM(nbrMachsTranPdu),3) NBRMACHSTRANPDU,
       ROUND(SUM(nbrPsRlcDownRetranBlock),3) NBRPSRLCDOWNRETRANBLOCK,
       ROUND(SUM(nbrUpDchErrorBlock),3) NBRUPDCHERRORBLOCK,
       ROUND(SUM(nbrUpDchTotalBlock),3) NBRUPDCHTOTALBLOCK,
       ROUND(SUM(nbrCsUpDchTotalBlock),3) NBRCSUPDCHTOTALBLOCK,
       ROUND(SUM(nbrCsUpDchErrorBlock),3) NBRCSUPDCHERRORBLOCK,
       ROUND(SUM(nbrPsUpDchTotalBlock),3) NBRPSUPDCHTOTALBLOCK,
       ROUND(SUM(nbrPsUpDchErrorBlock),3) NBRPSUPDCHERRORBLOCK,
       ROUND(SUM(nbrCsaUpDchTotalBlock),3) NBRCSAUPDCHTOTALBLOCK,
       ROUND(SUM(nbrCsAUpDchErrorBlock),3) NBRCSAUPDCHERRORBLOCK,
       ROUND(SUM(nbrCsvUpDchTotalBlock),3) NBRCSVUPDCHTOTALBLOCK,
       ROUND(SUM(nbrCsvUpDchErrorBlock),3) NBRCSVUPDCHERRORBLOCK,
       ROUND(SUM(nbrRachErrorBlock),3) NBRRACHERRORBLOCK,
       ROUND(SUM(nbrRachTotalBlock),3) NBRRACHTOTALBLOCK,
       ROUND(SUM(NBRRRCCONNREQ-NBRRRCCONNSUCC),3) NBRRRCCONNFAIL,
       ROUND(SUM(NBRCSRABASSIGNREQ-NBRCSRABASSIGNSUCC),3) NBRCSRABASSIGNFAIL,
       ROUND(SUM(NBRPSRABASSIGNREQ-NBRPSRABASSIGNSUCC),3) NBRPSRABASSIGNFAIL,
       ROUND(SUM(nbrFachtoHsdschSucc),3) NBRFACHTOHSDSCHSUCC,
       ROUND(SUM(nbrHsdschtoFachReq),3) NBRHSDSCHTOFACHREQ,
       ROUND(SUM(nbrHsdschtoDchSuss),3) NBRHSDSCHTODCHSUSS,
       ROUND(SUM(nbrRachtoEdchSucc),3) NBRRACHTOEDCHSUCC,
       ROUND(SUM(nbrEdchtoRachReq),3) NBREDCHTORACHREQ,
       ROUND(SUM(nbrDchtoEdchReq),3) NBRDCHTOEDCHREQ,
       ROUND(SUM(nbrFachtoHsdschReq),3) NBRFACHTOHSDSCHREQ,
       ROUND(SUM(nbrDchtoHsdschReq),3) NBRDCHTOHSDSCHREQ,
       ROUND(SUM(nbrDchtoHsdschSucc),3) NBRDCHTOHSDSCHSUCC,
       ROUND(SUM(nbrHsdschtoFachSucc),3) NBRHSDSCHTOFACHSUCC,
       ROUND(SUM(nbrHsdschtoDchReq),3) NBRHSDSCHTODCHREQ,
       ROUND(SUM(nbrRachtoEdchReq),3) NBRRACHTOEDCHREQ,
       ROUND(SUM(nbrDchtoEdchSucc),3) NBRDCHTOEDCHSUCC,
       ROUND(SUM(nbrEdchtoRachSucc),3) NBREDCHTORACHSUCC,
       ROUND(SUM(nrbEdchtoDchReq),3) NRBEDCHTODCHREQ,
       ROUND(SUM(nrbEdchtoDchSucc),3) NRBEDCHTODCHSUCC,
       DECODE(SUM(NBRMACETRANPDU),0,0,ROUND( (SUM(NBRMACETRANHAPDU)/((SUM(NBRMACETRANPDU) ) ))*100,3)) MACETRANHAPDURATIO,
       DECODE(SUM(NBRMACHSTRANPDU),0,0,ROUND( (SUM(NBRMACHSTRANHAPDU)/((SUM(NBRMACHSTRANPDU) ) ))*100,3)) MACHSTRANHAPDURATIO,
       DECODE(SUM(NBRRACHTOTALBLOCK),0,0,ROUND( (SUM(NBRRACHERRORBLOCK)/((SUM(NBRRACHTOTALBLOCK) ) ))*100,3)) RACHBLER,
       DECODE(SUM(NBRUPDCHTOTALBLOCK),0,0,ROUND( (SUM(NBRUPDCHERRORBLOCK)/((SUM(NBRUPDCHTOTALBLOCK) ) ))*100,3)) UPDCHBLER,
       ROUND(SUM(nbrHsdpaCellChangeReq),3) NBRHSDPACELLCHANGEREQ,
       ROUND(SUM(nbrHsupaCellChangeSucc),3) NBRHSUPACELLCHANGESUCC,
       ROUND(SUM(nbrHsupaCellChangeReq),3) NBRHSUPACELLCHANGEREQ,
       ROUND(SUM(nbrHsdpaCellChangeSucc),3) NBRHSDPACELLCHANGESUCC,
       ROUND(SUM(nbrCs3gto2gPreHoOutReq),3) NBRCS3GTO2GPREHOOUTREQ,
       ROUND(SUM(nbr3gto2gHoOutSucc),3) NBR3GTO2GHOOUTSUCC,
       ROUND(SUM(nbrCs3gto2gHoOutSucc),3) NBRCS3GTO2GHOOUTSUCC,
       ROUND(SUM(nbrCs3gto2gHoOutReq),3) NBRCS3GTO2GHOOUTREQ,
       ROUND(SUM(nbrCs2gto3gHoInReq),3) NBRCS2GTO3GHOINREQ,
       ROUND(SUM(nbrCs2gto3gHoInSucc),3) NBRCS2GTO3GHOINSUCC,
       ROUND(SUM(nbrPs3gto2gHoOutSucc),3) NBRPS3GTO2GHOOUTSUCC,
       ROUND(SUM(nbrPs3gto2gHoOutReq),3) NBRPS3GTO2GHOOUTREQ,
       ROUND(SUM(nbrPs2gto3gHoInReq),3) NBRPS2GTO3GHOINREQ,
       ROUND(SUM(nbrPs2gto3gHoInSucc),3) NBRPS2GTO3GHOINSUCC,
       ROUND(SUM(nbr3gto2gHoOutReq),3) NBR3GTO2GHOOUTREQ,
       ROUND(SUM(nbr2gto3gHoInReq),3) NBR2GTO3GHOINREQ,
       ROUND(SUM(nbr2gto3gHoInSucc),3) NBR2GTO3GHOINSUCC,
       ROUND(SUM(nbrCs3gto2gPreHoOutFail),3) NBRCS3GTO2GPREHOOUTFAIL,
       ROUND(SUM(nbrCellUpdReq),3) NBRCELLUPDREQ,
       ROUND(SUM(nbrCellUpdSucc),3) NBRCELLUPDSUCC,
       ROUND(SUM(nbrUraUpdReq),3) NBRURAUPDREQ,
       ROUND(SUM(nbrUraUpdSucc),3) NBRURAUPDSUCC,
       ROUND(SUM(nbrInterRncbIeFHhoOutSucc),3) NBRINTERRNCBIEFHHOOUTSUCC,
       ROUND(SUM(nbrIurInterRncIaFHhoOutSucc),3) NBRIURINTERRNCIAFHHOOUTSUCC,
       ROUND(SUM(nbrCnInterRncIaFHhoOutReq),3) NBRCNINTERRNCIAFHHOOUTREQ,
       ROUND(SUM(nbrCsInterRncbIeFHhoOutSucc),3) NBRCSINTERRNCBIEFHHOOUTSUCC,
       ROUND(SUM(nbrCsCnInterRncIaFHhoOutReq),3) NBRCSCNINTERRNCIAFHHOOUTREQ,
       ROUND(SUM(nbrCsIurHIeRIeFHhoOutSucc),3) NBRCSIURHIERIEFHHOOUTSUCC,
       ROUND(SUM(nbrCsIntraNodebIeFHhoOutReq),3) NBRCSINTRANODEBIEFHHOOUTREQ,
       ROUND(SUM(nbrCsIntraNodebIeFHhoOutSucc),3) NBRCSINTRANODEBIEFHHOOUTSUCC,
       ROUND(SUM(nbrCsInterNodebIeFHhoOutSucc),3) NBRCSINTERNODEBIEFHHOOUTSUCC,
       ROUND(SUM(nbrCsIeRbIntraFreqHhoOutReq),3) NBRCSIERBINTRAFREQHHOOUTREQ,
       ROUND(SUM(nbrCsInterRncbIaFHhoOutSucc),3) NBRCSINTERRNCBIAFHHOOUTSUCC,
       ROUND(SUM(nbrCsIeRbInterFreqHhoOutReq),3) NBRCSIERBINTERFREQHHOOUTREQ,
       ROUND(SUM(nbrCsCnInterRncIeFHhoOutReq),3) NBRCSCNINTERRNCIEFHHOOUTREQ,
       ROUND(SUM(nbrPsCnInterRncIaFHhoOutReq),3) NBRPSCNINTERRNCIAFHHOOUTREQ,
       ROUND(SUM(nbrPsIntraNodebIeFHhoOutReq),3) NBRPSINTRANODEBIEFHHOOUTREQ,
       ROUND(SUM(nbrPsIntraNodebIeFHhoOutSucc),3) NBRPSINTRANODEBIEFHHOOUTSUCC,
       ROUND(SUM(nbrPsInterNodebIeFHhoOutReq),3) NBRPSINTERNODEBIEFHHOOUTREQ,
       ROUND(SUM(nbrPsInterNodebIeFHhoOutSucc),3) NBRPSINTERNODEBIEFHHOOUTSUCC,
       ROUND(SUM(nbrPsInterRncbIaFHhoOutSucc),3) NBRPSINTERRNCBIAFHHOOUTSUCC,
       ROUND(SUM(nbrPsIeRbInterFreqHhoOutReq),3) NBRPSIERBINTERFREQHHOOUTREQ,
       ROUND(SUM(nbrPsCnInterRncIaFHhoOutSucc),3) NBRPSCNINTERRNCIAFHHOOUTSUCC,
       ROUND(SUM(nbrPsCnInterRncIeFHhoOutReq),3) NBRPSCNINTERRNCIEFHHOOUTREQ,
       ROUND(SUM(nbrInterFreqHhoOutSucc),3) NBRINTERFREQHHOOUTSUCC,
       ROUND(SUM(nbrInterNodebIeFHhoOutReq),3) NBRINTERNODEBIEFHHOOUTREQ,
       ROUND(SUM(nbrIeRbInterFreqHhoOutReq),3) NBRIERBINTERFREQHHOOUTREQ,
       ROUND(SUM(nbrCnInterRncIaFHhoOutSucc),3) NBRCNINTERRNCIAFHHOOUTSUCC,
       ROUND(SUM(nbrCsInterNodebIeFHhoOutReq),3) NBRCSINTERNODEBIEFHHOOUTREQ,
       ROUND(SUM(nbrCsCnInterRncIaFHhoOutSucc),3) NBRCSCNINTERRNCIAFHHOOUTSUCC,
       ROUND(SUM(nbrPsIurHIeRIeFHhoOutSucc),3) NBRPSIURHIERIEFHHOOUTSUCC,
       ROUND(SUM(nbrIntraFreqHhoOutReq),3) NBRINTRAFREQHHOOUTREQ,
       ROUND(SUM(nbrIntraFreqHhoOutSucc),3) NBRINTRAFREQHHOOUTSUCC,
       ROUND(SUM(nbrInterFreqHhoOutReq),3) NBRINTERFREQHHOOUTREQ,
       ROUND(SUM(nbrIntraNodebIeFHhoOutReq),3) NBRINTRANODEBIEFHHOOUTREQ,
       ROUND(SUM(nbrIntraNodebIeFHhoOutSucc),3) NBRINTRANODEBIEFHHOOUTSUCC,
       ROUND(SUM(nbrInterNodebIeFHhoOutSucc),3) NBRINTERNODEBIEFHHOOUTSUCC,
       ROUND(SUM(nbrIeRbIntraFreqHhoOutReq),3) NBRIERBINTRAFREQHHOOUTREQ,
       ROUND(SUM(nbrInterRncbIaFHhoOutSucc),3) NBRINTERRNCBIAFHHOOUTSUCC,
       ROUND(SUM(nbrIurInterRncIaFHhoOutReq),3) NBRIURINTERRNCIAFHHOOUTREQ,
       ROUND(SUM(nbrIurInterRncIeFHhoOutReq),3) NBRIURINTERRNCIEFHHOOUTREQ,
       ROUND(SUM(nbrIurInterRncIeFHhoOutSucc),3) NBRIURINTERRNCIEFHHOOUTSUCC,
       ROUND(SUM(nbrCnInterRncIeFHhoOutReq),3) NBRCNINTERRNCIEFHHOOUTREQ,
       ROUND(SUM(nbrIurHIeRIeFHhoOutSucc),3) NBRIURHIERIEFHHOOUTSUCC,
       ROUND(SUM(nbrPsInterRncbIeFHhoOutSucc),3) NBRPSINTERRNCBIEFHHOOUTSUCC,
       ROUND(SUM(nbrPsIeRbIntraFreqHhoOutReq),3) NBRPSIERBINTRAFREQHHOOUTREQ,
       ROUND(SUM(nbrCsShoReq),3) NBRCSSHOREQ,
       ROUND(SUM(nbrCsShoSucc),3) NBRCSSHOSUCC,
       ROUND(SUM(nbrCsShoRLAddSucc),3) NBRCSSHORLADDSUCC,
       ROUND(SUM(nbrCsShoRLDelReq),3) NBRCSSHORLDELREQ,
       ROUND(SUM(nbrPsShoSucc),3) NBRPSSHOSUCC,
       ROUND(SUM(nbrPsShoRLAddReq),3) NBRPSSHORLADDREQ,
       ROUND(SUM(nbrPsShoRLAddSucc),3) NBRPSSHORLADDSUCC,
       ROUND(SUM(nbrPsShoRLDelReq),3) NBRPSSHORLDELREQ,
       ROUND(SUM(nbrPsShoRLDelSucc),3) NBRPSSHORLDELSUCC,
       ROUND(SUM(nbrCSaShoReq),3) NBRCSASHOREQ,
       ROUND(SUM(nbrCsAShoSucc),3) NBRCSASHOSUCC,
       ROUND(SUM(nbrCsAShoRLAddSucc),3) NBRCSASHORLADDSUCC,
       ROUND(SUM(nbrCsAShoRLDelSucc),3) NBRCSASHORLDELSUCC,
       ROUND(SUM(nbrCsVShoReq),3) NBRCSVSHOREQ,
       ROUND(SUM(nbrCSVShoSucc),3) NBRCSVSHOSUCC,
       ROUND(SUM(nbrCsVShoRLAddReq),3) NBRCSVSHORLADDREQ,
       ROUND(SUM(nbrCsVShoRLAddSucc),3) NBRCSVSHORLADDSUCC,
       ROUND(SUM(nbrCsvShoRLDelReq),3) NBRCSVSHORLDELREQ,
       ROUND(SUM(nbrCsVShoRLDelSucc),3) NBRCSVSHORLDELSUCC,
       ROUND(AVG(nbrShoActOcu4RLUe),3) NBRSHOACTOCU4RLUE,
       ROUND(SUM(nbrPsShoReq),3) NBRPSSHOREQ,
       ROUND(SUM(nbrCsaShoRLDelReq),3) NBRCSASHORLDELREQ,
       ROUND(SUM(nbrCsShoRLAddReq),3) NBRCSSHORLADDREQ,
       ROUND(SUM(nbrShoReq),3) NBRSHOREQ,
       ROUND(SUM(nbrShoSucc),3) NBRSHOSUCC,
       ROUND(AVG(nbrShoActOcu1RLUe),3) NBRSHOACTOCU1RLUE,
       ROUND(AVG(nbrShoActOcu2RLUe),3) NBRSHOACTOCU2RLUE,
       ROUND(AVG(nbrShoActOcu3RLUe),3) NBRSHOACTOCU3RLUE,
       ROUND(AVG(nbrShoActOcu5RLUe),3) NBRSHOACTOCU5RLUE,
       ROUND(AVG(nbrShoActOcu6RLUe),3) NBRSHOACTOCU6RLUE,
       ROUND(SUM(nbrShoRLAddReq),3) NBRSHORLADDREQ,
       ROUND(SUM(nbrShoRLAddSucc),3) NBRSHORLADDSUCC,
       ROUND(SUM(nbrShoRLDelReq),3) NBRSHORLDELREQ,
       ROUND(SUM(nbrShoRLDelSucc),3) NBRSHORLDELSUCC,
       ROUND(SUM(nbrCsShoRLDelSucc),3) NBRCSSHORLDELSUCC,
       ROUND(SUM(nbrCsAShoRLAddReq),3) NBRCSASHORLADDREQ,
       round(decode(sum((nvl(NBRSHOACTOCU1RLUE*1,0)+nvl(NBRSHOACTOCU2RLUE*2,0)+nvl(NBRSHOACTOCU3RLUE*3,0)+nvl(NBRSHOACTOCU4RLUE*4,0)+nvl(NBRSHOACTOCU5RLUE*5,0)+nvl(NBRSHOACTOCU6RLUE*6,0))),0,100, sum((nvl(NBRSHOACTOCU2RLUE*1,0)+nvl(NBRSHOACTOCU3RLUE*2,0)+nvl(NBRSHOACTOCU4RLUE*3,0)+nvl(NBRSHOACTOCU5RLUE*4,0)+nvl(NBRSHOACTOCU6RLUE*5,0)))/sum((nvl(NBRSHOACTOCU1RLUE*1,0)+nvl(NBRSHOACTOCU2RLUE*2,0)+nvl(NBRSHOACTOCU3RLUE*3,0)+nvl(NBRSHOACTOCU4RLUE*4,0)+nvl(NBRSHOACTOCU5RLUE*5,0)+nvl(NBRSHOACTOCU6RLUE*6,0)))*100),3) SOFTHO_RATE,
       ROUND(SUM(nbrCsUnnormReleRab),3) NBRCSUNNORMRELERAB,
       ROUND(SUM(nbrCsReleRab),3) NBRCSRELERAB,
       ROUND(SUM(nbrPsReleRab),3) NBRPSRELERAB,
       ROUND(SUM(nbrCsAUnnormReleRab),3) NBRCSAUNNORMRELERAB,
       ROUND(SUM(nbrCSAReleRab),3) NBRCSARELERAB,
       ROUND(SUM(nbrCsVReleRab),3) NBRCSVRELERAB,
       ROUND(SUM(nbrRrcUnnormRele),3) NBRRRCUNNORMRELE,
       ROUND(SUM(nbrHsupaRabDrop),3) NBRHSUPARABDROP,
       ROUND(SUM(nbrRrcReleReq),3) NBRRRCRELEREQ,
       ROUND(SUM(nbrUnnormReleRab),3) NBRUNNORMRELERAB,
       ROUND(SUM(nbrReleRab),3) NBRRELERAB,
       ROUND(SUM(nbrHsdpaRabDrop),3) NBRHSDPARABDROP,
       ROUND(SUM(nbrHsdpaRabRel),3) NBRHSDPARABREL,
       ROUND(SUM(nbrHsupaRabRel),3) NBRHSUPARABREL,
       ROUND(SUM(nbrPsUnnormReleRab),3) NBRPSUNNORMRELERAB,
       ROUND(SUM(nbrCsVUnnormReleRab),3) NBRCSVUNNORMRELERAB,
       ROUND(SUM(nbrIubRLSetupSucc),3) NBRIUBRLSETUPSUCC,
       ROUND(SUM(nbrIubRLSetupReq),3) NBRIUBRLSETUPREQ,
       ROUND(SUM(nbrIubRLAddReq),3) NBRIUBRLADDREQ,
       ROUND(SUM(nbrIubRLAddSucc),3) NBRIUBRLADDSUCC,
       ROUND(SUM(nbrIurRLSetupReq),3) NBRIURRLSETUPREQ,
       ROUND(SUM(nbrIurRLSetupSucc),3) NBRIURRLSETUPSUCC,
       ROUND(SUM(nbrIurRLAddReq),3) NBRIURRLADDREQ,
       ROUND(SUM(nbrIurRLAddSucc),3) NBRIURRLADDSUCC,
       ROUND(SUM(nbrPagingSendFail),3) NBRPAGINGSENDFAIL,
       ROUND(SUM(nbrPagingSendSucc),3) NBRPAGINGSENDSUCC,
       ROUND(SUM(nbrCsRabAssignReq),3) NBRCSRABASSIGNREQ,
       ROUND(SUM(nbrCsRabModifyReq),3) NBRCSRABMODIFYREQ,
       ROUND(SUM(nbrCsRabModifySucc),3) NBRCSRABMODIFYSUCC,
       ROUND(SUM(nbrCsRabAssignCong),3) NBRCSRABASSIGNCONG,
       ROUND(SUM(nbrPsRabAssignReq),3) NBRPSRABASSIGNREQ,
       ROUND(SUM(nbrPsRabAssignSucc),3) NBRPSRABASSIGNSUCC,
       ROUND(SUM(nbrPsRabModifyReq),3) NBRPSRABMODIFYREQ,
       ROUND(SUM(nbrPsRabModifySucc),3) NBRPSRABMODIFYSUCC,
       ROUND(SUM(nbrPsRabAssignCong),3) NBRPSRABASSIGNCONG,
       ROUND(SUM(nbrCsARabAssignReq),3) NBRCSARABASSIGNREQ,
       ROUND(SUM(nbrCsARabAssignSucc),3) NBRCSARABASSIGNSUCC,
       ROUND(SUM(nbrCSARabAssignCong),3) NBRCSARABASSIGNCONG,
       ROUND(SUM(nbrCsVRabAssignReq),3) NBRCSVRABASSIGNREQ,
       ROUND(SUM(nbrCsVRabAssignSucc),3) NBRCSVRABASSIGNSUCC,
       ROUND(SUM(nbrCSVRabAssignCong),3) NBRCSVRABASSIGNCONG,
       ROUND(SUM(nbrRabAssignReq),3) NBRRABASSIGNREQ,
       ROUND(SUM(nbrRabAssignSucc),3) NBRRABASSIGNSUCC,
       ROUND(SUM(nbrRabModifyReq),3) NBRRABMODIFYREQ,
       ROUND(SUM(nbrRabModifySucc),3) NBRRABMODIFYSUCC,
       ROUND(SUM(nbrRabAssignCong),3) NBRRABASSIGNCONG,
       ROUND(SUM(nbrRabAssignTcpCong),3) NBRRABASSIGNTCPCONG,
       ROUND(SUM(nbrRabAssignUpCeCong),3) NBRRABASSIGNUPCECONG,
       ROUND(SUM(nbrRabAssignDownCeCong),3) NBRRABASSIGNDOWNCECONG,
       ROUND(SUM(nbrRabAssignDownIubCong),3) NBRRABASSIGNDOWNIUBCONG,
       ROUND(SUM(nbrHsdpaRabAssignReq),3) NBRHSDPARABASSIGNREQ,
       ROUND(SUM(nbrHsdpaRabAssignSucc),3) NBRHSDPARABASSIGNSUCC,
       ROUND(SUM(nbrHsupaRabAssignReq),3) NBRHSUPARABASSIGNREQ,
       ROUND(SUM(nbrHsupaRabAssignSucc),3) NBRHSUPARABASSIGNSUCC,
       ROUND(SUM(nbrCsRabAssignSucc),3) NBRCSRABASSIGNSUCC,
       ROUND(SUM(nbrRabAssignUpIubCong),3) NBRRABASSIGNUPIUBCONG,
       ROUND(SUM(nbrRabAssignDownSfCong),3) NBRRABASSIGNDOWNSFCONG,
       ROUND(SUM(nbrRrcConnReq),3) NBRRRCCONNREQ,
       ROUND(SUM(nbrRrcConnSucc),3) NBRRRCCONNSUCC
 from perf_bts_w_h p,ne_bts_w ne
where p.ne_bts_id=ne.ne_bts_id

  and  p.start_time>=to_date('%%Y-%%M-%%D %%H','YYYY-MM-DD HH24')  and  p.start_time  < to_date('%%Y-%%M-%%D %%H','YYYY-MM-DD HH24')+1/24

group by p.BTS_NAME,ne.bsc_id || '_' ||ne.bts_id,ne.EXT_OID

]]>


        </sql>
			</mapping>
			
			
						<mapping name="WXWYPM09_%%Y%%M%%D%%H%%m_001.data" templet="山东联通综合分析系统性能数据CELL-3G.ftl">

				<sql>


<![CDATA[
select
p.start_time,
cfg.prov_code,
p.CITY_NAME,
p.ADM_AREA,
p.VENDORNAME,
ne.ne_msc_id,
ne.msc_name,
ne.sgsn,
ne.city_id || '_' || ne.bsc_id,
ne.bsc_id || '_' || ne.bts_id,
ne.LAC,
ne.CI,
ne.bsc_id || '_' || ne.ci,
p.cell_name,
round(SUM(HSUPARLCUPTRAFFIC)/(SUM(HSDPA_TRANSTIME)+0.0000001),3) HSDPA_SINGLE_AVGRATE,
sum(mr.TOTALNUM) TOTALNUM,
SUM(mr.TOTALNUM_E) TOTALNUM_E,
SUM(mr.DOWNCOVERGOOD_NUM) DOWNCOVERGOOD_NUM,
SUM(mr.DOWNCOVERGOOD_NUM_E) DOWNCOVERGOOD_NUM_E,
SUM(mr.DOWNQUALIITYGOOD_NUM) DOWNQUALIITYGOOD_NUM,
SUM(mr.DOWNQUALIITYGOOD_NUM_E) DOWNQUALIITYGOOD_NUM_E,
ROUND(SUM(mr.DOWNQUALIITYFLUCTVALUE),4) DOWNQUALIITYFLUCTVALUE,
ROUND(SUM(mr.DOWNQUALIITYFLUCTVALUE_E),4) DOWNQUALIITYFLUCTVALUE_E,
ROUND(SUM(mr.DOWNQUALIITYFLUCTVALUE_D),4) DOWNQUALIITYFLUCTVALUE_D,
SUM(mr.DOWNRISE_NUM) DOWNRISE_NUM,
SUM(mr.DOWNRISE_NUM_E) DOWNRISE_NUM_E,
SUM(mr.PILOT_POLLTION) PILOT_POLLTION,
SUM(mr.PILOT_POLLTION_E) PILOT_POLLTION_E,
ROUND(AVG(RTWPUPLIFT),3) RTWPUPLIFT,
ROUND(AVG(P_CELL_TRX_POW),3) P_CELL_TRX_POW,
ROUND(AVG(CQIAVGVAULE_THROUGHPUT),3) CQIAVGVAULE_THROUGHPUT,
SUM(mr.DOWNCOVERLEVEL_NUM) DOWNCOVERLEVEL_NUM,
SUM(mr.UPCOVERGOOD_NUM) UPCOVERGOOD_NUM,
SUM(mr.IMBALANCE_NUM) IMBALANCE_NUM,
SUM(mr.QUALIITYGOOD_NUM) QUALIITYGOOD_NUM,
SUM(mr.DOWNCOVERLEVEL_NUM_E) DOWNCOVERLEVEL_NUM_E,
SUM(mr.UPCOVERGOOD_NUM_E) UPCOVERGOOD_NUM_E,
SUM(mr.IMBALANCE_NUM_E) IMBALANCE_NUM_E,
SUM(mr.QUALIITYGOOD_NUM_E) QUALIITYGOOD_NUM_E,
ROUND(MAX(MAXCQIAVGVAULE_THROUGHPUT),3) MAXCQIAVGVAULE_THROUGHPUT,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.DOWNCOVERGOOD_NUM)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) DOWNCOVERGOOD_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.DOWNCOVERGOOD_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) DOWNCOVERGOOD_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.DOWNCOVERGOOD_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) DOWNCOVERGOOD_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.DOWNCOVERLEVEL_NUM)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) DOWNCOVERLEVEL_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.DOWNCOVERLEVEL_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) DOWNCOVERLEVEL_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.DOWNCOVERLEVEL_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) DOWNCOVERLEVEL_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.IMBALANCE_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) UPCOVERGOOD_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.UPCOVERGOOD_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) UPCOVERGOOD_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.UPCOVERGOOD_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) UPCOVERGOOD_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.IMBALANCE_NUM)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) IMBALANCE_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.IMBALANCE_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) IMBALANCE_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.IMBALANCE_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) IMBALANCE_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.DOWNQUALIITYGOOD_NUM)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) DOWNQUALIITYGOOD_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.DOWNQUALIITYGOOD_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) DOWNQUALIITYGOOD_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.DOWNQUALIITYGOOD_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) DOWNQUALIITYGOOD_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.DOWNRISE_NUM)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) DOWNRISE_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.DOWNRISE_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) DOWNRISE_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.DOWNRISE_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) DOWNRISE_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.QUALIITYGOOD_NUM)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) QUALIITYGOOD_NUM_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.QUALIITYGOOD_NUM_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) QUALIITYGOOD_NUM_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(mr.QUALIITYGOOD_NUM_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) QUALIITYGOOD_NUM_D_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM),0,0,  SUM(mr.PILOT_POLLTION)/SUM(mr.INTRAFREQ_MR_NUM)*100),4) PILOT_POLLTION_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_E),0,0,SUM(mr.PILOT_POLLTION_E)/SUM(mr.INTRAFREQ_MR_NUM_E)*100),4) PILOT_POLLTION_E_PER,
ROUND(DECODE(SUM(mr.INTRAFREQ_MR_NUM_D),0,0,SUM(PILOT_POLLTION_D)/SUM(mr.INTRAFREQ_MR_NUM_D)*100),4) PILOT_POLLTION_D_PER,
decode(AVG(MEANCELLTCP)*AVG(NVL(P_CELL_TRX_POW,43)),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(NVL(P_CELL_TRX_POW,43))/10)*100,3)) TCPUSAGECELLRATIO,
ROUND(AVG(CQIAVGVAULE),3) CQIAVGVAULE,
SUM(CQI0) CQI0,
SUM(CQI1) CQI1,
SUM(CQI2) CQI2,
SUM(CQI3) CQI3,
SUM(CQI4) CQI4,
SUM(CQI5) CQI5,
SUM(CQI6) CQI6,
SUM(CQI7) CQI7,
SUM(CQI8) CQI8,
SUM(CQI9) CQI9,
SUM(CQI10) CQI10,
SUM(CQI11) CQI11,
SUM(CQI12) CQI12,
SUM(CQI13) CQI13,
SUM(CQI14) CQI14,
SUM(CQI15) CQI15,
SUM(CQI16) CQI16,
SUM(CQI17) CQI17,
SUM(CQI18) CQI18,
SUM(CQI19) CQI19,
SUM(CQI20) CQI20,
SUM(CQI21) CQI21,
SUM(CQI22) CQI22,
SUM(CQI23) CQI23,
SUM(CQI24) CQI24,
SUM(CQI25) CQI25,
SUM(CQI26) CQI26,
SUM(CQI27) CQI27,
SUM(CQI28) CQI28,
SUM(CQI29) CQI29,
SUM(CQI30) CQI30,
SUM(DOWNCOVERGOOD_NUM_D) DOWNCOVERGOOD_NUM_D,
SUM(DOWNQUALIITYGOOD_NUM_D) DOWNQUALIITYGOOD_NUM_D,
SUM(DOWNRISE_NUM_D) DOWNRISE_NUM_D,
SUM(mr.TOTALNUM-mr.TOTALNUM_E) TOTALNUM_D,
SUM(DOWNCOVERLEVEL_NUM_D) DOWNCOVERLEVEL_NUM_D,
SUM(UPCOVERGOOD_NUM_D) UPCOVERGOOD_NUM_D,
SUM(IMBALANCE_NUM_D) IMBALANCE_NUM_D,
SUM(QUALIITYGOOD_NUM_D) QUALIITYGOOD_NUM_D,
SUM(PILOT_POLLTION_D) PILOT_POLLTION_D,
SUM(CSATERLTRAFFIC) CSATERLTRAFFIC,
SUM(NBRCONVRRCCONNREQ) NBRCONVRRCCONNREQ,
SUM(NBRSTRMRRCCONNREQ) NBRSTRMRRCCONNREQ,
SUM(NBRBGRDRRCCONNREQ) NBRBGRDRRCCONNREQ,
SUM(NBRINTACTRRCCONNREQ) NBRINTACTRRCCONNREQ,
SUM(NBRCONVRRCCONNSUCC) NBRCONVRRCCONNSUCC,
SUM(NBRSTRMRRCCONNSUCC) NBRSTRMRRCCONNSUCC,
SUM(NBRBGRDRRCCONNSUCC) NBRBGRDRRCCONNSUCC,
SUM(NBRINTACTRRCCONNSUCC) NBRINTACTRRCCONNSUCC,
SUM(NBRCSINTRAFREQHHOOUTREQ) NBRCSINTRAFREQHHOOUTREQ,
SUM(NBRPSINTRAFREQHHOOUTREQ) NBRPSINTRAFREQHHOOUTREQ,
SUM(NBRCSINTRAFREQHHOOUTSUCC) NBRCSINTRAFREQHHOOUTSUCC,
SUM(NBRPSINTRAFREQHHOOUTSUCC) NBRPSINTRAFREQHHOOUTSUCC,
SUM(NBRCSINTERFREQHHOOUTREQ) NBRCSINTERFREQHHOOUTREQ,
SUM(NBRPSINTERFREQHHOOUTREQ) NBRPSINTERFREQHHOOUTREQ,
SUM(NBRCSINTERFREQHHOOUTSUCC) NBRCSINTERFREQHHOOUTSUCC,
SUM(NBRPSINTERFREQHHOOUTSUCC) NBRPSINTERFREQHHOOUTSUCC,
round(AVG(RLCCSUPAVERRATE),3) RLCCSUPAVERRATE,
round(AVG(RLCPSUPAVERRATE),3) RLCPSUPAVERRATE,
round(AVG(RLCCSATUPAVERRATE),3) RLCCSATUPAVERRATE,
round(AVG(RLCCSVTUPAVERRATE),3) RLCCSVTUPAVERRATE,
round(AVG(RLCCSDOWNAVERAVGRATE),3) RLCCSDOWNAVERAVGRATE,
round(AVG(RLCPSDOWNAVERAVGRATE),3) RLCPSDOWNAVERAVGRATE,
round(AVG(RLCCSATDOWNAVERRATE),3) RLCCSATDOWNAVERRATE,
round(AVG(RLCCSVTDOWNAVERRATE),3) RLCCSVTDOWNAVERRATE,
SUM(NBRRRCCONNREQ_TYPE) NBRRRCCONNREQ_TYPE,
SUM(NBRRRCCONNSUCC_TYPE) NBRRRCCONNSUCC_TYPE,
SUM(NBRR99RABASSIGNREQ) NBRR99RABASSIGNREQ,
SUM(NBRR99RABASSIGNSUC) NBRR99RABASSIGNSUC,
SUM(NBRR99RABASSIGNFAIL) NBRR99RABASSIGNFAIL,
SUM(NBRPSR99DLBUSYTRAFFIC) NBRPSR99DLBUSYTRAFFIC,
SUM(NBRPSR99ULBUSYTRAFFIC) NBRPSR99ULBUSYTRAFFIC,
round(AVG(RLCPSR99DOWNAVERAVGRATE),3) RLCPSR99DOWNAVERAVGRATE,
round(AVG(RLCPSR99UPAVERAVGRATE),3) RLCPSR99UPAVERAVGRATE,
ROUND( SUM(NBRRABASSIGNTCPCONG)/(SUM(NBRRABASSIGNREQ ) + 0.0000001)*100,3) NBRRABASSIGNTCPCONGRATE,
ROUND( SUM(NBRRABASSIGNDOWNSFCONG)/((SUM(NBRRABASSIGNREQ) ) + 0.0000001)*100,3) NBRRABASSIGNDOWNSFCONGRATE,
ROUND( (SUM(NBRRABASSIGNUPCECONG+NBRRABASSIGNDOWNCECONG))/((SUM(NBRRABASSIGNREQ) ) + 0.0000001)*100,3) NBRRABASSIGNCECONGRATE,
case when SUM(NBRR99RABASSIGNFAIL)  > SUM(NBRR99RABASSIGNSUC) then 100  else ROUND( SUM(NBRR99RABASSIGNFAIL)/((SUM(NBRR99RABASSIGNSUC) ) + 0.0000001)*100,3)  end  NBRR99RABASSIGNFAILRATE,
ROUND( SUM(NBRRRCCONNSUCC_TYPE)/((SUM(NBRRRCCONNREQ_TYPE) ) + 0.0000001)*100,3) NBRRRCCONN_TYPERATE,
ROUND( SUM(NBRR99RABASSIGNSUC)/((SUM(NBRR99RABASSIGNREQ) ) + 0.0000001)*100,3) NBRR99RABASSIGNRATE,
decode(AVG(MEANCELLTCP)*AVG(NVL(P_CELL_TRX_POW,43)),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(NVL(P_CELL_TRX_POW,43))/10)*100,3)) MEANCELLTCPAVGRATE,
ROUND(SUM(NBRRABASSIGNUPIUBCONG+NBRRABASSIGNDOWNIUBCONG)/SUM(NBRRABASSIGNREQ+0.0000001)*100,3) NBRRABASSIGNIUBCONGRATE,
SUM(CSVTERLTRAFFIC) CSVTERLTRAFFIC,
SUM(HSDPA_TRANSTIME) HSDPA_TRANSTIME,
round(AVG(HSDPA_SINGLE_THROUGHPUT),3) HSDPA_SINGLE_THROUGHPUT,
round(AVG(NOISE_FLOOR),3) NOISE_FLOOR,
decode(AVG(MEANCELLTCP)*AVG(P_CELL_TRX_POW),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(P_CELL_TRX_POW)/10)*100,3)) DOWNLINKLOAD,
CASE WHEN MAX(MEANCELLRWTP-NOISE_FLOOR)>=1000 THEN 1 ELSE round  ((1-1/(POWER(10,(CASE  WHEN  MAX(MEANCELLRWTP-NOISE_FLOOR)<=0  THEN 0 ELSE MAX(MEANCELLRWTP-NOISE_FLOOR) END)/10)))*100,3) END UPLINKLOAD,
CASE  WHEN  MAX(MEANCELLRWTP-NOISE_FLOOR)<=0  THEN 0 ELSE MAX(MEANCELLRWTP-NOISE_FLOOR) END NOISERISE,
ROUND(avg(MAXR99CELLFREQTCP)/max(MEANR99CELLFREQTCP+0.0000001)*100,3) MEANR99CELLTCPAVGRATE,
round(AVG(DROP3G),4) DROP3G,
round(sum(nbrcsuser),3) NBRCSUSER,
ROUND(SUM(nbrrefthroughput),3) NBRREFTHROUGHPUT,
DECODE(SUM(NBR2GTO3GHOINREQ),0,100,ROUND( (SUM(NBR2GTO3GHOINSUCC)/((SUM(NBR2GTO3GHOINREQ) ) ))*100,3)) NBR2GTO3GHOINSUCCRATIO,
CASE  WHEN  SUM(NBR3GTO2GHOOUTSUCC)>SUM(NBR3GTO2GHOOUTREQ) THEN 100 ELSE  DECODE(SUM(NBR3GTO2GHOOUTREQ),0,100,ROUND( (SUM(NBR3GTO2GHOOUTSUCC)/((SUM(NBR3GTO2GHOOUTREQ) ) ))*100,3))  END NBR3GTO2GHOOUTSUCCRAIO,
DECODE(SUM(NBRCELLUPDREQ),0,100,ROUND( (SUM(NBRCELLUPDSUCC)/((SUM(NBRCELLUPDREQ) ) ))*100,3)) NBRCELLUPDSUCCRATIO,
DECODE(SUM(NBRCNINTERRNCIAFHHOOUTREQ),0,100,ROUND( (SUM(NBRCNINTERRNCIAFHHOOUTSUCC)/((SUM(NBRCNINTERRNCIAFHHOOUTREQ) ) ))*100,3)) NBRCNINTERRNCIFHOSUCCRATIO,
DECODE(SUM(NBRCNINTERRNCIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRIURHIERIEFHHOOUTSUCC)/((SUM(NBRCNINTERRNCIEFHHOOUTREQ) ) ))*100,3)) NBRCNIRIFHOSUCCRATIO,
DECODE(SUM(NBRCS2GTO3GHOINREQ),0,100,ROUND( (SUM(NBRCS2GTO3GHOINSUCC)/((SUM(NBRCS2GTO3GHOINREQ) ) ))*100,3)) NBRCS2GTO3GHOINSUCCRATIO,
CASE  WHEN  SUM(nbrCs3gto2gHoOutSucc)>SUM(nbrCs3gto2gHoOutReq) THEN 100 ELSE  DECODE(SUM(nbrCs3gto2gHoOutReq), 0, 100, ROUND(SUM(nbrCs3gto2gHoOutSucc) / SUM(nbrCs3gto2gHoOutReq)*100,3))  END NBRCS3GTO2GHOOUTSUCCRAIO,
DECODE(SUM(NBRCSARELERAB),0,0,ROUND( (SUM(NBRCSAUNNORMRELERAB)/((SUM(NBRCSARELERAB) ) ))*100,3)) NBRCSAUNNORMRELERATIO,
DECODE(SUM(NBRCSINTRANODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTRANODEBIEFHHOOUTSUCC)/((SUM(NBRCSINTRANODEBIEFHHOOUTREQ) ) ))*100,3)) NBRCSINIFHOSUCCRATIO,
DECODE(SUM(NBRCSIERBINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTERRNCBIAFHHOOUTSUCC)/((SUM(NBRCSIERBINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRCSINTERRNCBIFHOSUCCRATE,
DECODE(SUM(NBRCSIERBINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTERRNCBIEFHHOOUTSUCC)/((SUM(NBRCSIERBINTERFREQHHOOUTREQ) ) ))*100,3)) NBRCSIRIFHOSUCCRATIO,
DECODE(SUM(NBRCSVRELERAB),0,0,ROUND( (SUM(NBRCSVUNNORMRELERAB)/((SUM(NBRCSVRELERAB) ) ))*100,3)) NBRCSKUNNORMRELERATIO,
DECODE(SUM(NBRCSRABMODIFYREQ),0,100,ROUND( (SUM(NBRCSRABMODIFYSUCC)/((SUM(NBRCSRABMODIFYREQ) ) ))*100,3)) NBRCSRABMODIFYSUCCRATIO,
DECODE(SUM(NBRCSINTERNODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRCSINTERNODEBIEFHHOOUTSUCC)/((SUM(NBRCSINTERNODEBIEFHHOOUTREQ) ) ))*100,3)) NBRCSRINIFHOSUCCRATIO,
DECODE(SUM(NBRCSSHORLADDREQ),0,100,ROUND( (SUM(NBRCSSHORLADDSUCC)/((SUM(NBRCSSHORLADDREQ) ) ))*100,3)) NBRCSSHORLADDSUCCRATIO,
DECODE(SUM(NBRCSSHOREQ),0,100,ROUND( (SUM(NBRCSSHOSUCC)/((SUM(NBRCSSHOREQ) ) ))*100,3)) NBRCSSHOSUCCRATIO,
DECODE(SUM(NBRCSRELERAB),0,0,ROUND( (SUM(NBRCSUNNORMRELERAB)/((SUM(NBRCSRELERAB) ) ))*100,3)) NBRCSUNNORMRELERATIO,
DECODE(SUM(NBRDCHTOEDCHREQ),0,100,ROUND( (SUM(NBRDCHTOEDCHSUCC)/((SUM(NBRDCHTOEDCHREQ) ) ))*100,3)) NBRDCHTOEDCHSUCCRATIO,
DECODE(SUM(NBRDCHTOHSDSCHREQ),0,100,ROUND( (SUM(NBRDCHTOHSDSCHSUCC)/((SUM(NBRDCHTOHSDSCHREQ) ) ))*100,3)) NBRDCHTOHSDSCHSUCCRATIO,
DECODE(SUM(NBREDCHTORACHREQ),0,100,ROUND( (SUM(NBREDCHTORACHSUCC)/((SUM(NBREDCHTORACHREQ) ) ))*100,3)) NBREDCHTORACHSUCCRATIO,
DECODE(SUM(NBRFACHTOHSDSCHREQ),0,100,ROUND( (SUM(NBRFACHTOHSDSCHSUCC)/((SUM(NBRFACHTOHSDSCHREQ) ) ))*100,3)) NBRFACHTOHSDSCHSUCCRATIO,
DECODE(SUM(NBRHSDPACELLCHANGEREQ),0,100,ROUND( (SUM(NBRHSDPACELLCHANGESUCC)/((SUM(NBRHSDPACELLCHANGEREQ) ) ))*100,3)) NBRHSDPACELLCHANGESUCCRATIO,
DECODE(SUM(NBRHSDPARABASSIGNREQ),0,100,ROUND( (SUM(NBRHSDPARABASSIGNSUCC)/((SUM(NBRHSDPARABASSIGNREQ) ) ))*100,3)) NBRHSDPARABASSIGNSUCCRATIO,
DECODE(SUM(NBRHSDSCHTODCHREQ),0,100,ROUND( (SUM(NBRHSDSCHTODCHSUSS)/((SUM(NBRHSDSCHTODCHREQ) ) ))*100,3)) NBRHSDSCHTODCHSUSSRATIO,
DECODE(SUM(NBRHSDSCHTOFACHREQ),0,100,ROUND( (SUM(NBRHSDSCHTOFACHSUCC)/((SUM(NBRHSDSCHTOFACHREQ) ) ))*100,3)) NBRHSDSCHTOFACHSUCCRATIO,
DECODE(SUM(NBRHSUPACELLCHANGEREQ),0,100,ROUND( (SUM(NBRHSUPACELLCHANGESUCC)/((SUM(NBRHSUPACELLCHANGEREQ) ) ))*100,3)) NBRHSUPACELLCHANGESUCCRATIO,
DECODE(SUM(NBRHSUPARABASSIGNREQ),0,100,ROUND( (SUM(NBRHSUPARABASSIGNSUCC)/((SUM(NBRHSUPARABASSIGNREQ) ) ))*100,3)) NBRHSUPARABASSIGNSUCCRATIO,
DECODE(SUM((nvl(NBREDCHTORACHSUCC,0)+NRBEDCHTODCHSUCC+NBRHSUPARABREL)),0,0,ROUND( (SUM(NBRHSUPARABDROP)/((SUM((nvl(NBREDCHTORACHSUCC,0)+NRBEDCHTODCHSUCC+NBRHSUPARABREL)) ) ))*100,3)) NBRHSUPARABDROPRATIO,
DECODE(SUM(NBRINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTRAFREQHHOOUTSUCC)/((SUM(NBRINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRIFHOSUCCRATIO,
DECODE(SUM(NBRINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERFREQHHOOUTSUCC)/((SUM(NBRINTERFREQHHOOUTREQ) ) ))*100,3)) NBRAIFHOSUCCRATIO,
DECODE(SUM(NBRIURINTERRNCIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRIURINTERRNCIEFHHOOUTSUCC)/((SUM(NBRIURINTERRNCIEFHHOOUTREQ) ) ))*100,3)) NBRIIRIFHOSUCCRATIO,
DECODE(SUM(NBRINTRANODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRINTRANODEBIEFHHOOUTSUCC)/((SUM(NBRINTRANODEBIEFHHOOUTREQ) ) ))*100,3)) NBRINIFHOSUCCRATIO,
DECODE(SUM(NBRIERBINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERRNCBIAFHHOOUTSUCC)/((SUM(NBRIERBINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRINTERRNCBIFHOSUCCRATE,
DECODE(SUM(NBRIERBINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERRNCBIEFHHOOUTSUCC)/((SUM(NBRIERBINTERFREQHHOOUTREQ) ) ))*100,3)) NBRIRIFHOSUCCRATIO,
DECODE(SUM(NBRIUBRLADDREQ),0,100,ROUND( (SUM(NBRIUBRLADDSUCC)/((SUM(NBRIUBRLADDREQ) ) ))*100,3)) NBRIUBRLADDSUCCRATIO,
DECODE(SUM(NBRIUBRLSETUPREQ),0,100,ROUND( (SUM(NBRIUBRLSETUPSUCC)/((SUM(NBRIUBRLSETUPREQ) ) ))*100,3)) NBRIUBRLSETUPSUCCRATIO,
DECODE(SUM(NBRIURINTERRNCIAFHHOOUTREQ),0,100,ROUND( (SUM(NBRIURINTERRNCIAFHHOOUTSUCC)/((SUM(NBRIURINTERRNCIAFHHOOUTREQ) ) ))*100,3)) NBRIURINTERRNCIFHOSUCCRATIO,
DECODE(SUM(NBRIURRLADDREQ),0,100,ROUND( (SUM(NBRIURRLADDSUCC)/((SUM(NBRIURRLADDREQ) ) ))*100,3)) NBRIURRLADDSUCCRATIO,
DECODE(SUM(NBRIURRLSETUPREQ),0,100,ROUND( (SUM(NBRIURRLSETUPSUCC)/((SUM(NBRIURRLSETUPREQ) ) ))*100,3)) NBRIURRLSETUPSUCCRATIO,
DECODE(SUM(NBRPS2GTO3GHOINREQ),0,100,ROUND( (SUM(NBRPS2GTO3GHOINSUCC)/((SUM(NBRPS2GTO3GHOINREQ) ) ))*100,3)) NBRPS2GTO3GHOINSUCCRATIO,
CASE  WHEN  SUM(NBRPS3GTO2GHOOUTSUCC)>SUM(NBRPS3GTO2GHOOUTREQ) THEN 100 ELSE  DECODE(SUM(NBRPS3GTO2GHOOUTREQ),0,100,ROUND( (SUM(NBRPS3GTO2GHOOUTSUCC)/((SUM(NBRPS3GTO2GHOOUTREQ) ) ))*100,3))  END NBRPS3GTO2GHOOUTSUCCRAIO,
DECODE(SUM(NBRPSINTRANODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTRANODEBIEFHHOOUTSUCC)/((SUM(NBRPSINTRANODEBIEFHHOOUTREQ) ) ))*100,3)) NBRPSINIFHOSUCCRATIO,
DECODE(SUM(NBRPSIERBINTRAFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTERRNCBIAFHHOOUTSUCC)/((SUM(NBRPSIERBINTRAFREQHHOOUTREQ) ) ))*100,3)) NBRPSINTERRNCBIFHOSUCCRATE,
DECODE(SUM(NBRPSIERBINTERFREQHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTERRNCBIEFHHOOUTSUCC)/((SUM(NBRPSIERBINTERFREQHHOOUTREQ) ) ))*100,3)) NBRPSIRIFHOSUCCRATIO,
DECODE(SUM(NBRPSRABMODIFYREQ),0,100,ROUND( (SUM(NBRPSRABMODIFYSUCC)/((SUM(NBRPSRABMODIFYREQ) ) ))*100,3)) NBRPSRABMODIFYSUCCRATIO,
DECODE(SUM(NBRPSINTERNODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRPSINTERNODEBIEFHHOOUTSUCC)/((SUM(NBRPSINTERNODEBIEFHHOOUTREQ) ) ))*100,3)) NBRPSRINIFHOSUCCRATIO,
DECODE(SUM(NBRPSSHORLADDREQ),0,100,ROUND( (SUM(NBRPSSHORLADDSUCC)/((SUM(NBRPSSHORLADDREQ) ) ))*100,3)) NBRPSSHORLADDSUCCRATIO,
DECODE(SUM(NBRPSSHOREQ),0,100,ROUND( (SUM(NBRPSSHOSUCC)/((SUM(NBRPSSHOREQ) ) ))*100,3)) NBRPSSHOSUCCRATIO,
DECODE(SUM(NBRPSRELERAB),0,0,ROUND( (SUM(NBRPSUNNORMRELERAB)/((SUM(NBRPSRELERAB) ) ))*100,3)) NBRPSUNNORMRELERATIO,
DECODE(SUM(NBRRABASSIGNREQ),0,0,ROUND( (SUM(NBRRABASSIGNCONG)/((SUM(NBRRABASSIGNREQ) ) ))*100,3)) NBRRABASSIGNCONGRATIO,
DECODE(SUM(NBRRABMODIFYREQ),0,100,ROUND( (SUM(NBRRABMODIFYSUCC)/((SUM(NBRRABMODIFYREQ) ) ))*100,3)) NBRRABMODIFYSUCCRATIO,
DECODE(SUM(NBRRACHTOEDCHREQ),0,100,ROUND( (SUM(NBRRACHTOEDCHSUCC)/((SUM(NBRRACHTOEDCHREQ) ) ))*100,3)) NBRRACHTOEDCHSUCCRATIO,
DECODE(SUM(NBRINTERNODEBIEFHHOOUTREQ),0,100,ROUND( (SUM(NBRINTERNODEBIEFHHOOUTSUCC)/((SUM(NBRINTERNODEBIEFHHOOUTREQ) ) ))*100,3)) NBRRINIFHOSUCCRATIO,
DECODE(SUM(NBRRRCRELEREQ),0,0,ROUND( (SUM(NBRRRCUNNORMRELE)/((SUM(NBRRRCRELEREQ) ) ))*100,3)) NBRRRCUNNORMRELERATIO,
DECODE(SUM(NBRSHORLADDREQ),0,100,ROUND( (SUM(NBRSHORLADDSUCC)/((SUM(NBRSHORLADDREQ) ) ))*100,3)) NBRSHORLADDSUCCRATIO,
DECODE(SUM(NBRSHOREQ),0,100,ROUND( (SUM(NBRSHOSUCC)/((SUM(NBRSHOREQ) ) ))*100,3)) NBRSHOSUCCRATIO,
DECODE(SUM(NBRRELERAB),0,0,ROUND( (SUM(NBRUNNORMRELERAB)/((SUM(NBRRELERAB) ) ))*100,3)) NBRUNNORMRELERATIO,
DECODE(SUM(NBRURAUPDREQ),0,100,ROUND( (SUM(NBRURAUPDSUCC)/((SUM(NBRURAUPDREQ) ) ))*100,3)) NBRURAUPDSUCCRATIO,
DECODE(SUM(NRBEDCHTODCHREQ),0,100,ROUND( (SUM(NRBEDCHTODCHSUCC)/((SUM(NRBEDCHTODCHREQ) ) ))*100,3)) NRBEDCHTODCHSUCCRATIO,
DECODE(SUM(NBRPSRLCDOWNTRANBLOCK),0,0,ROUND( (SUM(NBRPSRLCDOWNRETRANBLOCK)/((SUM(NBRPSRLCDOWNTRANBLOCK) ) ))*100,3)) PSRLCDOWNRETRANRATIO,
CASE WHEN SUM(NBRRABASSIGNSUCC) >SUM(NBRRABASSIGNREQ) THEN 100 ELSE DECODE(SUM(NBRRABASSIGNREQ) ,0,100,ROUND((SUM(NBRRABASSIGNSUCC)/((SUM(NBRRABASSIGNREQ) ) ))*100,3)) END   RABASSIGNSUCCRATIO,
DECODE(SUM(NBRCSARABASSIGNREQ),0,100,ROUND( (SUM(NBRCSARABASSIGNSUCC)/((SUM(NBRCSARABASSIGNREQ) ) ))*100,3)) RABCSAASSIGNSUCCRATIO,
DECODE(SUM(NBRCSRABASSIGNREQ),0,100,ROUND( (SUM(NBRCSRABASSIGNSUCC)/((SUM(NBRCSRABASSIGNREQ) ) ))*100,3)) RABCSASSIGNSUCCRATIO,
DECODE(SUM(NBRCSVRABASSIGNREQ),0,100,ROUND( (SUM(NBRCSVRABASSIGNSUCC)/((SUM(NBRCSVRABASSIGNREQ) ) ))*100,3)) RABCSKASSIGNSUCCRATIO,
DECODE(SUM(NBRPSRABASSIGNREQ),0,100,ROUND( (SUM(NBRPSRABASSIGNSUCC)/((SUM(NBRPSRABASSIGNREQ) ) ))*100,3)) RABPSASSIGNSUCCRATIO,
CASE WHEN DECODE(SUM(NBRRRCCONNREQ),0,100,ROUND( (SUM(NBRRRCCONNSUCC)/((SUM(NBRRRCCONNREQ) ) ))*100,3)) >100  THEN 100  ELSE DECODE(SUM(NBRRRCCONNREQ),0,100,ROUND( (SUM(NBRRRCCONNSUCC)/((SUM(NBRRRCCONNREQ) ) ))*100,3))   END RRCCONNSUCCRATIO,
DECODE(SUM(NBRCS3GTO2GPREHOOUTREQ),0,100,ROUND(SUM(NBRCS3GTO2GPREHOOUTREQ-NBRCS3GTO2GPREHOOUTFAIL)/SUM(((NBRCS3GTO2GPREHOOUTREQ)) ) * 100,3)) NBRCS3GTO2GPREHOOUTSUCCRAIO,
ROUND((SUM(NBRHSDPARABDROP)/(SUM(NBRHSDPARABREL+NBRHSDSCHTODCHSUSS+NBRHSDSCHTOFACHSUCC) + 0.0000001))* 100,3) NBRHSDPARABDROPRATIO,
CASE WHEN ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRRABASSIGNREQ),0,1,SUM(NBRRABASSIGNSUCC)/SUM(NBRRABASSIGNREQ))*100 ,3)  >100  THEN 100  ELSE ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRRABASSIGNREQ),0,1,SUM(NBRRABASSIGNSUCC)/SUM(NBRRABASSIGNREQ))*100 ,3) END RADIOCONNRATIO,
CASE WHEN ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRCSRABASSIGNREQ),0,1,SUM(NBRCSRABASSIGNSUCC)/SUM(NBRCSRABASSIGNREQ))*100 ,3) >100  THEN 100  ELSE ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRCSRABASSIGNREQ),0,1,SUM(NBRCSRABASSIGNSUCC)/SUM(NBRCSRABASSIGNREQ))*100 ,3)  END RADIOCSCONNRATIO,
CASE WHEN ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRPSRABASSIGNREQ),0,1,SUM(NBRPSRABASSIGNSUCC)/SUM(NBRPSRABASSIGNREQ))*100 ,3) >100  THEN 100  ELSE ROUND( DECODE(SUM(NBRRRCCONNREQ),0,1,SUM(NBRRRCCONNSUCC)/SUM(NBRRRCCONNREQ)) * DECODE(SUM(NBRPSRABASSIGNREQ),0,1,SUM(NBRPSRABASSIGNSUCC)/SUM(NBRPSRABASSIGNREQ))*100 ,3)  END RADIOPSCONNRATIO,
DECODE(SUM(NBRCSRABASSIGNREQ),0,0,ROUND( (SUM(NBRCSRABASSIGNCONG)/((SUM(NBRCSRABASSIGNREQ) ) ))*100,3)) NBRCSRABASSIGNCONGRATIO,
DECODE(SUM(NBRPSRABASSIGNREQ),0,0,ROUND( (SUM(NBRPSRABASSIGNCONG)/((SUM(NBRPSRABASSIGNREQ) ) ))*100,3)) NBRPSRABASSIGNCONGRATIO,
ROUND(avg(nvl(NBRSF4USAGE/4,0) + nvl(NBRSF8USAGE/8,0) + nvl(NBRSF16USAGE/16,0) + nvl(NBRSF32USAGE/32,0) + nvl(NBRSF64USAGE/64,0) + nvl(NBRSF128USAGE/128,0) + nvl(NBRSF256USAGE/256,0))*100,3) NBRSFALL_RATE,
ROUND(AVG(NBRHSDPASF16USAGE)/16*100,3) NBRHSDPASF16USAGE_RATE,
case  when  sum(NBRCS3GTO2GHOOUTSUCC)  >  sum(NBRCSRABASSIGNSUCC)  then  100   else   round (sum(NBRCS3GTO2GHOOUTSUCC)/(sum(NBRCSRABASSIGNSUCC)+0.0000001)*100,3)  end NBRCS3GTO2GHOOUTRATE,
ROUND(AVG(fachOccupRatio),3) FACHOCCUPRATIO,
ROUND(AVG(rachOccupRatio),3) RACHOCCUPRATIO,
ROUND(AVG(CqiVaule),3) CQIVAULE,
ROUND(SUM(nbrSf4Usage),3) NBRSF4USAGE,
ROUND(AVG(nbrSf16Usage),3) NBRSF16USAGE,
ROUND(AVG(nbrSf128Usage),3) NBRSF128USAGE,
ROUND(MAX(nbrMaxHsdpaSfUsage),3) NBRMAXHSDPASFUSAGE,
ROUND(AVG(nbrSf8Usage),3) NBRSF8USAGE,
ROUND(AVG(nbrSf64Usage),3) NBRSF64USAGE,
ROUND(AVG(nbrHsdpaSf16Usage),3) NBRHSDPASF16USAGE,
ROUND(AVG(nbrSf256Usage),3) NBRSF256USAGE,
ROUND(AVG(nbrSf32Usage),3) NBRSF32USAGE,
round(SUM(NBRSF4USAGE +NBRSF8USAGE + NBRSF16USAGE + NBRSF32USAGE +NBRSF64USAGE + NBRSF128USAGE  + NBRSF256USAGE), 2) CODE_NORMALIZE_SF256,
ROUND(avg(nvl(NBRSF4USAGE/4,0) + nvl(NBRSF8USAGE/8,0) + nvl(NBRSF16USAGE/16,0) + nvl(NBRSF32USAGE/32,0) + nvl(NBRSF64USAGE/64,0) + nvl(NBRSF128USAGE/128,0) + nvl(NBRSF256USAGE/256,0)),3) NBRSFALLRATE,
ROUND(AVG(NBRSF4USAGE)/4*100,3) NBRSF4USAGE_RATE,
ROUND(AVG(NBRSF8USAGE)/8*100,3) NBRSF8USAGE_RATE,
ROUND(AVG(NBRSF16USAGE)/16*100,3) NBRSF16USAGE_RATE,
ROUND(AVG(NBRSF32USAGE)/32*100,3) NBRSF32SAGE_RATE,
ROUND(AVG(NBRSF64USAGE)/64*100,3) NBRSF64USAGE_RATE,
ROUND(AVG(NBRSF128USAGE)/128*100,3) NBRSF128USAGE_RATE,
decode(AVG(MEANCELLTCP)*AVG(NVL(P_CELL_TRX_POW,43)),0,0,round(POWER(10,AVG(MEANCELLTCP)/10)/POWER(10,AVG(NVL(P_CELL_TRX_POW,43))/10)*100,3)) NBRDLTCPRATE,
ROUND(MAX(maxCellTcp),3) MAXCELLTCP,
ROUND(AVG(meanCellRwtp),3) MEANCELLRWTP,
ROUND(AVG(maxR99CellFreqTcp),3) MAXR99CELLFREQTCP,
ROUND(MAX(maxHsdpaCellFreqTcp),3) MAXHSDPACELLFREQTCP,
ROUND(AVG(meanCellTcp),3) MEANCELLTCP,
ROUND(MAX(maxCellRwtp),3) MAXCELLRWTP,
ROUND(AVG(meanHsdpaCellFreqTcp),3) MEANHSDPACELLFREQTCP,
ROUND(MAX(meanR99CellFreqTcp),3) MEANR99CELLFREQTCP,
decode(MAX(MAXR99CELLFREQTCP)*AVG(P_CELL_TRX_POW),0,0,round(POWER(10,AVG(MAXR99CELLFREQTCP)/10)/POWER(10,MAX(P_CELL_TRX_POW)/10)*100,3)) MAXCTCP_MSDPAFREQTCP,
SUM(NBRRABASSIGNREQ)-SUM(NBRRABASSIGNSUCC) NBRRABASSIGNFAIL,
SUM(NBRRABASSIGNUPCECONG)+SUM(NBRRABASSIGNDOWNCECONG) NBRRABASSIGNCECONG,
SUM(NBRRABASSIGNUPIUBCONG)+SUM(NBRRABASSIGNDOWNIUBCONG) NBRRABASSIGNIUBCONG,
SUM(NBRCS3GTO2GHOOUTREQ)-SUM(NBRCS3GTO2GHOOUTSUCC) NBRCS3GTO2GHOOUTFAIL,
SUM(NBRPS3GTO2GHOOUTREQ)-SUM(NBRPS3GTO2GHOOUTSUCC) NBRPS3GTO2GHOOUTFAIL,
SUM(NBRCS3GTO2GPREHOOUTREQ)-SUM(NBRCS3GTO2GPREHOOUTFAIL) NBRCS3GTO2GPREHOOUTSUCC,
SUM(NBRINTERFREQHHOOUTREQ)-SUM(NBRINTERFREQHHOOUTSUCC) NBRINTERFREQHHOOUTFAIL,
SUM(NBRPS2GTO3GHOINREQ)-SUM(NBRPS2GTO3GHOINSUCC) NBRPS2GTO3GHOINFAIL,
ROUND(SUM(nbrHsupaActiveUe),3) NBRHSUPAACTIVEUE,
ROUND(SUM(nbrHsdpaActiveUe),3) NBRHSDPAACTIVEUE,
ROUND(SUM(upDchPdu),3) UPDCHPDU,
ROUND(SUM(downDchPdu),3) DOWNDCHPDU,
ROUND(SUM(rachPdu),3) RACHPDU,
ROUND(SUM(RlcUpTraffic),3) RLCUPTRAFFIC,
ROUND(SUM(fachPdu),3) FACHPDU,
ROUND(SUM(RlcDownTraffic),3) RLCDOWNTRAFFIC,
ROUND(SUM(rlcCsDownAverRate),3) RLCCSDOWNAVERRATE,
ROUND(SUM(RlcCsUpTraffic),3) RLCCSUPTRAFFIC,
ROUND(SUM(rlcPsDownAverRate),3) RLCPSDOWNAVERRATE,
ROUND(SUM(rlcCsADownAverRate),3) RLCCSADOWNAVERRATE,
ROUND(SUM(RlcCsAUpTraffic),3) RLCCSAUPTRAFFIC,
ROUND(SUM(rlcCSvDownAverRate),3) RLCCSVDOWNAVERRATE,
ROUND(SUM(RlcCsVUpTraffic),3) RLCCSVUPTRAFFIC,
ROUND(SUM(hsdpaRlcDownBgrdTraffic),3) HSDPARLCDOWNBGRDTRAFFIC,
ROUND(SUM(RlcPsUpTraffic),3) RLCPSUPTRAFFIC,
ROUND(SUM(hsupaRlcUpTraffic),3) HSUPARLCUPTRAFFIC,
ROUND((sum(nvl(NBRCSUSER,0))*50*3600/1024+sum(nvl(HSUPARLCUPTRAFFIC,0))*1.2*8/1024+SUM(NVL(NBRRRCCONNSUCC,0))*4*13.6/1024)/sum(nbrrefthroughput*0.9)*100,3) RADIORATIO,
round((sum(nvl(NBRCSUSER,0))*50*3600/1024+sum(nvl(HSUPARLCUPTRAFFIC,0))*1.2*8/1024),3) TRAFFIC3G,
round(sum(nvl(NBRCSUSER,0))*50*3600/1024,3) TRAFFICCS,
ROUND((sum(nvl(NBRCSUSER,0))*50*3600/1024)/sum(nbrrefthroughput*0.9)*100,3) RADIORATIOCS,
ROUND((sum(nvl(HSUPARLCUPTRAFFIC,0))*1.2*8/1024)/sum(nbrrefthroughput*0.9)*100,3) RADIORATIOPS,
ROUND(SUM(nbrrefthroughput)*0.9,3) RADIORATIO_FENMU,
ROUND((sum(nvl(NBRCSUSER_BUSY,0))*50*3600/1024+sum(nvl(HSUPARLCUPTRAFFIC_BUSY,0))*1.2*8/1024+sum(USE_SIG_TRAFFIC_BUSY))/sum(nbrrefthroughput_BUSY*0.9+0.0000001)*100,3) RADIORATIO_BUSY,
ROUND(SUM(hsupaRlcUpTraffic_BUSY),3) HSUPARLCUPTRAFFIC_BUSY,
round(sum(nbrcsuser_BUSY),3) NBRCSUSER_BUSY,
ROUND(SUM(NBRREFTHROUGHPUT_BUSY),3) NBRREFTHROUGHPUT_BUSY,
ROUND((sum(nvl(NBRCSUSER_BUSY,0))*50*3600/1024)/sum(nbrrefthroughput_BUSY*0.9)*100,3) RADIORATIOCS_BUSY,
ROUND((sum(nvl(HSUPARLCUPTRAFFIC_BUSY,0))*1.2*8/1024)/sum(nbrrefthroughput_BUSY*0.9)*100,3) RADIORATIOPS_BUSY,
ROUND(SUM(USE_SIG_TRAFFIC_BUSY),4) USE_SIG_TRAFFIC_BUSY,
ROUND(SUM(NBRRRCCONNSUCC)*4*13.6/1024,4) USE_SIG_TRAFFIC,
ROUND(SUM(csErlTraffic),3) CSERLTRAFFIC,
ROUND(AVG(fachAverRate),3) FACHAVERRATE,
ROUND(AVG(rachAverRate),3) RACHAVERRATE,
ROUND(AVG(rlcDownAverRate),3) RLCDOWNAVERRATE,
ROUND(AVG(hsupaRlcUpAverRate),3) HSUPARLCUPAVERRATE,
ROUND(AVG(upDchAverRate),3) UPDCHAVERRATE,
ROUND(AVG(rlcUpAverRate),3) RLCUPAVERRATE,
ROUND(AVG(downDchAverRate),3) DOWNDCHAVERRATE,
ROUND(AVG(hsupaRlcDownAverRate),3) HSUPARLCDOWNAVERRATE,
ROUND(SUM(nbrMachsTranHAPdu),3) NBRMACHSTRANHAPDU,
ROUND(SUM(nbrMaceTranHAPdu),3) NBRMACETRANHAPDU,
ROUND(SUM(nbrMaceTranPdu),3) NBRMACETRANPDU,
ROUND(SUM(nbrPsRlcDownTranBlock),3) NBRPSRLCDOWNTRANBLOCK,
ROUND(SUM(nbrMachsTranPdu),3) NBRMACHSTRANPDU,
ROUND(SUM(nbrPsRlcDownRetranBlock),3) NBRPSRLCDOWNRETRANBLOCK,
ROUND(SUM(nbrUpDchErrorBlock),3) NBRUPDCHERRORBLOCK,
ROUND(SUM(nbrUpDchTotalBlock),3) NBRUPDCHTOTALBLOCK,
ROUND(SUM(nbrCsUpDchTotalBlock),3) NBRCSUPDCHTOTALBLOCK,
ROUND(SUM(nbrCsUpDchErrorBlock),3) NBRCSUPDCHERRORBLOCK,
ROUND(SUM(nbrPsUpDchTotalBlock),3) NBRPSUPDCHTOTALBLOCK,
ROUND(SUM(nbrPsUpDchErrorBlock),3) NBRPSUPDCHERRORBLOCK,
ROUND(SUM(nbrCsaUpDchTotalBlock),3) NBRCSAUPDCHTOTALBLOCK,
ROUND(SUM(nbrCsAUpDchErrorBlock),3) NBRCSAUPDCHERRORBLOCK,
ROUND(SUM(nbrCsvUpDchTotalBlock),3) NBRCSVUPDCHTOTALBLOCK,
ROUND(SUM(nbrCsvUpDchErrorBlock),3) NBRCSVUPDCHERRORBLOCK,
ROUND(SUM(nbrRachErrorBlock),3) NBRRACHERRORBLOCK,
ROUND(SUM(nbrRachTotalBlock),3) NBRRACHTOTALBLOCK,
ROUND(SUM(NBRRRCCONNREQ-NBRRRCCONNSUCC),3) NBRRRCCONNFAIL,
ROUND(SUM(NBRCSRABASSIGNREQ-NBRCSRABASSIGNSUCC),3) NBRCSRABASSIGNFAIL,
ROUND(SUM(NBRPSRABASSIGNREQ-NBRPSRABASSIGNSUCC),3) NBRPSRABASSIGNFAIL,
ROUND(SUM(nbrFachtoHsdschSucc),3) NBRFACHTOHSDSCHSUCC,
ROUND(SUM(nbrHsdschtoFachReq),3) NBRHSDSCHTOFACHREQ,
ROUND(SUM(nbrHsdschtoDchSuss),3) NBRHSDSCHTODCHSUSS,
ROUND(SUM(nbrRachtoEdchSucc),3) NBRRACHTOEDCHSUCC,
ROUND(SUM(nbrEdchtoRachReq),3) NBREDCHTORACHREQ,
ROUND(SUM(nbrDchtoEdchReq),3) NBRDCHTOEDCHREQ,
ROUND(SUM(nbrFachtoHsdschReq),3) NBRFACHTOHSDSCHREQ,
ROUND(SUM(nbrDchtoHsdschReq),3) NBRDCHTOHSDSCHREQ,
ROUND(SUM(nbrDchtoHsdschSucc),3) NBRDCHTOHSDSCHSUCC,
ROUND(SUM(nbrHsdschtoFachSucc),3) NBRHSDSCHTOFACHSUCC,
ROUND(SUM(nbrHsdschtoDchReq),3) NBRHSDSCHTODCHREQ,
ROUND(SUM(nbrRachtoEdchReq),3) NBRRACHTOEDCHREQ,
ROUND(SUM(nbrDchtoEdchSucc),3) NBRDCHTOEDCHSUCC,
ROUND(SUM(nbrEdchtoRachSucc),3) NBREDCHTORACHSUCC,
ROUND(SUM(nrbEdchtoDchReq),3) NRBEDCHTODCHREQ,
ROUND(SUM(nrbEdchtoDchSucc),3) NRBEDCHTODCHSUCC,
DECODE(SUM(NBRMACETRANPDU),0,0,ROUND( (SUM(NBRMACETRANHAPDU)/((SUM(NBRMACETRANPDU) ) ))*100,3)) MACETRANHAPDURATIO,
DECODE(SUM(NBRMACHSTRANPDU),0,0,ROUND( (SUM(NBRMACHSTRANHAPDU)/((SUM(NBRMACHSTRANPDU) ) ))*100,3)) MACHSTRANHAPDURATIO,
DECODE(SUM(NBRRACHTOTALBLOCK),0,0,ROUND( (SUM(NBRRACHERRORBLOCK)/((SUM(NBRRACHTOTALBLOCK) ) ))*100,3)) RACHBLER,
DECODE(SUM(NBRUPDCHTOTALBLOCK),0,0,ROUND( (SUM(NBRUPDCHERRORBLOCK)/((SUM(NBRUPDCHTOTALBLOCK) ) ))*100,3)) UPDCHBLER,
ROUND(SUM(nbrHsdpaCellChangeReq),3) NBRHSDPACELLCHANGEREQ,
ROUND(SUM(nbrHsupaCellChangeSucc),3) NBRHSUPACELLCHANGESUCC,
ROUND(SUM(nbrHsupaCellChangeReq),3) NBRHSUPACELLCHANGEREQ,
ROUND(SUM(nbrHsdpaCellChangeSucc),3) NBRHSDPACELLCHANGESUCC,
ROUND(SUM(nbrCs3gto2gPreHoOutReq),3) NBRCS3GTO2GPREHOOUTREQ,
ROUND(SUM(nbr3gto2gHoOutSucc),3) NBR3GTO2GHOOUTSUCC,
ROUND(SUM(nbrCs3gto2gHoOutSucc),3) NBRCS3GTO2GHOOUTSUCC,
ROUND(SUM(nbrCs3gto2gHoOutReq),3) NBRCS3GTO2GHOOUTREQ,
ROUND(SUM(nbrCs2gto3gHoInReq),3) NBRCS2GTO3GHOINREQ,
ROUND(SUM(nbrCs2gto3gHoInSucc),3) NBRCS2GTO3GHOINSUCC,
ROUND(SUM(nbrPs3gto2gHoOutSucc),3) NBRPS3GTO2GHOOUTSUCC,
ROUND(SUM(nbrPs3gto2gHoOutReq),3) NBRPS3GTO2GHOOUTREQ,
ROUND(SUM(nbrPs2gto3gHoInReq),3) NBRPS2GTO3GHOINREQ,
ROUND(SUM(nbrPs2gto3gHoInSucc),3) NBRPS2GTO3GHOINSUCC,
ROUND(SUM(nbr3gto2gHoOutReq),3) NBR3GTO2GHOOUTREQ,
ROUND(SUM(nbr2gto3gHoInReq),3) NBR2GTO3GHOINREQ,
ROUND(SUM(nbr2gto3gHoInSucc),3) NBR2GTO3GHOINSUCC,
ROUND(SUM(nbrCs3gto2gPreHoOutFail),3) NBRCS3GTO2GPREHOOUTFAIL,
ROUND(SUM(nbrCellUpdReq),3) NBRCELLUPDREQ,
ROUND(SUM(nbrCellUpdSucc),3) NBRCELLUPDSUCC,
ROUND(SUM(nbrUraUpdReq),3) NBRURAUPDREQ,
ROUND(SUM(nbrUraUpdSucc),3) NBRURAUPDSUCC,
ROUND(SUM(nbrInterRncbIeFHhoOutSucc),3) NBRINTERRNCBIEFHHOOUTSUCC,
ROUND(SUM(nbrIurInterRncIaFHhoOutSucc),3) NBRIURINTERRNCIAFHHOOUTSUCC,
ROUND(SUM(nbrCnInterRncIaFHhoOutReq),3) NBRCNINTERRNCIAFHHOOUTREQ,
ROUND(SUM(nbrCsInterRncbIeFHhoOutSucc),3) NBRCSINTERRNCBIEFHHOOUTSUCC,
ROUND(SUM(nbrCsCnInterRncIaFHhoOutReq),3) NBRCSCNINTERRNCIAFHHOOUTREQ,
ROUND(SUM(nbrCsIurHIeRIeFHhoOutSucc),3) NBRCSIURHIERIEFHHOOUTSUCC,
ROUND(SUM(nbrCsIntraNodebIeFHhoOutReq),3) NBRCSINTRANODEBIEFHHOOUTREQ,
ROUND(SUM(nbrCsIntraNodebIeFHhoOutSucc),3) NBRCSINTRANODEBIEFHHOOUTSUCC,
ROUND(SUM(nbrCsInterNodebIeFHhoOutSucc),3) NBRCSINTERNODEBIEFHHOOUTSUCC,
ROUND(SUM(nbrCsIeRbIntraFreqHhoOutReq),3) NBRCSIERBINTRAFREQHHOOUTREQ,
ROUND(SUM(nbrCsInterRncbIaFHhoOutSucc),3) NBRCSINTERRNCBIAFHHOOUTSUCC,
ROUND(SUM(nbrCsIeRbInterFreqHhoOutReq),3) NBRCSIERBINTERFREQHHOOUTREQ,
ROUND(SUM(nbrCsCnInterRncIeFHhoOutReq),3) NBRCSCNINTERRNCIEFHHOOUTREQ,
ROUND(SUM(nbrPsCnInterRncIaFHhoOutReq),3) NBRPSCNINTERRNCIAFHHOOUTREQ,
ROUND(SUM(nbrPsIntraNodebIeFHhoOutReq),3) NBRPSINTRANODEBIEFHHOOUTREQ,
ROUND(SUM(nbrPsIntraNodebIeFHhoOutSucc),3) NBRPSINTRANODEBIEFHHOOUTSUCC,
ROUND(SUM(nbrPsInterNodebIeFHhoOutReq),3) NBRPSINTERNODEBIEFHHOOUTREQ,
ROUND(SUM(nbrPsInterNodebIeFHhoOutSucc),3) NBRPSINTERNODEBIEFHHOOUTSUCC,
ROUND(SUM(nbrPsInterRncbIaFHhoOutSucc),3) NBRPSINTERRNCBIAFHHOOUTSUCC,
ROUND(SUM(nbrPsIeRbInterFreqHhoOutReq),3) NBRPSIERBINTERFREQHHOOUTREQ,
ROUND(SUM(nbrPsCnInterRncIaFHhoOutSucc),3) NBRPSCNINTERRNCIAFHHOOUTSUCC,
ROUND(SUM(nbrPsCnInterRncIeFHhoOutReq),3) NBRPSCNINTERRNCIEFHHOOUTREQ,
ROUND(SUM(NBRINTERFREQHHOOUTSUCC),3) NBRINTERFREQHHOOUTSUCC,
ROUND(SUM(nbrInterNodebIeFHhoOutReq),3) NBRINTERNODEBIEFHHOOUTREQ,
ROUND(SUM(nbrIeRbInterFreqHhoOutReq),3) NBRIERBINTERFREQHHOOUTREQ,
ROUND(SUM(nbrCnInterRncIaFHhoOutSucc),3) NBRCNINTERRNCIAFHHOOUTSUCC,
ROUND(SUM(nbrCsInterNodebIeFHhoOutReq),3) NBRCSINTERNODEBIEFHHOOUTREQ,
ROUND(SUM(nbrCsCnInterRncIaFHhoOutSucc),3) NBRCSCNINTERRNCIAFHHOOUTSUCC,
ROUND(SUM(nbrPsIurHIeRIeFHhoOutSucc),3) NBRPSIURHIERIEFHHOOUTSUCC,
ROUND(SUM(nbrIntraFreqHhoOutReq),3) NBRINTRAFREQHHOOUTREQ,
ROUND(SUM(nbrIntraFreqHhoOutSucc),3) NBRINTRAFREQHHOOUTSUCC,
ROUND(SUM(NBRINTERFREQHHOOUTREQ),3) NBRINTERFREQHHOOUTREQ,
ROUND(SUM(nbrIntraNodebIeFHhoOutReq),3) NBRINTRANODEBIEFHHOOUTREQ,
ROUND(SUM(nbrIntraNodebIeFHhoOutSucc),3) NBRINTRANODEBIEFHHOOUTSUCC,
ROUND(SUM(nbrInterNodebIeFHhoOutSucc),3) NBRINTERNODEBIEFHHOOUTSUCC,
ROUND(SUM(nbrIeRbIntraFreqHhoOutReq),3) NBRIERBINTRAFREQHHOOUTREQ,
ROUND(SUM(nbrInterRncbIaFHhoOutSucc),3) NBRINTERRNCBIAFHHOOUTSUCC,
ROUND(SUM(nbrIurInterRncIaFHhoOutReq),3) NBRIURINTERRNCIAFHHOOUTREQ,
ROUND(SUM(nbrIurInterRncIeFHhoOutReq),3) NBRIURINTERRNCIEFHHOOUTREQ,
ROUND(SUM(nbrIurInterRncIeFHhoOutSucc),3) NBRIURINTERRNCIEFHHOOUTSUCC,
ROUND(SUM(nbrCnInterRncIeFHhoOutReq),3) NBRCNINTERRNCIEFHHOOUTREQ,
ROUND(SUM(nbrIurHIeRIeFHhoOutSucc),3) NBRIURHIERIEFHHOOUTSUCC,
ROUND(SUM(nbrPsInterRncbIeFHhoOutSucc),3) NBRPSINTERRNCBIEFHHOOUTSUCC,
ROUND(SUM(nbrPsIeRbIntraFreqHhoOutReq),3) NBRPSIERBINTRAFREQHHOOUTREQ,
ROUND(SUM(nbrCsShoReq),3) NBRCSSHOREQ,
ROUND(SUM(nbrCsShoSucc),3) NBRCSSHOSUCC,
ROUND(SUM(nbrCsShoRLAddSucc),3) NBRCSSHORLADDSUCC,
ROUND(SUM(nbrCsShoRLDelReq),3) NBRCSSHORLDELREQ,
ROUND(SUM(nbrPsShoSucc),3) NBRPSSHOSUCC,
ROUND(SUM(nbrPsShoRLAddReq),3) NBRPSSHORLADDREQ,
ROUND(SUM(nbrPsShoRLAddSucc),3) NBRPSSHORLADDSUCC,
ROUND(SUM(nbrPsShoRLDelReq),3) NBRPSSHORLDELREQ,
DECODE(SUM(NBRPSSHORLDELREQ),0,100,ROUND( (SUM(NBRPSSHORLDELSUCC)/((SUM(NBRPSSHORLDELREQ) ) ))*100,3)) NBRPSSHORLDELSUCCRATE,
ROUND(SUM(nbrCSaShoReq),3) NBRCSASHOREQ,
ROUND(SUM(nbrCsAShoSucc),3) NBRCSASHOSUCC,
ROUND(SUM(nbrCsAShoRLAddSucc),3) NBRCSASHORLADDSUCC,
ROUND(SUM(nbrCsAShoRLDelSucc),3) NBRCSASHORLDELSUCC,
ROUND(SUM(nbrCsVShoReq),3) NBRCSVSHOREQ,
ROUND(SUM(nbrCSVShoSucc),3) NBRCSVSHOSUCC,
ROUND(SUM(nbrCsVShoRLAddReq),3) NBRCSVSHORLADDREQ,
ROUND(SUM(nbrCsVShoRLAddSucc),3) NBRCSVSHORLADDSUCC,
ROUND(SUM(nbrCsvShoRLDelReq),3) NBRCSVSHORLDELREQ,
ROUND(SUM(nbrCsVShoRLDelSucc),3) NBRCSVSHORLDELSUCC,
ROUND(AVG(nbrShoActOcu4RLUe),3) NBRSHOACTOCU4RLUE,
ROUND(SUM(nbrPsShoReq),3) NBRPSSHOREQ,
ROUND(SUM(nbrCsaShoRLDelReq),3) NBRCSASHORLDELREQ,
ROUND(SUM(nbrCsShoRLAddReq),3) NBRCSSHORLADDREQ,
ROUND(SUM(nbrShoReq),3) NBRSHOREQ,
ROUND(SUM(nbrShoSucc),3) NBRSHOSUCC,
ROUND(AVG(nbrShoActOcu1RLUe),3) NBRSHOACTOCU1RLUE,
ROUND(AVG(nbrShoActOcu2RLUe),3) NBRSHOACTOCU2RLUE,
ROUND(AVG(nbrShoActOcu3RLUe),3) NBRSHOACTOCU3RLUE,
ROUND(AVG(nbrShoActOcu5RLUe),3) NBRSHOACTOCU5RLUE,
ROUND(AVG(nbrShoActOcu6RLUe),3) NBRSHOACTOCU6RLUE,
ROUND(SUM(nbrShoRLAddReq),3) NBRSHORLADDREQ,
ROUND(SUM(nbrShoRLAddSucc),3) NBRSHORLADDSUCC,
ROUND(SUM(nbrShoRLDelReq),3) NBRSHORLDELREQ,
DECODE(SUM(NBRSHORLDELREQ),0,100,ROUND( (SUM(NBRSHORLDELSUCC)/((SUM(NBRSHORLDELREQ) ) ))*100,3)) NBRSHORLDELSUCCRATE,
DECODE(SUM(NBRCSSHORLDELREQ),0,100,ROUND( (SUM(NBRCSSHORLDELSUCC)/((SUM(NBRCSSHORLDELREQ) ) ))*100,3)) NBRCSSHORLDELSUCCRATE,
ROUND(SUM(nbrCsAShoRLAddReq),3) NBRCSASHORLADDREQ,
ROUND(SUM(nbrShoRLDelSucc),3) NBRSHORLDELSUCC,
ROUND(SUM(nbrPsShoRLDelSucc),3) NBRPSSHORLDELSUCC,
ROUND(SUM(nbrCsShoRLDelSucc),3) NBRCSSHORLDELSUCC,
round(decode(sum((nvl(NBRSHOACTOCU1RLUE*1,0)+nvl(NBRSHOACTOCU2RLUE*2,0)+nvl(NBRSHOACTOCU3RLUE*3,0)+nvl(NBRSHOACTOCU4RLUE*4,0)+nvl(NBRSHOACTOCU5RLUE*5,0)+nvl(NBRSHOACTOCU6RLUE*6,0))),0,100, sum((nvl(NBRSHOACTOCU2RLUE*1,0)+nvl(NBRSHOACTOCU3RLUE*2,0)+nvl(NBRSHOACTOCU4RLUE*3,0)+nvl(NBRSHOACTOCU5RLUE*4,0)+nvl(NBRSHOACTOCU6RLUE*5,0)))/sum((nvl(NBRSHOACTOCU1RLUE*1,0)+nvl(NBRSHOACTOCU2RLUE*2,0)+nvl(NBRSHOACTOCU3RLUE*3,0)+nvl(NBRSHOACTOCU4RLUE*4,0)+nvl(NBRSHOACTOCU5RLUE*5,0)+nvl(NBRSHOACTOCU6RLUE*6,0)))*100),3) SOFTHO_RATE,
ROUND(SUM(nbrCsUnnormReleRab),3) NBRCSUNNORMRELERAB,
ROUND(SUM(nbrCsReleRab),3) NBRCSRELERAB,
ROUND(SUM(nbrPsReleRab),3) NBRPSRELERAB,
ROUND(SUM(nbrCsAUnnormReleRab),3) NBRCSAUNNORMRELERAB,
ROUND(SUM(nbrCSAReleRab),3) NBRCSARELERAB,
ROUND(SUM(nbrCsVReleRab),3) NBRCSVRELERAB,
ROUND(SUM(nbrRrcUnnormRele),3) NBRRRCUNNORMRELE,
ROUND(SUM(nbrHsupaRabDrop),3) NBRHSUPARABDROP,
ROUND(SUM(nbrRrcReleReq),3) NBRRRCRELEREQ,
ROUND(SUM(nbrUnnormReleRab),3) NBRUNNORMRELERAB,
ROUND(SUM(nbrReleRab),3) NBRRELERAB,
ROUND(SUM(nbrHsdpaRabDrop),3) NBRHSDPARABDROP,
ROUND(SUM(nbrHsdpaRabRel),3) NBRHSDPARABREL,
ROUND(SUM(nbrHsupaRabRel),3) NBRHSUPARABREL,
ROUND(SUM(nbrPsUnnormReleRab),3) NBRPSUNNORMRELERAB,
ROUND(SUM(nbrCsVUnnormReleRab),3) NBRCSVUNNORMRELERAB,
ROUND(SUM(nbrIubRLSetupSucc),3) NBRIUBRLSETUPSUCC,
ROUND(SUM(nbrIubRLSetupReq),3) NBRIUBRLSETUPREQ,
ROUND(SUM(nbrIubRLAddReq),3) NBRIUBRLADDREQ,
ROUND(SUM(nbrIubRLAddSucc),3) NBRIUBRLADDSUCC,
ROUND(SUM(nbrIurRLSetupReq),3) NBRIURRLSETUPREQ,
ROUND(SUM(nbrIurRLSetupSucc),3) NBRIURRLSETUPSUCC,
ROUND(SUM(nbrIurRLAddReq),3) NBRIURRLADDREQ,
ROUND(SUM(nbrIurRLAddSucc),3) NBRIURRLADDSUCC,
ROUND(SUM(nbrPagingSendFail),3) NBRPAGINGSENDFAIL,
ROUND(SUM(nbrPagingSendSucc),3) NBRPAGINGSENDSUCC,
ROUND(SUM(nbrCsRabAssignReq),3) NBRCSRABASSIGNREQ,
ROUND(SUM(nbrCsRabModifyReq),3) NBRCSRABMODIFYREQ,
ROUND(SUM(nbrCsRabModifySucc),3) NBRCSRABMODIFYSUCC,
ROUND(SUM(nbrCsRabAssignCong),3) NBRCSRABASSIGNCONG,
ROUND(SUM(nbrPsRabAssignReq),3) NBRPSRABASSIGNREQ,
ROUND(SUM(nbrPsRabAssignSucc),3) NBRPSRABASSIGNSUCC,
ROUND(SUM(nbrPsRabModifyReq),3) NBRPSRABMODIFYREQ,
ROUND(SUM(nbrPsRabModifySucc),3) NBRPSRABMODIFYSUCC,
ROUND(SUM(nbrPsRabAssignCong),3) NBRPSRABASSIGNCONG,
ROUND(SUM(nbrCsARabAssignReq),3) NBRCSARABASSIGNREQ,
ROUND(SUM(nbrCsARabAssignSucc),3) NBRCSARABASSIGNSUCC,
ROUND(SUM(nbrCSARabAssignCong),3) NBRCSARABASSIGNCONG,
ROUND(SUM(nbrCsVRabAssignReq),3) NBRCSVRABASSIGNREQ,
ROUND(SUM(nbrCsVRabAssignSucc),3) NBRCSVRABASSIGNSUCC,
ROUND(SUM(nbrCSVRabAssignCong),3) NBRCSVRABASSIGNCONG,
ROUND(SUM(nbrRabAssignReq),3) NBRRABASSIGNREQ,
ROUND(SUM(nbrRabAssignSucc),3) NBRRABASSIGNSUCC,
ROUND(SUM(nbrRabModifyReq),3) NBRRABMODIFYREQ,
ROUND(SUM(nbrRabModifySucc),3) NBRRABMODIFYSUCC,
ROUND(SUM(nbrRabAssignCong),3) NBRRABASSIGNCONG,
ROUND(SUM(nbrRabAssignTcpCong),3) NBRRABASSIGNTCPCONG,
ROUND(SUM(nbrRabAssignUpCeCong),3) NBRRABASSIGNUPCECONG,
ROUND(SUM(nbrRabAssignDownCeCong),3) NBRRABASSIGNDOWNCECONG,
ROUND(SUM(nbrRabAssignDownIubCong),3) NBRRABASSIGNDOWNIUBCONG,
ROUND(SUM(nbrHsdpaRabAssignReq),3) NBRHSDPARABASSIGNREQ,
ROUND(SUM(nbrHsdpaRabAssignSucc),3) NBRHSDPARABASSIGNSUCC,
ROUND(SUM(nbrHsupaRabAssignReq),3) NBRHSUPARABASSIGNREQ,
ROUND(SUM(nbrHsupaRabAssignSucc),3) NBRHSUPARABASSIGNSUCC,
ROUND(SUM(nbrCsRabAssignSucc),3) NBRCSRABASSIGNSUCC,
ROUND(SUM(nbrRabAssignUpIubCong),3) NBRRABASSIGNUPIUBCONG,
ROUND(SUM(nbrRabAssignDownSfCong),3) NBRRABASSIGNDOWNSFCONG,
ROUND(SUM(nbrRrcConnReq),3) NBRRRCCONNREQ,
ROUND(SUM(nbrRrcConnSucc),3) NBRRRCCONNSUCC
 from perf_cell_w_h p,mod_mr_cell_hour mr,ne_cell_w ne,cfg_city_map_hq_id cfg
where p.ne_cell_id=ne.ne_cell_id(+)
  and p.ne_cell_id=mr.ne_cell_id(+)
  and ne.city_id=cfg.city_id
  and p.start_time=mr.start_time(+)
   and  p.start_time>=to_date('%%Y-%%M-%%D %%H','YYYY-MM-DD HH24')  and  p.start_time  < to_date('%%Y-%%M-%%D %%H','YYYY-MM-DD HH24')+1/24

group by p.start_time,
         cfg.prov_code,
         p.CITY_NAME,
         p.ADM_AREA,
         p.VENDORNAME,
         ne.ne_msc_id,
         ne.msc_name,
         ne.sgsn,
         ne.city_id || '_' || ne.bsc_id,
         ne.bsc_id || '_' || ne.bts_id,
         ne.LAC,
         ne.CI,
         ne.bsc_id || '_' || ne.ci,
         p.cell_name
  
 
   

]]>


        </sql>
			</mapping>
			
			
			
		</resolve>
	</to>
	
	<!-- 传输接口, 当只有path属性在时候为本地接口，其他则为远程接口 -->
	<ti id="1" after="1">
		<property name="ftpip">134.54.160.117</property>
		<property name="port">21</property>
		<property name="username">uwayftp</property>
		<property name="password">uwayftp</property>
		<property name="path">/gongke/perf_wcdma</property><!--可以配置通配符HUB/WORK/-->
		<property name="encode">utf-8</property>
        </ti>
	<t>
		<action id="1" toid="1" tiid="1" strategyid="1"/><!---->
	</t>
	
	<!-- 默认失败不处理  0:正常   1:   2: -->
	<strategy id="1">
		<property name="failure">1,2,3</property>
	</strategy>
	
	<!-- before ,after ,exception -->
	<trigger id="11" class="cn.uway.nbi.task.triggerc.UpdateBean" />
</config>

