SELECT NVL(obj_type,'省'),start_time, obj_name,'江苏' province,city_name,
sum("MD1.1")          "MD1.1",  
sum("MD1.2")          "MD1.2",  
sum("MD1.3")          "MD1.3",  
sum("MD1.4")          "MD1.4",  
sum("MD1.5")          "MD1.5",  
sum("MD1.6")          "MD1.6",  
sum("MD1.7")          "MD1.7",  
sum("MD1.8")          "MD1.8",  
sum("MD1.9")          "MD1.9",  
sum("MD1.10")         "MD1.10", 
sum("MD1.11")         "MD1.11", 
sum("MD1.12")         "MD1.12", 
sum("MD1.13")         "MD1.13", 
sum("MD1.14")         "MD1.14", 
sum("MD1.15")         "MD1.15", 
sum("MD1.16")         "MD1.16", 
sum("MD1.17")         "MD1.17", 
sum("MD1.18")         "MD1.18", 
sum("MD1.19")         "MD1.19", 
sum("MD1.20")         "MD1.20", 
sum("MD1.21")         "MD1.21", 
sum("MD1.22")         "MD1.22", 
sum("MD2.1")          "MD2.1",  
sum("MD2.2")          "MD2.2",  
sum("MD2.3")          "MD2.3",  
sum("MD2.4")          "MD2.4",  
sum("MD2.5")          "MD2.5",  
sum("MD2.6")          "MD2.6",  
sum("MD2.7")          "MD2.7",  
sum("MD2.8")          "MD2.8",  
sum("MD2.9")          "MD2.9",  
sum("MD2.10")         "MD2.10", 
sum("MD2.11")         "MD2.11", 
sum("MD2.12")         "MD2.12", 
sum("MD2.13")         "MD2.13", 
sum("MD2.14")         "MD2.14", 
sum("MD2.15")         "MD2.15", 
sum("MD2.16")         "MD2.16", 
sum("MD2.17")         "MD2.17", 
sum("MD2.18")         "MD2.18", 
sum("MD2.19")         "MD2.19", 
sum("MD2.20")         "MD2.20", 
sum("MD2.21")         "MD2.21", 
sum("MD2.22")         "MD2.22", 
sum("MD2.23")         "MD2.23", 
sum("MD2.24")         "MD2.24", 
sum("MD2.25")         "MD2.25", 
sum("MD2.26")         "MD2.26", 
sum("MD2.27")         "MD2.27", 
sum("MD2.28")         "MD2.28", 
sum("MD3.1")          "MD3.1",  
sum("MD3.2")          "MD3.2",  
sum("MD3.3")          "MD3.3",  
sum("MD3.4")          "MD3.4",  
sum("MD3.5")          "MD3.5",  
sum("MD3.6")          "MD3.6",  
sum("MD3.7")          "MD3.7",  
sum("MD3.8")          "MD3.8",  
sum("MD3.9")          "MD3.9",  
sum("MD3.10")         "MD3.10", 
sum("MD3.11")         "MD3.11", 
sum("MD3.12")         "MD3.12", 
sum("MD3.13")         "MD3.13", 
sum("MD3.14")         "MD3.14", 
sum("MD3.15")         "MD3.15", 
sum("MD3.16")         "MD3.16", 
sum("MD3.17")         "MD3.17", 
sum("MD3.18")         "MD3.18", 
sum("MD3.19")         "MD3.19", 
sum("MD4.1")          "MD4.1",  
sum("MD4.2")          "MD4.2",  
sum("MD4.3")          "MD4.3",  
sum("MD4.4")          "MD4.4",  
sum("MD4.5")          "MD4.5",  
sum("MD4.6")          "MD4.6",  
sum("MD4.7")          "MD4.7",  
sum("MD4.8")          "MD4.8",  
sum("MD4.9")          "MD4.9",  
sum("MD4.10")         "MD4.10", 
sum("MD4.11")         "MD4.11", 
sum("MD5.1")          "MD5.1",  
sum("MD5.2")          "MD5.2",  
sum("MD5.3")          "MD5.3",  
sum("MD5.4")          "MD5.4",  
sum("MD5.5")          "MD5.5",  
sum("MD6.1")          "MD6.1",  
sum("MD6.2")          "MD6.2",  
sum("MD6.3")          "MD6.3",  
sum("MD6.4")          "MD6.4",  
sum("MD6.5")          "MD6.5",  
sum("MD6.6")          "MD6.6",  
sum("MD6.7")          "MD6.7",  
sum("MD6.8")          "MD6.8",  
sum("MD6.9")          "MD6.9",  
sum("MD6.10")         "MD6.10", 
sum("MD6.11")         "MD6.11", 
sum("MD6.12")         "MD6.12", 
sum("MD6.13")         "MD6.13", 
sum("MD6.14")         "MD6.14", 
sum("MD6.15")         "MD6.15", 
sum("MD6.16")         "MD6.16", 
sum("MD6.17")         "MD6.17", 
sum("MD6.18")         "MD6.18", 
sum("MD6.19")         "MD6.19", 
sum("MD6.20")         "MD6.20", 
sum("MD7.1")          "MD7.1",  
sum("MD7.2")          "MD7.2",  
sum("MD7.3")          "MD7.3",  
sum("MD7.4")          "MD7.4",  
sum("MD7.5")          "MD7.5",  
sum("MD7.6")          "MD7.6",  
sum("MD7.7")          "MD7.7",  
sum("MD7.8")          "MD7.8",  
sum("MD7.9")          "MD7.9",  
sum("MD7.10")         "MD7.10", 
sum("MD7.11")         "MD7.11", 
sum("MD7.12")         "MD7.12", 
sum("MD7.13")         "MD7.13", 
sum("MD7.14")         "MD7.14", 
sum("MD7.15")         "MD7.15", 
sum("MD8.1")          "MD8.1",  
sum("MD8.2")          "MD8.2",  
sum("MD8.3")          "MD8.3",  
sum("MD9.1")          "MD9.1",  
sum("MD9.2")          "MD9.2",  
sum("MD9.3")          "MD9.3",  
sum("MD9.4")          "MD9.4",  
sum("MD9.5")          "MD9.5",  
sum("MD9.6")          "MD9.6",  
sum("MD9.7")          "MD9.7",  
sum("MD9.8")          "MD9.8",  
sum("MD9.9")          "MD9.9",  
sum("MD9.10")         "MD9.10", 
sum("MD9.11")         "MD9.11", 
sum("MD10.1")         "MD10.1", 
sum("MD10.2")         "MD10.2", 
sum("MD10.3")         "MD10.3", 
sum("MD10.4")         "MD10.4", 
sum("MD10.5")         "MD10.5", 
sum("MD10.6")         "MD10.6", 
sum("MD10.7")         "MD10.7", 
sum("MD10.8")         "MD10.8", 
sum("MD10.9")         "MD10.9", 
sum("MD10.10")        "MD10.10",
sum("MD10.11")        "MD10.11",
sum("MD10.12")        "MD10.12",
sum("MD10.13")        "MD10.13",
sum("MD10.14")        "MD10.14",
sum("MD10.15")        "MD10.15",
sum("MD10.16")        "MD10.16",
sum("MD10.17")        "MD10.17",
sum("MD11.1")         "MD11.1", 
sum("MD11.2")         "MD11.2", 
sum("MD11.3")         "MD11.3", 
sum("MD11.4")         "MD11.4", 
sum("MD11.5")         "MD11.5"  
FROM (
SELECT obj_type,start_time, obj_name,province,city_name,
"MD1.1",
"MD1.2",
"MD1.3",
"MD1.4",
"MD1.5",
"MD1.6",
"MD1.7",
"MD1.8",
"MD1.9",
"MD1.10",
"MD1.11",
"MD1.12",
"MD1.13",
"MD1.14",
"MD1.15",
"MD1.16",
"MD1.17",
"MD1.18",
"MD1.19",
"MD1.20",
"MD1.21",
"MD1.22",
"MD2.1",
"MD2.2",
"MD2.3",
"MD2.4",
"MD2.5",
"MD2.6",
"MD2.7",
"MD2.8",
"MD2.9",
"MD2.10",
"MD2.11",
"MD2.12",
"MD2.13",
"MD2.14",
"MD2.15",
"MD2.16",
"MD2.17",
"MD2.18",
"MD2.19",
"MD2.20",
"MD2.21",
"MD2.22",
"MD2.23",
"MD2.24",
"MD2.25",
"MD2.26",
"MD2.27",
"MD2.28",
"MD3.1",
"MD3.2",
"MD3.3",
"MD3.4",
"MD3.5",
"MD3.6",
"MD3.7",
"MD3.8",
"MD3.9",
"MD3.10",
"MD3.11",
"MD3.12",
"MD3.13",
"MD3.14",
"MD3.15",
"MD3.16",
"MD3.17",
"MD3.18",
"MD3.19",
"MD4.1",
"MD4.2",
"MD4.3",
"MD4.4",
"MD4.5",
"MD4.6",
"MD4.7",
"MD4.8",
"MD4.9",
"MD4.10",
"MD4.11",
"MD5.1",
"MD5.2",
"MD5.3",
"MD5.4",
"MD5.5",
"MD6.1",
"MD6.2",
"MD6.3",
"MD6.4",
"MD6.5",
"MD6.6",
"MD6.7",
"MD6.8",
"MD6.9",
"MD6.10",
"MD6.11",
"MD6.12",
"MD6.13",
"MD6.14",
"MD6.15",
"MD6.16",
"MD6.17",
"MD6.18",
"MD6.19",
"MD6.20",
"MD7.1",
"MD7.2",
"MD7.3",
"MD7.4",
"MD7.5",
"MD7.6",
"MD7.7",
"MD7.8",
"MD7.9",
"MD7.10",
"MD7.11",
"MD7.12",
"MD7.13",
"MD7.14",
"MD7.15",
"MD8.1",
"MD8.2",
"MD8.3",
"MD9.1",
"MD9.2",
"MD9.3",
"MD9.4",
"MD9.5",
"MD9.6",
"MD9.7",
"MD9.8",
"MD9.9",
"MD9.10",
"MD9.11",
"MD10.1",
"MD10.2",
"MD10.3",
"MD10.4",
"MD10.5",
"MD10.6",
"MD10.7",
"MD10.8",
"MD10.9",
"MD10.10",
"MD10.11",
"MD10.12",
"MD10.13",
"MD10.14",
"MD10.15",
"MD10.16",
"MD10.17",
"MD11.1",
"MD11.2",
"MD11.3",
"MD11.4",
"MD11.5" FROM (
SELECT obj_type,start_time, obj_name,province,city_name,"MD1.1","MD1.2","MD1.3","MD1.4","MD1.5","MD1.6","MD10.10",
("MD1.8" / DECODE("MD1.9",0,NULL) * 100 ) "MD1.7",
("MD1.11" / DECODE("MD10.10" ,0,NULL)* 100 ) "MD1.10",
(100 * "MD1.20" / DECODE("MD1.19",0,NULL) / 1000) "MD1.18",
(("MD2.6" + "MD2.7") / DECODE(("MD2.4" + "MD2.5"),0,NULL) * 100 ) "MD2.1",
("MD2.6" / DECODE("MD2.4",0,NULL) * 100) "MD2.2",
("MD2.7" / DECODE("MD2.5",0,NULL) * 100) "MD2.3",
("MD2.9" / DECODE("MD2.10",0,NULL) * 100) "MD2.8",
(100 * "MD2.12" / DECODE(("MD2.4" + "MD2.5"),0,NULL) ) "MD2.11",
(100* ("MD2.19" + "MD2.20" + "MD2.21") / DECODE(("MD2.16" + "MD2.19" + "MD2.20" + "MD2.21"),0,NULL)) "MD2.22",
(100 * ("MD2.18" + "MD2.19" + "MD2.20" + "MD2.21") / DECODE(("MD2.16" + "MD2.19" + "MD2.20" + "MD2.21"),0,NULL)) "MD2.23",
("MD10.1" / DECODE(("MD2.6" + "MD2.7"),0,NULL)) "MD2.24",
("MD10.2" / DECODE(("MD2.6" + "MD2.7"),0,NULL)) "MD2.25",
("MD3.3" / DECODE("MD3.2",0,NULL) * 100) "MD3.1",
("MD10.3" / DECODE("MD3.3",0,NULL)) "MD3.5",
("MD3.7" / DECODE("MD3.8",0,NULL) * 100) "MD3.6",
("MD3.12" / DECODE(("MD3.12" + "MD3.13"),0,NULL) * 100) "MD3.11",
("MD3.16" /  DECODE("MD3.15",0,NULL) * 100) "MD3.14",
("MD4.3" / DECODE("MD4.2",0,NULL) * 100) "MD4.1",
("MD4.6" / DECODE("MD4.5",0,NULL) * 100) "MD4.4",
("MD4.10" / DECODE("MD4.9",0,NULL) * 100) "MD4.8",
("MD5.4" / DECODE("MD5.2" ,0,NULL)) "MD5.5",
(100 * "MD6.5" / DECODE("MD6.3",0,NULL) ) "MD6.7",
(100 * "MD6.6" / DECODE("MD6.4",0,NULL)) "MD6.8",
("MD10.4" / DECODE("MD10.5",0,NULL) * 100) "MD6.10",
("MD10.6" / DECODE("MD10.7",0,NULL) * 100) "MD6.12",
("MD10.14" / (DECODE("MD10.15",0,NULL) * 100)) "MD6.14",
("MD10.16" / DECODE("MD10.17",0,NULL) / 1000) "MD6.16",
("MD10.8" / DECODE(("MD10.8" + "MD10.9"),0,NULL) * 100) "MD6.20",
("MD7.3" / DECODE("MD7.2",0,NULL) * 100) "MD7.1",
(100 * "MD7.6" / DECODE("MD7.5",0,NULL)) "MD7.4",
(100 * "MD7.9" / DECODE("MD7.8",0,NULL)) "MD7.7",
(100 * "MD7.12" /DECODE( "MD7.11",0,NULL)) "MD7.10",
(100 * "MD7.15" /DECODE( "MD7.14",0,NULL)) "MD7.13",
("MD8.3" / DECODE("MD8.2",0,NULL) * 100) "MD8.1",
"MD1.8",
"MD1.9",
"MD1.11",
"MD1.12",
"MD1.13",
"MD1.14",
"MD1.15",
"MD1.16",
"MD1.17",
"MD1.19",
"MD1.20",
"MD1.21",
"MD1.22",
"MD2.4",
"MD2.5",
"MD2.6",
"MD2.7",
"MD2.9",
"MD2.10",
"MD2.12",
"MD2.13",
"MD2.14",
"MD2.15",
"MD2.16",
"MD2.17",
"MD2.18",
"MD2.19",
"MD2.20",
"MD2.21",
"MD2.26",
"MD2.27",
"MD2.28",
"MD3.2",
"MD3.3",
"MD3.4",
"MD3.7",
"MD3.8",
"MD3.9",
"MD3.10",
"MD3.12",
"MD3.13",
"MD3.15",
"MD3.16",
"MD3.17",
"MD3.18",
"MD3.19",
"MD4.2",
"MD4.3",
"MD4.5",
"MD4.6",
"MD4.7",
"MD4.9",
"MD4.10",
"MD4.11",
"MD6.1",
"MD6.2",
"MD6.3",
"MD5.1",
"MD5.2",
"MD5.3",
"MD5.4",
"MD6.4",
"MD6.5",
"MD6.6",
"MD6.9",
"MD6.11",
"MD6.13",
"MD6.15",
"MD10.16",
"MD10.17",
"MD6.17",
"MD6.18",
"MD6.19",
"MD7.2",
"MD7.3",
"MD7.5",
"MD7.6",
"MD7.8",
"MD7.9",
"MD7.11",
"MD7.12",
"MD7.14",
"MD7.15",
"MD8.2",
"MD8.3",
"MD9.1",
"MD9.2",
"MD9.3",
"MD9.4",
"MD9.5",
"MD9.6",
"MD9.7",
"MD9.8",
"MD9.9",
"MD9.10",
"MD9.11",
"MD10.1",
"MD10.3",
"MD10.4",
"MD10.5",
"MD10.6",
"MD10.7",
"MD10.8",
"MD10.9",
"MD10.11",
"MD10.13",
"MD10.14",
"MD10.2",
"MD10.12",
"MD10.15",
"MD11.1",
"MD11.2",
"MD11.3",
"MD11.4",
"MD11.5"
 FROM (SELECT a.obj_type,a.start_time, a.obj_name,a.province,a.city_name,"MD1.1","MD1.2","MD1.3","MD1.4","MD1.5","MD1.6","MD10.10",
null "MD1.12",
null "MD1.13",
null "MD1.14",
null "MD1.15",
null "MD1.16",
null "MD1.17",
null "MD1.21",
null "MD1.22",
null "MD6.19",
null "MD9.1",
null "MD9.2",
null "MD9.3",
null "MD9.4",
null "MD9.5",
null "MD9.6",
null "MD9.7",
null "MD9.8",
null "MD9.9",
null "MD9.10",
null "MD9.11",
null "MD11.1",
null "MD11.2",
null "MD11.3",
null "MD11.4",
null "MD11.5",
SUM(NULL) "MD2.26",
SUM(NULL) "MD2.27",
SUM(NULL) "MD2.28",
SUM(P167_ATCONNECTIONREQNUM) "MD8.3",
SUM(P167_BSSAPPAGINGNUM) "MD8.2",
AVG((P806_REVAFWDTCHSENDSLOTNUM+P806_RLS0FWDTCHSENDSLOTNUM)*1.667/3600000*100) "MD6.17",
AVG(100*P806_FWDCCHSENDSLOTNUM*1.667/1000/3600) "MD6.18",
AVG(P804_CALLDURATION/3600) "MD5.1",
SUM(P151_CMO_RTCHCAPFNUM+P168_CMO_RTCHCAPFNUM+P151_CMT_RTCHCAPFNUM+P168_CMT_RTCHCAPFNUM+P151_FMT_RTCHCAPFNUM+P168_FMT_RTCHCAPFNUM) "MD2.14",
SUM(P151_CMO_TCCTIMEOUTFNUM+P168_CMO_TCCTIMEOUTFNUM+P151_CMT_TCCTIMEOUTFNUM+P168_CMT_TCCTIMEOUTFNUM+P151_FMT_TCCTIMEOUTFNUM+P168_FMT_TCCTIMEOUTFNUM) "MD2.15",
SUM((P1412_REVRECEIVEBYTENUM-P1412_DWANREQUESTRETRANSMITBYT)*8.0/1000/3600) "MD6.11",
SUM((P1412_REVRECEIVEBYTENUM-P1412_DWANREQUESTRETRANSMITBYT)*8/1000/3600) "MD6.15",
SUM((P806_REVAFWDTCHPHYBYTES+P806_RLS0FWDTCHPHYBYTES)*8) "MD10.14",
SUM((P806_REVAFWDTCHSENDSLOTNUM+P806_RLS0FWDTCHSENDSLOTNUM)*1.667/1000) "MD10.15",
SUM((P807_REVAREVTCHPHYBYTES+P807_RLS0REVTCHPHYBYTES)*8) "MD10.16",
SUM((P841_DWFDISCARDPKTFORBUFLACK+P841_DWFDISCARDPKTFORMS+P841_DWFDISCARDPKTFOROTHERS)/1000) "MD6.6",
SUM((P841_DWPDSN2PCFPKTNUM+P841_DWFDISCARDPKTFORBUFLACK+P841_DWFDISCARDPKTFORMS+P841_DWFDISCARDPKTFOROTHERS)/1000) "MD6.4",
SUM((P841_DWSDU2PCFPKTNUM+P841_DWRDISCARDPKTFORBUFLACK+P841_DWRDISCARDPKTFORMS+P841_DWRDISCARDPKTFOROTHERS)/1000) "MD6.3",
SUM(P3051_E1NUM*2) "MD1.19",
SUM(P3051_AVGFLUX/2) "MD1.20",
SUM(NULL) "MD2.10",
SUM(P801_MO_WIRENETCALLSUCNUM+P801_MT_WIRENETSUCNUM+P819_MO_WIRENETCALLSUCNUM+P819_MT_WIRENETSUCNUM+P801_CMO_EXTINTERRUPTNUM+P801_CMT_EXTINTERRUPTNUM+P801_FMT_EXTINTERRUPTNUM+P819_CMO_EXTINTERRUPTNUM+P819_CMT_EXTINTERRUPTNUM+P819_FMT_EXTINTERRUPTNUM) "MD2.9",
SUM(P1412_DWANREQUESTRETRANSMITBYT) "MD10.6",
SUM(P1412_FWDRETRANSMITBYTES) "MD10.4",
SUM(P1412_FWDTRANSMITBYTES*8.0/1000/3600) "MD6.9",
SUM(P1412_FWDTRANSMITBYTES*8/1000/3600) "MD6.13",
SUM(P1412_FWDTRANSMITBYTES*8/1000/3600*1024) "MD10.5",
SUM(P1412_REVRECEIVEBYTENUM-P1412_DWANREQUESTRETRANSMITBYT) "MD10.7",
SUM(P1503_ACTIVESESSIONNUM) "MD3.18",
SUM(P1503_ACTIVESESSIONNUM+P1503_DORMANTSESSIONNUM) "MD3.17",
SUM(P1503_DORMANTSESSIONNUM) "MD3.19",
SUM(P151_CMO_BLOCKFNUM+P151_CMT_BLOCKFNUM+P151_FMT_BLOCKFNUM+P168_CMO_BLOCKFAILURENUM+P168_CMT_BLOCKFAILURENUM+P168_FMT_BLOCKFAILURENUM+P822_CMO_BLOCKFAILURENUM+P822_CMT_BLOCKFAILURENUM+P822_FMT_BLOCKFAILURENUM) "MD2.13",
SUM(P151_CMO_CALLSNUM+P151_CMO_EXTINTERRUPTNUM+P151_CMO_BLOCKFNUM+P151_CMO_OTHERFNUM+P151_CMO_RTCHCAPFNUM+P151_CMO_TCCTIMEOUTFNUM+P168_CMO_CALLSUCCESSNUM+P168_CMO_EXTINTERRUPTNUM+P168_CMO_BLOCKFAILURENUM+P168_CMO_OTHERFAILURENUM+P168_CMO_RTCHCAPFNUM+P168_CMO_TCCTIMEOUTFNUM+P822_CMO_EXTINTERRUPTNUM+P822_CMO_BLOCKFAILURENUM+P822_CMO_OTHERFAILURENUM) "MD2.4",
SUM(P151_CMO_CALLSNUM+P168_CMO_CALLSUCCESSNUM) "MD2.6",
SUM(P151_CMO_EXTINTERRUPTNUM+P168_CMO_EXTINTERRUPTNUM+P822_CMO_EXTINTERRUPTNUM+P151_CMT_EXTINTERRUPTNUM+P168_CMT_EXTINTERRUPTNUM+P151_FMT_EXTINTERRUPTNUM+P168_FMT_EXTINTERRUPTNUM+P822_CMT_EXTINTERRUPTNUM+P822_FMT_EXTINTERRUPTNUM) "MD2.12",
SUM(P151_CMT_CALLSNUM+P151_CMT_EXTINTERRUPTNUM+P151_CMT_BLOCKFNUM+P151_CMT_OTHERFNUM+P151_CMT_RTCHCAPFNUM+P151_CMT_TCCTIMEOUTFNUM+P168_CMT_CALLSUCCESSNUM+P168_CMT_EXTINTERRUPTNUM+P168_CMT_BLOCKFAILURENUM+P168_CMT_OTHERFAILURENUM+P168_CMT_RTCHCAPFNUM+P168_CMT_TCCTIMEOUTFNUM+P151_FMT_CALLSNUM+P151_FMT_EXTINTERRUPTNUM+P151_FMT_BLOCKFNUM+P151_FMT_OTHERFNUM+P151_FMT_RTCHCAPFNUM+P151_FMT_TCCTIMEOUTFNUM+P168_FMT_CALLSUCCESSNUM+P168_FMT_EXTINTERRUPTNUM+P168_FMT_BLOCKFAILURENUM+P168_FMT_OTHERFAILURENUM+P168_FMT_RTCHCAPFNUM+P168_FMT_TCCTIMEOUTFNUM+P822_CMT_EXTINTERRUPTNUM+P822_CMT_BLOCKFAILURENUM+P822_CMT_OTHERFAILURENUM+P822_FMT_EXTINTERRUPTNUM+P822_FMT_BLOCKFAILURENUM+P822_FMT_OTHERFAILURENUM) "MD2.5",
SUM(P151_CMT_CALLSNUM+P168_CMT_CALLSUCCESSNUM+P151_FMT_CALLSNUM+P168_FMT_CALLSUCCESSNUM) "MD2.7",
SUM(P152_SRCANTGTHO_IFRREQESTNUM) "MD7.11",
SUM(P152_SRCANTGTHO_IFRSUCCESSNUM) "MD7.12",
SUM(P152_SRCANTGTHO_SFRREQESTNUM+P152_SRCANTGTHO_SFTREQESTNUM+P152_SRCANTGTHO_AFRREQESTNUM) "MD7.5",
SUM(P152_SRCANTGTHO_SFRSUCCESSNUM+P152_SRCANTGTHO_SFTSUCCESSNUM+P152_SRCANTGTHO_AFRSUCCESSNUM) "MD7.6",
SUM(P152_SRCANTGTHO_SFTREQESTNUM+P152_INTERANTGTHOOUT_REQESTNUM) "MD7.2",
SUM(P152_SRCANTGTHO_SFTSUCCESSNUM+P152_INTERANTGTHOOUT_SUCCESSNU) "MD7.3",
SUM(P153_CONNECTTIME) "MD10.2",
SUM(P154_AUTHENTICATIONSNUM) "MD3.7",
SUM(P154_AUTHENTICATIONSNUM+P154_PPPNEGFNUM+P154_A12LINKFNUM+P154_OTHERFNUM+P154_ILLEGALUSERFNUM) "MD3.8",
SUM(P154_ILLEGALUSERFNUM) "MD3.9",
SUM(P154_PPPNEGFNUM+P154_A12LINKFNUM+P154_OTHERFNUM) "MD3.10",
SUM(P155_SESSIONSETUPFNUM) "MD3.4",
SUM(P156_SESSIONNEGOFNUM) "MD3.13",
SUM(P156_SESSIONNEGOSNUM) "MD3.12",
SUM(P158_A13DA_HANDOFFFNUM+P158_A13DD_HANDOFFFNUM+P158_A13DA_HANDOFFSNUM+P158_A13DD_HANDOFFSNUM) "MD3.15",
SUM(P158_A13DA_HANDOFFSNUM+P158_A13DD_HANDOFFSNUM) "MD3.16",
SUM(P159_DC_CALLSNUM) "MD4.6",
SUM(P159_DC_CALLSNUM+P159_DC_CALLFNUM) "MD4.5",
SUM(P159_DC_CALLSNUM+P159_DC_CALLFNUM+P159_PC_CALLSNUM+P159_PC_CALLFNUM) "MD4.2",
SUM(P159_DC_CALLSNUM+P159_DC_CALLFNUM-P159_DC_CALLSNUM) "MD4.7",
SUM(P159_DC_CALLSNUM+P159_PC_CALLSNUM) "MD4.3",
SUM(P159_PC_CALLSNUM) "MD4.10",
SUM(P159_PC_CALLSNUM+P159_PC_CALLFNUM) "MD4.9",
SUM(P159_PC_CALLSNUM+P159_PC_CALLFNUM-P159_PC_CALLSNUM) "MD4.11",
SUM(P406_CERELIABLENUM+P406_CE5500RELIABLENUM) "MD1.9",
SUM(P406_MAXBUSYCENUM) "MD1.8",
SUM(P801_SETUPTIME+P819_SETUPTIME) "MD10.1",
SUM(P802_INTERANSRCHOOUT_REQUESTNU+P826_INTERANTGTHOIN_REQESTNUM) "MD7.8",
SUM(P802_INTERANSRCHOOUT_SUCCESSNU+P826_INTERANTGTHOIN_SUCCESSNUM) "MD7.9",
SUM(P803_AIRLINKLOSTDROPNUM) "MD2.19",
SUM(P803_HHODROPNUM) "MD2.20",
SUM(P803_OTHERDROPNUM) "MD2.21",
SUM(P803_PDSNRELEASENUM) "MD2.18",
SUM(P803_RLSSNUM) "MD2.17",
SUM(P803_RLSSNUM+P803_PDSNRELEASENUM) "MD2.16",
SUM(P804_CALLDURATION/3600) "MD5.2",
SUM(P804_CALLDURATION/3600+P804_SHODURATION/3600) "MD5.3",
SUM(P804_SHODURATION/3600) "MD5.4",
SUM(P815_RABBUSYNUM) "MD10.8",
SUM(P815_RABFREENUM) "MD10.9",
SUM(P815_RevSlotNum*1.667/1000) "MD10.17",
SUM(P820_SETUPATTEMPTNUM) "MD3.2",
SUM(P820_SETUPSUCCESSNUM) "MD3.3",
SUM(P821_USERNUM) "MD1.11",
SUM(P825_HARDHOADD_REQESTNUM) "MD7.14",
SUM(P825_HARDHOADD_SUCCESSNUM) "MD7.15",
SUM(P840_RANGE1REQNUM) "MD10.11",
SUM(P840_RANGE2REQNUM+P840_RANGE3REQNUM) "MD10.12",
SUM(P840_RANGE4REQNUM) "MD10.13",
SUM(P841_DWPDSN2PCFFLUX/1024/1024) "MD6.2",
SUM(P841_dwRDiscardPktforBufLack+P841_dwRDiscardPktforMS+P841_dwRDiscardPktforOthers) "MD6.5",
SUM(P841_DWSDU2PCFFLUX/1024/1024) "MD6.1",
SUM(P801_SETUPTIME+P819_SETUPTIME) "MD10.3"--,
--SUM(每载扇115，往上汇聚) "MD10.10"
FROM (
SELECT '城市' obj_type,to_date('&start_time','yyyy-mm-dd HH24:mi:ss') start_time, city_name obj_name,null province,city_name ,city_id,
(SELECT COUNT(DISTINCT RELATED_BTS) FROM NE_CARRIER_C WHERE  bustype='DO' AND CITY_ID=x.City_Id) "MD1.1",
(SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)=1) AND CITY_ID=x.City_Id)  "MD1.2",
 (SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)=2) AND CITY_ID=x.City_Id) "MD1.3",
 (SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)=3) AND CITY_ID=x.City_Id)"MD1.4",
 (SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)>=4) AND CITY_ID=x.City_Id)"MD1.5",
(SELECT COUNT(*) FROM ne_carrier_c WHERE   bustype='DO'  AND  CITY_ID=x.City_Id) "MD1.6",
(SELECT COUNT(*) FROM ne_carrier_c WHERE   bustype='DO'  AND   CITY_ID=x.City_Id)*115 "MD10.10"
 FROM CFG_CITY  X
) A,
DS_COUNTER_GROUP_ZTE_BB_DO_1 C,
DS_COUNTER_GROUP_ZTE_PB_1 E,
DS_COUNTER_GROUP_ZTE_SB_1 F,
DS_COUNTER_GROUP_ZTE_TB_DO_1 H
WHERE A.city_ID=C.city_ID(+) AND 
      A.city_ID=E.city_ID(+) AND 
      A.city_ID=F.city_ID(+) AND 
      A.city_ID=H.city_ID(+) AND 
      A.START_TIME=C.START_TIME(+)  AND
      A.START_TIME=E.START_TIME(+)  AND
      A.START_TIME=F.START_TIME(+) AND
      A.START_TIME=H.START_TIME(+)   
      GROUP BY a.obj_type,a.start_time, a.obj_name,a.province,a.city_name,"MD1.1","MD1.2","MD1.3","MD1.4","MD1.5","MD1.6","MD10.10",
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null)) UNION ALL
SELECT obj_type,start_time, obj_name,province,city_name,
"MD1.1",
"MD1.2",
"MD1.3",
"MD1.4",
"MD1.5",
"MD1.6",
"MD1.7",
"MD1.8",
"MD1.9",
"MD1.10",
"MD1.11",
"MD1.12",
"MD1.13",
"MD1.14",
"MD1.15",
"MD1.16",
"MD1.17",
"MD1.18",
"MD1.19",
"MD1.20",
"MD1.21",
"MD1.22",
"MD2.1",
"MD2.2",
"MD2.3",
"MD2.4",
"MD2.5",
"MD2.6",
"MD2.7",
"MD2.8",
"MD2.9",
"MD2.10",
"MD2.11",
"MD2.12",
"MD2.13",
"MD2.14",
"MD2.15",
"MD2.16",
"MD2.17",
"MD2.18",
"MD2.19",
"MD2.20",
"MD2.21",
"MD2.22",
"MD2.23",
"MD2.24",
"MD2.25",
"MD2.26",
"MD2.27",
"MD2.28",
"MD3.1",
"MD3.2",
"MD3.3",
"MD3.4",
"MD3.5",
"MD3.6",
"MD3.7",
"MD3.8",
"MD3.9",
"MD3.10",
"MD3.11",
"MD3.12",
"MD3.13",
"MD3.14",
"MD3.15",
"MD3.16",
"MD3.17",
"MD3.18",
"MD3.19",
"MD4.1",
"MD4.2",
"MD4.3",
"MD4.4",
"MD4.5",
"MD4.6",
"MD4.7",
"MD4.8",
"MD4.9",
"MD4.10",
"MD4.11",
"MD5.1",
"MD5.2",
"MD5.3",
"MD5.4",
"MD5.5",
"MD6.1",
"MD6.2",
"MD6.3",
"MD6.4",
"MD6.5",
"MD6.6",
"MD6.7",
"MD6.8",
"MD6.9",
"MD6.10",
"MD6.11",
"MD6.12",
"MD6.13",
"MD6.14",
"MD6.15",
"MD6.16",
"MD6.17",
"MD6.18",
"MD6.19",
"MD6.20",
"MD7.1",
"MD7.2",
"MD7.3",
"MD7.4",
"MD7.5",
"MD7.6",
"MD7.7",
"MD7.8",
"MD7.9",
"MD7.10",
"MD7.11",
"MD7.12",
"MD7.13",
"MD7.14",
"MD7.15",
"MD8.1",
"MD8.2",
"MD8.3",
"MD9.1",
"MD9.2",
"MD9.3",
"MD9.4",
"MD9.5",
"MD9.6",
"MD9.7",
"MD9.8",
"MD9.9",
"MD9.10",
"MD9.11",
"MD10.1",
"MD10.2",
"MD10.3",
"MD10.4",
"MD10.5",
"MD10.6",
"MD10.7",
"MD10.8",
"MD10.9",
"MD10.10",
"MD10.11",
"MD10.12",
"MD10.13",
"MD10.14",
"MD10.15",
"MD10.16",
"MD10.17",
"MD11.1",
"MD11.2",
"MD11.3",
"MD11.4",
"MD11.5" FROM (
SELECT obj_type,start_time, obj_name,province,city_name,"MD1.1","MD1.2","MD1.3","MD1.4","MD1.5","MD1.6",
("MD1.8" / DECODE("MD1.9",0,NULL) * 100 ) "MD1.7",
("MD1.11" / DECODE("MD10.10" ,0,NULL)* 100 ) "MD1.10",
(100 * "MD1.20" / DECODE("MD1.19" ,0,NULL)/ 1000) "MD1.18",
(("MD2.6" + "MD2.7") / DECODE(("MD2.4" + "MD2.5"),0,NULL) * 100 ) "MD2.1",
("MD2.6" / DECODE("MD2.4",0,NULL) * 100) "MD2.2",
("MD2.7" / DECODE("MD2.5",0,NULL) * 100) "MD2.3",
("MD2.9" / DECODE("MD2.10",0,NULL) * 100) "MD2.8",
(100 * "MD2.12" / DECODE(("MD2.4" + "MD2.5"),0,NULL) ) "MD2.11",
("MD2.16" - "MD2.18") "MD2.17",
(100* ("MD2.19" + "MD2.20" + "MD2.21") / DECODE(("MD2.16" + "MD2.19" + "MD2.20" + "MD2.21"),0,NULL)) "MD2.22",
(100 * ("MD2.18" + "MD2.19" + "MD2.20" + "MD2.21") / DECODE(("MD2.16" + "MD2.19" + "MD2.20" + "MD2.21"),0,NULL)) "MD2.23",
("MD3.3" / DECODE("MD3.2",0,NULL) * 100) "MD3.1",
("MD3.7" / DECODE("MD3.8",0,NULL) * 100) "MD3.6",
("MD3.12" / DECODE(("MD3.12" + "MD3.13") ,0,NULL)* 100) "MD3.11",
("MD3.16" /  DECODE("MD3.15",0,NULL) * 100) "MD3.14",
("MD4.3" / DECODE("MD4.2",0,NULL) * 100) "MD4.1",
("MD4.6" / DECODE("MD4.5" ,0,NULL)* 100) "MD4.4",
("MD4.10" / DECODE("MD4.9",0,NULL) * 100) "MD4.8",
("MD5.4" / DECODE("MD5.2" ,0,NULL)) "MD5.5",
(100 * "MD6.5" / DECODE("MD6.3",0,NULL) ) "MD6.7",
(100 * "MD6.6" / DECODE("MD6.4",0,NULL)) "MD6.8",
("MD10.4" / DECODE("MD10.5",0,NULL) * 100) "MD6.10",
("MD10.6" / DECODE("MD10.7",0,NULL) * 100) "MD6.12",
("MD10.14" / (DECODE("MD10.15",0,NULL)* 100)) "MD6.14",
("MD10.16" / DECODE("MD10.17" ,0,NULL)/ 1000) "MD6.16",
("MD10.8" / DECODE(("MD10.8" + "MD10.9"),0,NULL) * 100) "MD6.20",
("MD7.3" / DECODE("MD7.2" ,0,NULL)* 100) "MD7.1",
(100 * "MD7.6" / DECODE("MD7.5",0,NULL)) "MD7.4",
(100 * "MD7.9" / DECODE("MD7.8",0,NULL)) "MD7.7",
(100 * "MD7.12" / DECODE("MD7.11",0,NULL)) "MD7.10",
(100 * "MD7.15" / DECODE("MD7.14",0,NULL)) "MD7.13",
("MD8.3" / DECODE("MD8.2",0,NULL) * 100) "MD8.1",
"MD1.8",
"MD1.9",
"MD1.11",
"MD1.12",
"MD1.13",
"MD1.14",
"MD1.15",
"MD1.16",
"MD1.17",
"MD1.19",
"MD1.20",
"MD1.21",
"MD1.22",
"MD2.4",
"MD2.5",
"MD2.6",
"MD2.7",
"MD2.9",
"MD2.10",
"MD2.12",
"MD2.13",
"MD2.14",
"MD2.15",
"MD2.16",
"MD2.18",
"MD2.19",
"MD2.20",
"MD2.21",
"MD2.24",
"MD2.25",
"MD2.26",
"MD2.27",
"MD2.28",
"MD3.2",
"MD3.3",
"MD3.4",
"MD3.5",
"MD3.7",
"MD3.8",
"MD3.9",
"MD3.10",
"MD3.12",
"MD3.13",
"MD3.15",
"MD3.16",
"MD3.17",
"MD3.18",
"MD3.19",
"MD4.2",
"MD4.3",
"MD4.5",
"MD4.6",
"MD4.7",
"MD4.9",
"MD4.10",
"MD4.11",
"MD6.1",
"MD6.2",
"MD6.3",
"MD5.1",
"MD5.2",
"MD5.3",
"MD5.4",
"MD6.4",
"MD6.5",
"MD6.6",
"MD6.9",
"MD6.11",
"MD6.13",
"MD6.15",
"MD10.16",
"MD10.17",
"MD6.17",
"MD6.18",
"MD6.19",
"MD7.2",
"MD7.3",
"MD7.5",
"MD7.6",
"MD7.8",
"MD7.9",
"MD7.11",
"MD7.12",
"MD7.14",
"MD7.15",
"MD8.2",
"MD8.3",
"MD9.1",
"MD9.2",
"MD9.3",
"MD9.4",
"MD9.5",
"MD9.6",
"MD9.7",
"MD9.8",
"MD9.9",
"MD9.10",
"MD9.11",
"MD10.1",
"MD10.3",
"MD10.4",
"MD10.5",
"MD10.6",
"MD10.7",
"MD10.8",
"MD10.9",
"MD10.10",
"MD10.11",
"MD10.13",
"MD10.14",
"MD10.2",
"MD10.12",
"MD10.15",
"MD11.1",
"MD11.2",
"MD11.3",
"MD11.4",
"MD11.5"
 FROM (SELECT a.obj_type,a.start_time, a.obj_name,a.province,a.city_name,"MD1.1","MD1.2","MD1.3","MD1.4","MD1.5","MD1.6",
null "MD1.12",
null "MD1.13",
null "MD1.14",
null "MD1.15",
null "MD1.16",
null "MD1.17",
null "MD1.21",
null "MD1.22",
null "MD3.15",
null "MD3.16",
null "MD10.16",
null "MD9.1",
null "MD9.2",
null "MD9.3",
null "MD9.4",
null "MD9.5",
null "MD9.6",
null "MD9.7",
null "MD9.8",
null "MD9.9",
null "MD9.10",
null "MD9.11",
null "MD10.8",
null "MD10.9",
null "MD10.14",
null "MD10.15",
null "MD11.1",
null "MD11.2",
null "MD11.3",
null "MD11.4",
null "MD11.5",
SUM(COUNTER_1157629081) "MD8.3",
SUM(COUNTER_1157629081+COUNTER_1157632436) "MD8.2",
SUM(NULL) "MD2.26",
SUM(NULL) "MD2.27",
SUM(NULL) "MD2.28",
AVG((COUNTER_1157630288+COUNTER_1157630289+COUNTER_1157630294+COUNTER_1157630290+COUNTER_1157630295+COUNTER_1157630299+COUNTER_1157630291+COUNTER_1157630296+COUNTER_1157630300+COUNTER_1157630303+COUNTER_1157631870+COUNTER_1157631871+COUNTER_1157632138+COUNTER_1157632139+COUNTER_1157630273+COUNTER_1157632140+COUNTER_1157630274+COUNTER_1157630278+COUNTER_1157632141+COUNTER_1157630275+COUNTER_1157630279+COUNTER_1157630282+COUNTER_1157631866+COUNTER_1157631867)/3600) "MD5.1",
AVG(COUNTER_1157631280) "MD3.5",
AVG(COUNTER_1157633272) "MD2.25",
AVG(COUNTER_1157633274) "MD2.24",
AVG(COUNTER_1166017182/100) "MD6.17",
AVG(NULL) "MD6.19",
AVG(NULL) "MD6.18",
SUM((COUNTER_1157630288+COUNTER_1157630289+COUNTER_1157630294+COUNTER_1157630290+COUNTER_1157630295+COUNTER_1157630299+COUNTER_1157630291+COUNTER_1157630296+COUNTER_1157630300+COUNTER_1157630303+COUNTER_1157631870+COUNTER_1157631871+COUNTER_1157632138+COUNTER_1157632139+COUNTER_1157630273+COUNTER_1157632140+COUNTER_1157630274+COUNTER_1157630278+COUNTER_1157632141+COUNTER_1157630275+COUNTER_1157630279+COUNTER_1157630282+COUNTER_1157631866+COUNTER_1157631867)/3600) "MD5.2",
SUM((COUNTER_1157631868+COUNTER_1157631869*2+(COUNTER_1157630299+COUNTER_1157630300+COUNTER_1157630301+COUNTER_1157630302)*3+(COUNTER_1157630303+COUNTER_1157630304+COUNTER_1157630305)*4+(COUNTER_1157630306+COUNTER_1157630307)*5+COUNTER_1157630308*6+COUNTER_1157631864+COUNTER_1157631865*2+(COUNTER_1157630278+COUNTER_1157630279+COUNTER_1157630280+COUNTER_1157630281)*3+(COUNTER_1157630282+COUNTER_1157630283+COUNTER_1157630284)*4+(COUNTER_1157630285+COUNTER_1157630286)*5+COUNTER_1157630287*6)/3600-(COUNTER_1157630288+COUNTER_1157630289+COUNTER_1157630294+COUNTER_1157630290+COUNTER_1157630295+COUNTER_1157630299+COUNTER_1157630291+COUNTER_1157630296+COUNTER_1157630300+COUNTER_1157630303+COUNTER_1157631870+COUNTER_1157631871+COUNTER_1157632138+COUNTER_1157632139+COUNTER_1157630273+COUNTER_1157632140+COUNTER_1157630274+COUNTER_1157630278+COUNTER_1157632141+COUNTER_1157630275+COUNTER_1157630279+COUNTER_1157630282+COUNTER_1157631866+COUNTER_1157631867)/3600) "MD5.4",
SUM((COUNTER_1157631868+COUNTER_1157631869*2+(COUNTER_1157630299+COUNTER_1157630300+COUNTER_1157630301+COUNTER_1157630302)*3+(COUNTER_1157630303+COUNTER_1157630304+COUNTER_1157630305)*4+(COUNTER_1157630306+COUNTER_1157630307)*5+COUNTER_1157630308*6+COUNTER_1157631864+COUNTER_1157631865*2+(COUNTER_1157630278+COUNTER_1157630279+COUNTER_1157630280+COUNTER_1157630281)*3+(COUNTER_1157630282+COUNTER_1157630283+COUNTER_1157630284)*4+(COUNTER_1157630285+COUNTER_1157630286)*5+COUNTER_1157630287*6)/3600) "MD5.3",
SUM((COUNTER_1157631896+COUNTER_1157631897/2+(COUNTER_1157630437+COUNTER_1157630443+COUNTER_1157630448+COUNTER_1157630452)/3+(COUNTER_1157630438+COUNTER_1157630444+COUNTER_1157630449)/4+(COUNTER_1157630439+COUNTER_1157630445)/5+COUNTER_1157630440/6+COUNTER_1157631900+COUNTER_1157631901/2+(COUNTER_1157630458+COUNTER_1157630464+COUNTER_1157630469+COUNTER_1157630472)/3+(COUNTER_1157630459+COUNTER_1157630465+COUNTER_1157630470)/4+(COUNTER_1157630460+COUNTER_1157630466)/5+COUNTER_1157630461/6+COUNTER_1157631904+COUNTER_1157631905/2+(COUNTER_1157630478+COUNTER_1157630484+COUNTER_1157630489+COUNTER_1157630493)/3+(COUNTER_1157630479+COUNTER_1157630485+COUNTER_1157630490)/4+(COUNTER_1157630480+COUNTER_1157630486)/5+COUNTER_1157630481/6+COUNTER_1157631908+COUNTER_1157631909/2+(COUNTER_1157630499+COUNTER_1157630505+COUNTER_1157630510+COUNTER_1157630514)/3+(COUNTER_1157630500+COUNTER_1157630506+COUNTER_1157630511)/4+(COUNTER_1157630501+COUNTER_1157630507)/5+COUNTER_1157630502/6+COUNTER_1157631912+COUNTER_1157631913/2+(COUNTER_1157630520+COUNTER_1157630526+COUNTER_1157630531+COUNTER_1157630535)/3+(COUNTER_1157630521+COUNTER_1157630527+COUNTER_1157630532)/4+(COUNTER_1157630522+COUNTER_1157630528)/5+COUNTER_1157630523/6+COUNTER_1157631916+COUNTER_1157631917/2+(COUNTER_1157630541+COUNTER_1157630547+COUNTER_1157630552+COUNTER_1157630556)/3+(COUNTER_1157630542+COUNTER_1157630548+COUNTER_1157630553)/4+(COUNTER_1157630543+COUNTER_1157630549)/5+COUNTER_1157630544/6+COUNTER_1157631920+COUNTER_1157631921/2+(COUNTER_1157630562+COUNTER_1157630568+COUNTER_1157630573+COUNTER_1157630577)/3+(COUNTER_1157630563+COUNTER_1157630569+COUNTER_1157630574)/4+(COUNTER_1157630564+COUNTER_1157630570)/5+COUNTER_1157630565/6+COUNTER_1157631924+COUNTER_1157631925/2+(COUNTER_1157630583+COUNTER_1157630589+COUNTER_1157630594+COUNTER_1157630598)/3+(COUNTER_1157630584+COUNTER_1157630590+COUNTER_1157630595)/4+(COUNTER_1157630585+COUNTER_1157630591)/5+COUNTER_1157630586/6)*(COUNTER_1157631069+COUNTER_1157631075)) "MD10.2",
SUM((COUNTER_1157632102*1024-COUNTER_1157631293)*8/1000/3600) "MD6.15",
SUM(1000*COUNTER_1166022267) "MD10.17",
SUM(COUNTER_1157628180) "MD4.5",
SUM(COUNTER_1157628180+COUNTER_1157628182) "MD4.2",
SUM(COUNTER_1157628180-COUNTER_1157628181) "MD4.7",
SUM(COUNTER_1157628181) "MD4.6",
SUM(COUNTER_1157628181+COUNTER_1157628183) "MD4.3",
SUM(COUNTER_1157628182) "MD4.9",
SUM(COUNTER_1157628182-COUNTER_1157628183) "MD4.11",
SUM(COUNTER_1157628183) "MD4.10",
SUM(COUNTER_1157628189) "MD6.4",
SUM(COUNTER_1157628190/1024/1024) "MD6.2",
SUM(COUNTER_1157628191+COUNTER_1157628192+COUNTER_1157628193) "MD6.6",
SUM(COUNTER_1157628882) "MD6.3",
SUM(COUNTER_1157628883/1024/1024) "MD6.1",
SUM(COUNTER_1157628884) "MD6.5",
SUM(COUNTER_1157629067+COUNTER_1157629069+COUNTER_1157629070) "MD3.4",
SUM(COUNTER_1157629073) "MD3.8",
SUM(COUNTER_1157629073-COUNTER_1157629074-COUNTER_1157629075) "MD3.10",
SUM(COUNTER_1157629074) "MD3.7",
SUM(COUNTER_1157629075) "MD3.9",
SUM(COUNTER_1157629082) "MD3.18",
SUM(COUNTER_1157629082+COUNTER_1157629084) "MD3.17",
SUM(COUNTER_1157629084) "MD3.19",
SUM(COUNTER_1157629099) "MD3.2",
SUM(COUNTER_1157629100) "MD3.3",
SUM(COUNTER_1157629154) "MD7.5",
SUM(COUNTER_1157629154+COUNTER_1157632228+COUNTER_1157632229) "MD7.2",
SUM(COUNTER_1157629155) "MD7.6",
SUM(COUNTER_1157629155+COUNTER_1157632230+COUNTER_1157632231) "MD7.3",
SUM(COUNTER_1157631068) "MD2.4",
SUM(COUNTER_1157631069) "MD2.6",
SUM(COUNTER_1157631071+COUNTER_1157631077+COUNTER_1157631083) "MD2.14",
SUM(COUNTER_1157631074) "MD2.5",
SUM(COUNTER_1157631075) "MD2.7",
SUM(COUNTER_1157631078+COUNTER_1157631072+COUNTER_1157631084) "MD2.15",
SUM(COUNTER_1157631082+COUNTER_1157631070+COUNTER_1157631076) "MD2.13",
SUM(COUNTER_1157631115*(COUNTER_1157631069+COUNTER_1157631075)) "MD10.1",
SUM(COUNTER_1157631124) "MD2.20",
SUM(COUNTER_1157631280*COUNTER_1157629066) "MD10.3",
SUM(COUNTER_1157631288) "MD7.11",
SUM(COUNTER_1157631289) "MD7.12",
SUM(COUNTER_1157631293*1024) "MD10.6",
SUM(COUNTER_1157631536+COUNTER_1157631541) "MD7.15",
SUM(COUNTER_1157631540+COUNTER_1157631535) "MD7.14",
SUM(COUNTER_1157632100*1000) "MD10.5",
SUM(COUNTER_1157632100*1000*1024/1000*8/1000/3600) "MD6.13",
SUM(COUNTER_1157632100*1000*8/1000/3600) "MD6.9",
SUM(COUNTER_1157632101) "MD10.4",
SUM(COUNTER_1157632102*1024) "MD10.7",
SUM(COUNTER_1157632102*8/3600) "MD6.11",
SUM(COUNTER_1157632229+COUNTER_1157632228) "MD7.8",
SUM(COUNTER_1157632231+COUNTER_1157632230) "MD7.9",
SUM(COUNTER_1157632565-COUNTER_1157632567) "MD3.13",
SUM(COUNTER_1157632567) "MD3.12",
SUM(COUNTER_1157633258) "MD2.12",
SUM(Counter_1157633259) "MD2.18",
SUM(COUNTER_1157633260) "MD2.21",
SUM(COUNTER_1157633261) "MD2.19",
SUM(COUNTER_1157633262) "MD2.16",
SUM(COUNTER_1166017251+COUNTER_1166017252+COUNTER_1166017253) "MD10.11",
SUM(COUNTER_1166017254+COUNTER_1166017255+COUNTER_1166017256+COUNTER_1166017257+COUNTER_1166017258+COUNTER_1166017259+COUNTER_1166017260) "MD10.12",
SUM(COUNTER_1166017261+COUNTER_1166017262) "MD10.13",
SUM(COUNTER_1166017334) "MD10.10",
SUM(COUNTER_1166017335+COUNTER_1166017337) "MD1.11",
SUM(COUNTER_1166024758) "MD1.8",
SUM(COUNTER_1166024818) "MD1.9",
SUM(COUNTER_1166028939+COUNTER_1166028947) "MD1.19",
SUM(COUNTER_1166028942+COUNTER_1166028950) "MD1.20",
SUM(NULL) "MD2.10",
SUM(NULL) "MD2.9"
FROM (
SELECT '城市' obj_type,to_date('&start_time','yyyy-mm-dd HH24:mi:ss') start_time, city_name obj_name,null province,city_name ,city_id,
(SELECT COUNT(DISTINCT RELATED_BTS) FROM NE_CARRIER_C WHERE  bustype='DO' AND CITY_ID=x.City_Id) "MD1.1",
(SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)=1) AND CITY_ID=x.City_Id)  "MD1.2",
 (SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)=2) AND CITY_ID=x.City_Id) "MD1.3",
 (SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)=3) AND CITY_ID=x.City_Id)"MD1.4",
 (SELECT COUNT(*) FROM ne_bts_c WHERE ne_sys_id IN ( 
SELECT related_bts FROM ne_carrier_c WHERE  bustype='DO' GROUP BY related_bts
HAVING COUNT(*)>=4) AND CITY_ID=x.City_Id)"MD1.5",
(SELECT COUNT(*) FROM ne_carrier_c WHERE   bustype='DO'  AND CITY_ID=x.City_Id) "MD1.6",
(SELECT COUNT(*) FROM ne_carrier_c WHERE   bustype='DO'  AND   CITY_ID=x.City_Id)*115 "MD10.10"
 FROM CFG_CITY  X
) A,
DS_COUNTER_GROUP_HW_BB_3 D,
DS_COUNTER_GROUP_HW_PB_1 E,
DS_COUNTER_GROUP_HW_SB_1 F,
DS_COUNTER_GROUP_HW_TB_DO_1 J
WHERE  A.CITY_ID=D.CITY_ID(+) AND 
      A.CITY_ID=E.CITY_ID(+) AND 
      A.CITY_ID=F.CITY_ID(+) AND 
      A.CITY_ID=J.CITY_ID(+) and
      A.START_TIME=D.START_TIME(+)  AND
      A.START_TIME=E.START_TIME(+)  AND
      A.START_TIME=F.START_TIME(+)  AND
      A.START_TIME=J.START_TIME(+)   
      GROUP BY a.obj_type,a.start_time, a.obj_name,a.province,a.city_name,"MD1.1","MD1.2","MD1.3","MD1.4","MD1.5","MD1.6",
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null,
null)))
GROUP BY ROLLUP(obj_type,start_time, obj_name,province,city_name)
HAVING NOT (obj_type IS NOT NULL AND  city_name IS NULL);

