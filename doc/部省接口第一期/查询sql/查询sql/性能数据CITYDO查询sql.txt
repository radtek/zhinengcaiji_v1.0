
--CITY级别DO
  --非资源类
    SELECT *  FROM (select '城市' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
c.CITY_NAME as b2,'广东' as b3,c.CITY_NAME as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,CASE WHEN SUM(RCE_RLB_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RCE_MAX_BUSY_NUM_DO)/SUM(RCE_RLB_NUM_DO) * 100,2) END as ID7,SUM(RCE_MAX_BUSY_NUM_DO) as ID8,SUM(RCE_RLB_NUM_DO) as ID9,null as ID10,SUM(FWD_MACINDEX_MAX_NUM_DO) as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN SUM(nvl(DO_CONN_ATT,0))=0 THEN 0 WHEN SUM(nvl(DO_SUC_CONN_NUM,0))>=SUM(nvl(DO_CONN_ATT,0)) THEN 99.99 ELSE ROUND(SUM(nvl(DO_SUC_CONN_NUM,0)) / SUM(nvl(DO_CONN_ATT,0)) * 100, 2) END as ID23,DECODE(SUM(AT_CONN_ATT_DO),0,0,ROUND(SUM(AT_CONN_SUC_DO)/SUM(AT_CONN_ATT_DO),4)*100) as ID24,DECODE(SUM(AN_CONN_ATT_DO),0,0,ROUND(SUM(AN_CONN_SUC_DO)/SUM(AN_CONN_ATT_DO),4)*100) as ID25,SUM(nvl(AT_CONN_ATT_DO,0)) as ID26,SUM(nvl(AN_CONN_ATT_DO,0)) as ID27,SUM(nvl(AT_CONN_SUC_DO,0)) as ID28,SUM(nvl(AN_CONN_SUC_DO,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,SUM(CONN_SETUP_FAILED_RESF_DO) as ID35,SUM(CONN_SETUP_FAILED_FEVF_DO) as ID36,SUM(CONN_SETUP_FAILED_NOTCC_DO) as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,null as ID39,null as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN (SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))=0 THEN 0 ELSE ROUND((SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))/(SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100,2) END as ID45,SUM(DO_CONN_SETUP_TIME) as ID46,SUM(DO_CONN_OCCUPANCY_TIME) as ID47,CASE WHEN (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO))=0 THEN 0 ELSE ROUND(SUM(DRC_FWD_LESS_3072_DO) / (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO)) * 100, 2) END as ID48,CASE WHEN (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO))=0 THEN 0 ELSE ROUND(SUM(DRC_FWD_3072_1228_DO) / (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO)) * 100, 2) END as ID49,CASE WHEN (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO))=0 THEN 0 ELSE ROUND(SUM(DRC_FWD_MORE_1228_DO) / (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO)) * 100, 2) END as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))>=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(UATI_ATT_FAILED_NUM_DO) as ID54,SUM(UATI_AVG_SETUP_DURATION_DO) as ID55,CASE WHEN SUM(AUTH_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AUTH_SUC_DO) / SUM(AUTH_ATT_DO) * 100, 2) END as ID56,SUM(AUTH_SUC_DO) as ID57,SUM(AUTH_ATT_DO) as ID58,SUM(AUTH_DENY_NUM_DO) as ID59,SUM(AUTH_FAILED_NUM_DO) as ID60,CASE WHEN (SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO) / (SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)) * 100, 2) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,null as ID64,null as ID65,null as ID66,SUM(SESSION_ACTIVE_NUM_DO)+SUM(SESSION_NON_ACTIVE_NUM_DO) as ID67,SUM(SESSION_ACTIVE_NUM_DO) as ID68,SUM(SESSION_NON_ACTIVE_NUM_DO) as ID69,CASE WHEN (SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO)) /(SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO)) * 100, 2) END as ID70,SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO) + SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO) / SUM(AT_DOR2ACT_ATT_DO) * 100, 2) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AN_DOR2ACT_SUC_DO) / SUM(AN_DOR2ACT_ATT_DO) * 100, 2) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(TRAFFIC_DO_COMMON) as ID81,SUM(TRAFFIC_DO_COMMON) as ID82,ROUND((SUM(TRAFFIC_CE_TIME_DO) + SUM(TRAFFIC_CE_TIME_DO0)) / 3600,4) as ID83,ROUND((SUM(TRAFFIC_CE_TIME_DO) + SUM(TRAFFIC_CE_TIME_DO0)) / 3600,4)-SUM(TRAFFIC_DO_COMMON) as ID84,CASE WHEN SUM(TRAFFIC_DO_COMMON)=0 THEN 0 ELSE ROUND((ROUND((SUM(TRAFFIC_CE_TIME_DO) + SUM(TRAFFIC_CE_TIME_DO0)) / 3600,4)-SUM(TRAFFIC_DO_COMMON)) / SUM(TRAFFIC_DO_COMMON) * 100, 2) END as ID85,SUM(REV_THROUGHOUT_PCF_DO) as ID86,SUM(FWD_THROUGHOUT_PCF_DO) as ID87,SUM(REV_PAK_TOTAL_NUM_DO) as ID88,SUM(FWD_PAK_TOTAL_NUM_DO) as ID89,SUM(REV_PAK_DISCARD_NUM_DO) as ID90,SUM(FWD_PAK_DISCARD_NUM_DO) as ID91,CASE WHEN SUM(REV_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(REV_PAK_DISCARD_NUM_DO) / SUM(REV_PAK_TOTAL_NUM_DO) * 100, 2) END as ID92,CASE WHEN SUM(FWD_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(FWD_PAK_DISCARD_NUM_DO) / SUM(FWD_PAK_TOTAL_NUM_DO) * 100, 2) END as ID93,ROUND(SUM(FTCH_RLP_TX_DO) * 8 / 1000 / 3600,4) as ID94,CASE WHEN SUM(FTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO) / SUM(FTCH_RLP_TX_DO) * 100, 2) END as ID95,ROUND(SUM(RTCH_RLP_TX_DO) * 8 / 3600,4) as ID96,CASE WHEN SUM(RTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(RTCH_RLP_RETX_DO) / SUM(RTCH_RLP_TX_DO)/1024 * 100, 2) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,null as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,null as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),3) as ID102,null as ID103,null as ID104,null as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))>=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,CASE WHEN SUM(INN_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_BS_SHO_SUC_DO) / SUM(INN_BS_SHO_ATT_DO) * 100, 2) END as ID109,SUM(INN_BS_SHO_ATT_DO) as ID110,SUM(INN_BS_SHO_SUC_DO) as ID111,CASE WHEN SUM(INTER_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_BS_SHO_SUC_DO)/SUM(INTER_BS_SHO_ATT_DO),4) END as ID112,SUM(INTER_BS_SHO_ATT_DO) as ID113,SUM(INTER_BS_SHO_SUC_DO) as ID114,DECODE(SUM(INN_AN_HHO_ATT_DO),0,0,ROUND(SUM(INN_AN_HHO_SUC_DO)/SUM(INN_AN_HHO_ATT_DO),4)*100) as ID115,SUM(INN_AN_HHO_ATT_DO) as ID116,SUM(INN_AN_HHO_SUC_DO) as ID117,CASE WHEN (SUM(INTER_AN_HHO_OUT_ATT_DO)+SUM(INTER_AN_HHO_IN_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(INTER_AN_HHO_IN_SUC_DO)+SUM(INTER_AN_HHO_OUT_SUC_DO)) / (SUM(INTER_AN_HHO_OUT_ATT_DO)+SUM(INTER_AN_HHO_IN_ATT_DO)) * 100, 2) END as ID118,SUM(INTER_AN_HHO_OUT_ATT_DO)+SUM(INTER_AN_HHO_IN_ATT_DO) as ID119,SUM(INTER_AN_HHO_IN_SUC_DO)+SUM(INTER_AN_HHO_OUT_SUC_DO) as ID120,CASE WHEN SUM(PAGE_ATT_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(PAGE_SUC_NUM_DO)/SUM(PAGE_ATT_NUM_DO)*100,4) END as ID121,SUM(PAGE_ATT_NUM_DO) as ID122,SUM(PAGE_SUC_NUM_DO) as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,SUM(DO_CONN_SETUP_TIME)*(SUM(nvl(AT_CONN_SUC_DO,0))+SUM(nvl(AN_CONN_SUC_DO,0))) as ID135,SUM(DO_CONN_OCCUPANCY_TIME)*(SUM(nvl(AT_CONN_SUC_DO,0))+SUM(nvl(AN_CONN_SUC_DO,0))) as ID136,SUM(SESS_SETUP_TOTAL_DUR_DO) as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FTCH_RLP_TX_DO) as ID139,SUM(RTCH_RLP_RETX_DO) *1024 as ID140,SUM(RTCH_RLP_TX_DO)*1024 as ID141,null as ID142,null as ID143,SUM(FWD_MACINDEX_AVA_NUM_DO) as ID144,SUM(DRC_FWD_LESS_3072_DO) as ID145,SUM(DRC_FWD_3072_1228_DO) as ID146,SUM(DRC_FWD_MORE_1228_DO) as ID147,null as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
       and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0808'
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '城市' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
c.CITY_NAME as b2,'广东' as b3,c.CITY_NAME as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,CASE WHEN SUM(RCE_RLB_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RCE_MAX_BUSY_NUM_DO) / SUM(RCE_RLB_NUM_DO) * 100, 2) END  as ID7,SUM(RCE_MAX_BUSY_NUM_DO) as ID8,SUM(RCE_RLB_NUM_DO) as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN SUM(nvl(DO_CONN_ATT,0))=0 THEN 0 WHEN SUM(nvl(DO_SUC_CONN_NUM,0))>=SUM(nvl(DO_CONN_ATT,0)) THEN 99.99 ELSE ROUND(SUM(nvl(DO_SUC_CONN_NUM,0)) / SUM(nvl(DO_CONN_ATT,0)) * 100, 2) END as ID23,CASE WHEN SUM(nvl(AT_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_CONN_SUC_DO,0))/SUM(nvl(AT_CONN_ATT_DO,0))*100,4) END as ID24,CASE WHEN SUM(nvl(AN_CONN_ATT_DO,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AN_CONN_SUC_DO,0))/SUM(nvl(AN_CONN_ATT_DO,0))*100,4) END as ID25,SUM(nvl(AT_CONN_ATT_DO,0)) as ID26,SUM(nvl(AN_CONN_ATT_DO,0)) as ID27,SUM(nvl(AT_CONN_SUC_DO,0)) as ID28,SUM(nvl(AN_CONN_SUC_DO,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,SUM(CONN_SETUP_FAILED_RESF_DO) as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))-SUM(REL_NUM_PDSN_DO) as ID39,SUM(REL_NUM_PDSN_DO) as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))=0 THEN 0 ELSE ROUND((SUM(REL_NUM_PDSN_DO)+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100/SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)),4) END as ID45,CASE WHEN (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_SETUP_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID46,CASE WHEN  (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME)/ (SUM(AT_CONN_SUC_DO) + SUM(AN_CONN_SUC_DO)), 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))>=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(UATI_ATT_FAILED_NUM_DO) as ID54,SUM(UATI_AVG_SETUP_DURATION_DO) as ID55,CASE WHEN SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(AUTH_SUC_DO)/(SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO))*100,4) END as ID56,SUM(AUTH_SUC_DO) as ID57,SUM(AUTH_SUC_DO) + SUM(AUTH_FAILED_NUM_DO) + SUM(AUTH_DENY_NUM_DO) as ID58,SUM(AUTH_DENY_NUM_DO) as ID59,SUM(AUTH_FAILED_NUM_DO) as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,CASE WHEN SUM(SESS_INTER_AN_DORMHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_INTER_AN_DORMHO_SUC_DO)/SUM(SESS_INTER_AN_DORMHO_ATT_DO)*100,4) END as ID64,SUM(SESS_INTER_AN_DORMHO_ATT_DO) as ID65,SUM(SESS_INTER_AN_DORMHO_SUC_DO) as ID66,SUM(SESSION_ACTIVE_NUM_DO)+SUM(SESSION_NON_ACTIVE_NUM_DO) as ID67,SUM(SESSION_ACTIVE_NUM_DO) as ID68,SUM(SESSION_NON_ACTIVE_NUM_DO) as ID69,CASE WHEN (SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO)) /(SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO)) * 100, 2) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AN_DOR2ACT_SUC_DO)/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(TRAFFIC_DO) as ID81,SUM(TRAFFIC_DO) as ID82,SUM(TRAFFIC_DO)+SUM(SFT_HO_TRAFFIC_DO) as ID83,SUM(SFT_HO_TRAFFIC_DO) as ID84,CASE WHEN SUM(TRAFFIC_DO)=0 THEN 0 ELSE ROUND(SUM(SFT_HO_TRAFFIC_DO)/SUM(TRAFFIC_DO)*100,4) END as ID85,SUM(REV_THROUGHOUT_PCF_DO) as ID86,SUM(FWD_THROUGHOUT_PCF_DO) as ID87,SUM(REV_PAK_TOTAL_NUM_DO) as ID88,SUM(FWD_PAK_TOTAL_NUM_DO) as ID89,null as ID90,SUM(FWD_PAK_DISCARD_NUM_DO) as ID91,null as ID92,CASE WHEN SUM(FWD_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(FWD_PAK_DISCARD_NUM_DO)/SUM(FWD_PAK_TOTAL_NUM_DO),4) END as ID93,ROUND(SUM(RLP_TXBYTENUM) * 8.0 / 1000 / 3600,4) as ID94,CASE WHEN SUM(FWD_RLP_AVG_THROUGHPUT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_AVG_THROUGHPUT_DO)/1000/3600*8*100,4) END as ID95,ROUND(SUM(DO_RTCH_RLP_TX) * 8.0 / 1000 / 3600,4) as ID96,CASE WHEN SUM(DO_RTCH_RLP_TX)=0 THEN 0 ELSE ROUND(SUM(RTCH_RLP_RETX_DO)/SUM(DO_RTCH_RLP_TX)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FTCH_PHY_SLOT_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/SUM(FTCH_PHY_SLOT_DO)*100,4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(RLP_CALLKDURATION)=0 THEN 0 ELSE ROUND(SUM(RTCH_PHY_TX_BIT_DO)/SUM(RLP_CALLKDURATION)*100,4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),4) as ID102,ROUND(AVG(FWD_PHY_CCH_SLOT_RATE_DO),4) as ID103,null as ID104,CASE WHEN SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RAB_BUSY_NUM_DO)/(SUM(RAB_BUSY_NUM_DO)+SUM(RAB_IDLE_NUM_DO))*100,4) END as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))>=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,CASE WHEN SUM(INN_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_BS_SHO_SUC_DO)/SUM(INN_BS_SHO_ATT_DO),4) END as ID109,SUM(INN_BS_SHO_ATT_DO) as ID110,SUM(INN_BS_SHO_SUC_DO) as ID111,CASE WHEN SUM(INTER_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_BS_SHO_SUC_DO)/SUM(INTER_BS_SHO_ATT_DO),4) END as ID112,SUM(INTER_BS_SHO_ATT_DO) as ID113,SUM(INTER_BS_SHO_SUC_DO) as ID114,CASE WHEN SUM(INN_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_AN_HHO_SUC_DO)/SUM(INN_AN_HHO_ATT_DO)*100,4) END as ID115,SUM(INN_AN_HHO_ATT_DO) as ID116,SUM(INN_AN_HHO_SUC_DO) as ID117,CASE WHEN SUM(INTER_AN_HHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_AN_HHO_ATT_DO)/SUM(INTER_AN_HHO_ATT_DO),4) END as ID118,SUM(INTER_AN_HHO_ATT_DO) as ID119,SUM(INTER_AN_HHO_SUC_DO) as ID120,CASE WHEN SUM(PAGE_ATT_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(PAGE_SUC_NUM_DO)/SUM(PAGE_ATT_NUM_DO)*100,4) END as ID121,SUM(PAGE_ATT_NUM_DO) as ID122,SUM(PAGE_SUC_NUM_DO) as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,SUM(DO_SETUP_TIME) as ID135,SUM(DO_CONNECT_TIME) as ID136,SUM(SESS_SETUP_TOTAL_DUR_DO) as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_AVG_THROUGHPUT_DO)*1024 as ID139,SUM(RTCH_RLP_RETX_DO) as ID140,SUM(DO_RTCH_RLP_TX) as ID141,SUM(RAB_BUSY_NUM_DO) as ID142,SUM(RAB_IDLE_NUM_DO) as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FTCH_PHY_SLOT_DO) as ID149,SUM(RTCH_PHY_TX_BIT_DO) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
       and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0804'
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '城市' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
c.CITY_NAME as b2,'广东' as b3,c.CITY_NAME as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,null as ID7,null as ID8,null as ID9,null as ID10,null as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0)) )=0 THEN 0 WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))>=(SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) THEN 99.99 ELSE ROUND((SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) +SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))) / (SUM(nvl(AT_INIT_ATT_CONN,0)) +SUM(nvl(AN_INIT_ATT_CONN,0))) * 100, 5) END as ID23,CASE WHEN SUM(nvl(AT_INIT_ATT_CONN,0))=0 THEN 0 ELSE ROUND(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))/SUM(nvl(AT_INIT_ATT_CONN,0))*100,4) END as ID24,DECODE(SUM(AN_INIT_ATT_CONN),0,0,ROUND(SUM(AN_INIT_ESTABLISHED_CONN)/SUM(AN_INIT_ATT_CONN),4)*100) as ID25,SUM(nvl(AT_INIT_ATT_CONN,0)) as ID26,SUM(nvl(AN_INIT_ATT_CONN,0)) as ID27,SUM(nvl(AT_INIT_ESTABLISHED_CONN,0)) as ID28,SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,null as ID35,null as ID36,null as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,null as ID39,null as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN (SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))=0 THEN 0 ELSE ROUND((SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))/(SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100,2) END as ID45,null as ID46,CASE WHEN (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN))=0 THEN 0 ELSE ROUND(SUM(DO_CONNECT_TIME) / (SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)) * 100, 2) END as ID47,null as ID48,null as ID49,null as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))>=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(nvl(UATI_ATT_NUM,0))-SUM(nvl(UATI_SUC_NUM,0)) as ID54,null as ID55,null as ID56,null as ID57,null as ID58,null as ID59,null as ID60,CASE WHEN SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO)/(SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))*100,4) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,null as ID64,null as ID65,null as ID66,null as ID67,null as ID68,null as ID69,CASE WHEN SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/(SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO))*100,4) END as ID70,SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO)/SUM(AT_DOR2ACT_ATT_DO)*100,4) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND((SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO))/SUM(AN_DOR2ACT_ATT_DO)*100,4) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(EQU_USER_NUM_DO) as ID81,SUM(TCH_OCC) as ID82,null as ID83,null as ID84,null as ID85,null as ID86,null as ID87,null as ID88,null as ID89,null as ID90,null as ID91,null as ID92,null as ID93,ROUND(SUM(FWD_RLP_DATA)*8/(1000*3600),4) as ID94,CASE WHEN SUM(FWD_RLP_DATA)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO)/SUM(FWD_RLP_DATA)*100,4) END as ID95,ROUND(SUM(RLP_RXED_RTC)*8/(100*3600),4) as ID96,CASE WHEN SUM(RTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(MISSING_RLP_REQ_RTC)/SUM(RTCH_RLP_TX_DO)*100,4) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,CASE WHEN SUM(FWD_RLP_TOT_SLOT)=0 THEN 0 ELSE ROUND(SUM(FTCH_PHY_TX_BIT_DO)/1000/(SUM(FWD_RLP_TOT_SLOT)*0.001667),4) END as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,CASE WHEN SUM(NUM_SUBPKTS_RL)=0 THEN 0 ELSE ROUND(SUM(REV_PHY_AVG_BYTE)*(8*1000)/(SUM(NUM_SUBPKTS_RL)* 0.00667),4) END as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),3) as ID102,null as ID103,null as ID104,null as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))>=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,null as ID109,null as ID110,null as ID111,null as ID112,null as ID113,null as ID114,null as ID115,null as ID116,null as ID117,null as ID118,null as ID119,null as ID120,null as ID121,null as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,null as ID135,CASE WHEN (SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0)))=0 THEN 0 ELSE ROUND((SUM(EVM_AVG_DRC_POINTED_USERS)*3600*(SUM(AT_INIT_ESTABLISHED_CONN)+SUM(AN_INIT_ESTABLISHED_CONN)))/(SUM(nvl(AT_INIT_ESTABLISHED_CONN,0))+SUM(nvl(AN_INIT_ESTABLISHED_CONN,0))),2) END as ID136,null as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FWD_RLP_DATA) as ID139,SUM(MISSING_RLP_REQ_RTC) as ID140,SUM(RTCH_RLP_TX_DO) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,null as ID146,null as ID147,SUM(FTCH_PHY_TX_BIT_DO) as ID148,SUM(FWD_RLP_TOT_SLOT)*0.001667 as ID149,SUM(REV_PHY_AVG_BYTE)*(8*1000000) as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
       and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0810'
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '省' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
'广东' as b2,'广东' as b3,'广东' as b4,  
null as ID1,null as ID2,null as ID3,null as ID4,null as ID5,null as ID6,CASE WHEN SUM(RCE_RLB_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(RCE_MAX_BUSY_NUM_DO)/SUM(RCE_RLB_NUM_DO) * 100,2) END as ID7,SUM(RCE_MAX_BUSY_NUM_DO) as ID8,SUM(RCE_RLB_NUM_DO) as ID9,null as ID10,SUM(FWD_MACINDEX_MAX_NUM_DO) as ID11,null as ID12,null as ID13,null as ID14,null as ID15,null as ID16,null as ID17,null as ID18,null as ID19,null as ID20,null as ID21,null as ID22,CASE WHEN SUM(nvl(DO_CONN_ATT,0))=0 THEN 0 WHEN SUM(nvl(DO_SUC_CONN_NUM,0))>=SUM(nvl(DO_CONN_ATT,0)) THEN 99.99 ELSE ROUND(SUM(nvl(DO_SUC_CONN_NUM,0)) / SUM(nvl(DO_CONN_ATT,0)) * 100, 2) END as ID23,DECODE(SUM(AT_CONN_ATT_DO),0,0,ROUND(SUM(AT_CONN_SUC_DO)/SUM(AT_CONN_ATT_DO),4)*100) as ID24,DECODE(SUM(AN_CONN_ATT_DO),0,0,ROUND(SUM(AN_CONN_SUC_DO)/SUM(AN_CONN_ATT_DO),4)*100) as ID25,SUM(nvl(AT_CONN_ATT_DO,0)) as ID26,SUM(nvl(AN_CONN_ATT_DO,0)) as ID27,SUM(nvl(AT_CONN_SUC_DO,0)) as ID28,SUM(nvl(AN_CONN_SUC_DO,0)) as ID29,null as ID30,null as ID31,null as ID32,null as ID33,null as ID34,SUM(CONN_SETUP_FAILED_RESF_DO) as ID35,SUM(CONN_SETUP_FAILED_FEVF_DO) as ID36,SUM(CONN_SETUP_FAILED_NOTCC_DO) as ID37,SUM(nvl(RELEASETIMES_INCLPDSN_DO,0)) as ID38,null as ID39,null as ID40,SUM(nvl(DROPCALLNUM_RFLOSE_DO,0)) as ID41,SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0)) as ID42,SUM(nvl(DROPCALLNUM_OTHER_DO,0)) as ID43,CASE WHEN SUM(nvl(DO_SUC_CONN,0))=0 THEN 0 WHEN SUM(nvl(DO_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(DO_DROP_NUM,0)) / SUM(DO_SUC_CONN) * 100, 2) END as ID44,CASE WHEN (SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))=0 THEN 0 ELSE ROUND((SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))/(SUM(nvl(RELEASETIMES_INCLPDSN_DO,0))+SUM(nvl(DROPCALLNUM_RFLOSE_DO,0))+SUM(nvl(DROPCALLNUM_HARDHOFAIL_DO,0))+SUM(nvl(DROPCALLNUM_OTHER_DO,0)))*100,2) END as ID45,SUM(DO_CONN_SETUP_TIME) as ID46,SUM(DO_CONN_OCCUPANCY_TIME) as ID47,CASE WHEN (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO))=0 THEN 0 ELSE ROUND(SUM(DRC_FWD_LESS_3072_DO) / (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO)) * 100, 2) END as ID48,CASE WHEN (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO))=0 THEN 0 ELSE ROUND(SUM(DRC_FWD_3072_1228_DO) / (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO)) * 100, 2) END as ID49,CASE WHEN (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO))=0 THEN 0 ELSE ROUND(SUM(DRC_FWD_MORE_1228_DO) / (SUM(DRC_FWD_LESS_3072_DO)+SUM(DRC_FWD_3072_1228_DO)+SUM(DRC_FWD_MORE_1228_DO)) * 100, 2) END as ID50,CASE WHEN SUM(nvl(UATI_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(UATI_SUC_NUM,0))>=SUM(nvl(UATI_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(UATI_SUC_NUM,0)) / SUM(UATI_ATT_NUM) * 100, 2) END as ID51,SUM(nvl(UATI_ATT_NUM,0)) as ID52,SUM(nvl(UATI_SUC_NUM,0)) as ID53,SUM(UATI_ATT_FAILED_NUM_DO) as ID54,SUM(UATI_AVG_SETUP_DURATION_DO) as ID55,CASE WHEN SUM(AUTH_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AUTH_SUC_DO) / SUM(AUTH_ATT_DO) * 100, 2) END as ID56,SUM(AUTH_SUC_DO) as ID57,SUM(AUTH_ATT_DO) as ID58,SUM(AUTH_DENY_NUM_DO) as ID59,SUM(AUTH_FAILED_NUM_DO) as ID60,CASE WHEN (SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO))=0 THEN 0 ELSE ROUND(SUM(SESS_NEGO_SUC_NUM_DO) / (SUM(SESS_NEGO_SUC_NUM_DO)+SUM(SESS_NEGO_FAILED_NUM_DO)) * 100, 2) END as ID61,SUM(SESS_NEGO_SUC_NUM_DO) as ID62,SUM(SESS_NEGO_FAILED_NUM_DO) as ID63,null as ID64,null as ID65,null as ID66,SUM(SESSION_ACTIVE_NUM_DO)+SUM(SESSION_NON_ACTIVE_NUM_DO) as ID67,SUM(SESSION_ACTIVE_NUM_DO) as ID68,SUM(SESSION_NON_ACTIVE_NUM_DO) as ID69,CASE WHEN (SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(AT_DOR2ACT_SUC_DO)+SUM(AN_DOR2ACT_SUC_DO)) /(SUM(AT_DOR2ACT_ATT_DO)+SUM(AN_DOR2ACT_ATT_DO)) * 100, 2) END as ID70,SUM(AT_DOR2ACT_ATT_DO) + SUM(AN_DOR2ACT_ATT_DO) as ID71,SUM(AT_DOR2ACT_SUC_DO) + SUM(AN_DOR2ACT_SUC_DO) as ID72,CASE WHEN SUM(AT_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AT_DOR2ACT_SUC_DO) / SUM(AT_DOR2ACT_ATT_DO) * 100, 2) END as ID73,SUM(AT_DOR2ACT_ATT_DO) as ID74,SUM(AT_DOR2ACT_SUC_DO) as ID75,SUM(AT_DOR2ACT_ATT_DO)-SUM(AT_DOR2ACT_SUC_DO) as ID76,CASE WHEN SUM(AN_DOR2ACT_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(AN_DOR2ACT_SUC_DO) / SUM(AN_DOR2ACT_ATT_DO) * 100, 2) END as ID77,SUM(AN_DOR2ACT_ATT_DO) as ID78,SUM(AN_DOR2ACT_SUC_DO) as ID79,SUM(AN_DOR2ACT_ATT_DO)-SUM(AN_DOR2ACT_SUC_DO) as ID80,SUM(TRAFFIC_DO_COMMON) as ID81,SUM(TRAFFIC_DO_COMMON) as ID82,ROUND((SUM(TRAFFIC_CE_TIME_DO) + SUM(TRAFFIC_CE_TIME_DO0)) / 3600,4) as ID83,ROUND((SUM(TRAFFIC_CE_TIME_DO) + SUM(TRAFFIC_CE_TIME_DO0)) / 3600,4)-SUM(TRAFFIC_DO_COMMON) as ID84,CASE WHEN SUM(TRAFFIC_DO_COMMON)=0 THEN 0 ELSE ROUND((ROUND((SUM(TRAFFIC_CE_TIME_DO) + SUM(TRAFFIC_CE_TIME_DO0)) / 3600,4)-SUM(TRAFFIC_DO_COMMON)) / SUM(TRAFFIC_DO_COMMON) * 100, 2) END as ID85,SUM(REV_THROUGHOUT_PCF_DO) as ID86,SUM(FWD_THROUGHOUT_PCF_DO) as ID87,SUM(REV_PAK_TOTAL_NUM_DO) as ID88,SUM(FWD_PAK_TOTAL_NUM_DO) as ID89,SUM(REV_PAK_DISCARD_NUM_DO) as ID90,SUM(FWD_PAK_DISCARD_NUM_DO) as ID91,CASE WHEN SUM(REV_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(REV_PAK_DISCARD_NUM_DO) / SUM(REV_PAK_TOTAL_NUM_DO) * 100, 2) END as ID92,CASE WHEN SUM(FWD_PAK_TOTAL_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(FWD_PAK_DISCARD_NUM_DO) / SUM(FWD_PAK_TOTAL_NUM_DO) * 100, 2) END as ID93,ROUND(SUM(FTCH_RLP_TX_DO) * 8 / 1000 / 3600,4) as ID94,CASE WHEN SUM(FTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_DO) / SUM(FTCH_RLP_TX_DO) * 100, 2) END as ID95,ROUND(SUM(RTCH_RLP_TX_DO) * 8 / 3600,4) as ID96,CASE WHEN SUM(RTCH_RLP_TX_DO)=0 THEN 0 ELSE ROUND(SUM(RTCH_RLP_RETX_DO) / SUM(RTCH_RLP_TX_DO)/1024 * 100, 2) END as ID97,ROUND(SUM(nvl(DO_FTCH_RLP_TX,0))*8/1000/3600,3) as ID98,null as ID99,ROUND(SUM(nvl(DO_RTCH_RLP_TX,0))*8/1000/3600,3) as ID100,null as ID101,ROUND(AVG(DO_TCH_AVG_SLOT_OCCUPY_RATE),3) as ID102,null as ID103,null as ID104,null as ID105,CASE WHEN SUM(nvl(GSHO_ATT_NUM,0))=0 THEN 0 WHEN SUM(nvl(GSHO_SUC_NUM,0))>=SUM(nvl(GSHO_ATT_NUM,0)) THEN 99.99 ELSE ROUND(SUM(nvl(GSHO_SUC_NUM,0)) / SUM(GSHO_ATT_NUM) * 100, 2) END as ID106,SUM(nvl(GSHO_ATT_NUM,0)) as ID107,SUM(nvl(GSHO_SUC_NUM,0)) as ID108,CASE WHEN SUM(INN_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INN_BS_SHO_SUC_DO) / SUM(INN_BS_SHO_ATT_DO) * 100, 2) END as ID109,SUM(INN_BS_SHO_ATT_DO) as ID110,SUM(INN_BS_SHO_SUC_DO) as ID111,CASE WHEN SUM(INTER_BS_SHO_ATT_DO)=0 THEN 0 ELSE ROUND(SUM(INTER_BS_SHO_SUC_DO)/SUM(INTER_BS_SHO_ATT_DO),4) END as ID112,SUM(INTER_BS_SHO_ATT_DO) as ID113,SUM(INTER_BS_SHO_SUC_DO) as ID114,DECODE(SUM(INN_AN_HHO_ATT_DO),0,0,ROUND(SUM(INN_AN_HHO_SUC_DO)/SUM(INN_AN_HHO_ATT_DO),4)*100) as ID115,SUM(INN_AN_HHO_ATT_DO) as ID116,SUM(INN_AN_HHO_SUC_DO) as ID117,CASE WHEN (SUM(INTER_AN_HHO_OUT_ATT_DO)+SUM(INTER_AN_HHO_IN_ATT_DO))=0 THEN 0 ELSE ROUND((SUM(INTER_AN_HHO_IN_SUC_DO)+SUM(INTER_AN_HHO_OUT_SUC_DO)) / (SUM(INTER_AN_HHO_OUT_ATT_DO)+SUM(INTER_AN_HHO_IN_ATT_DO)) * 100, 2) END as ID118,SUM(INTER_AN_HHO_OUT_ATT_DO)+SUM(INTER_AN_HHO_IN_ATT_DO) as ID119,SUM(INTER_AN_HHO_IN_SUC_DO)+SUM(INTER_AN_HHO_OUT_SUC_DO) as ID120,CASE WHEN SUM(PAGE_ATT_NUM_DO)=0 THEN 0 ELSE ROUND(SUM(PAGE_SUC_NUM_DO)/SUM(PAGE_ATT_NUM_DO)*100,4) END as ID121,SUM(PAGE_ATT_NUM_DO) as ID122,SUM(PAGE_SUC_NUM_DO) as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,null as ID129,null as ID130,null as ID131,null as ID132,null as ID133,null as ID134,SUM(DO_CONN_SETUP_TIME)*(SUM(nvl(AT_CONN_SUC_DO,0))+SUM(nvl(AN_CONN_SUC_DO,0))) as ID135,SUM(DO_CONN_OCCUPANCY_TIME)*(SUM(nvl(AT_CONN_SUC_DO,0))+SUM(nvl(AN_CONN_SUC_DO,0))) as ID136,SUM(SESS_SETUP_TOTAL_DUR_DO) as ID137,SUM(FTCH_RLP_RETX_DO) as ID138,SUM(FTCH_RLP_TX_DO) as ID139,SUM(RTCH_RLP_RETX_DO) *1024 as ID140,SUM(RTCH_RLP_TX_DO)*1024 as ID141,null as ID142,null as ID143,SUM(FWD_MACINDEX_AVA_NUM_DO) as ID144,SUM(DRC_FWD_LESS_3072_DO) as ID145,SUM(DRC_FWD_3072_1228_DO) as ID146,SUM(DRC_FWD_MORE_1228_DO) as ID147,null as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor in ('ZY0808','ZY0804','ZY0810')
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time)  where b2 is not null ORDER BY START_TIME, B1

--资源类
  select '城市' as b1,start_time,
                                                  c.CITY_NAME as b2,  
                                                  SUM(DO_BTS_TOTAL_NUM) as ID1,SUM(ONE_CARR_BTS_NUM_DO) as ID2,SUM(TWO_CARR_BTS_NUM_DO) as ID3,SUM(THREE_CARR_BTS_NUM_DO) as ID4,SUM(FOUR_CARR_BTS_NUM_DO) as ID5,SUM(DO_CARR_TOTAL_NUM) as ID6,SUM(PCF_TOTAL_NUM) as ID7,SUM(EX_BUSY_BTS_NUM_DO) as ID8,SUM(IDLE_BTS_NUM_DO) as ID9,SUM(CARR_NUM_37) as ID10,SUM(CARR_NUM_78) as ID11,SUM(CARR_NUM_119) as ID12,SUM(DO_CARR_TOTAL_NUM) as ID13,SUM(TRAFFIC_37) as ID14,SUM(TRAFFIC_78) as ID15,SUM(TRAFFIC_119) as ID16,SUM(DO_1CARR_CELL_NUM) as ID17,SUM(DO_2CARR_CELL_NUM) as ID18,SUM(DO_3CARR_CELL_NUM) as ID19,SUM(DO_CELL_TOTAL_NUM) as ID20 
                                            from perf_bsc_resource c, cfg_bsc_map_city b,cfg_city d
                                            where c.ne_sys_id = b.ne_bsc_id
                                            and start_time >= to_date('2011-5-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                                            and start_time <= to_date('2011-5-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS')                                              
                                            and b.city_id=d.city_id
                                            and c.CITY_ID=d.city_id
                                            group by start_time,c.CITY_NAME