
--CITY级别1X
  --非资源类
    SELECT *  FROM (select '城市' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
c.CITY_NAME as b2,'广东' as b3,c.CITY_NAME as b4,  
sum(nvl(CALL_ATT_CS,0))+sum(nvl(CALL_ATT_PS,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(CALL_SETUP_SUCC_PS,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_PS,0))) = 0 THEN 0  WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CALL_SETUP_SUCC_PS,0)))>=(SUM(CALL_ATT) + SUM(CALL_ATT_PS)) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CALL_SETUP_SUCC_PS,0)))/(SUM(CALL_ATT) + SUM(CALL_ATT_PS)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0  WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))>=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,SUM(CALL_ATT_PS) as ID7,SUM(CALL_SETUP_SUCC_PS) as ID8,case when SUM(CALL_ATT_PS) = 0  THEN 0 WHEN (SUM(CALL_SETUP_SUCC_PS))>=SUM(CALL_ATT_PS) THEN 99.99 else     ROUND((SUM(CALL_SETUP_SUCC_PS)) / (SUM(CALL_ATT_PS)) * 100,4)END as ID9,SUM(SHO_TRAFFIC_CS)+SUM(FCH_CE_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(SHO_TRAFFIC_CS) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(FCH_CE_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(FCH_WALSHCODE_TRAFFIC_PS) as ID20,SUM(FCH_CE_TRAFFIC_PS) - SUM(TRAFFIC_PS) as ID21,SUM(FCH_WALSHCODE_TRAFFIC_PS)-SUM(FCH_CE_TRAFFIC_PS) as ID22,case when SUM(TRAFFIC_PS) = 0  THEN 0 else ROUND((SUM(FCH_CE_TRAFFIC_PS) - SUM(TRAFFIC_PS)) / SUM(TRAFFIC_PS)*100,4)END as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(TCH_DROP_PS,0)) as ID24,CASE WHEN (SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(TCH_SETUP_SUCC_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(TCH_DROP_PS,0)))<=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(TCH_DROP_PS,0)))/(SUM(TCH_ASSIGN_SUC) + SUM(TCH_SETUP_SUCC_PS)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + SUM(TCH_DROP_PS))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + SUM(TCH_DROP_PS)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,SUM(TCH_DROP_PS) as ID30,CASE WHEN SUM(TCH_SETUP_SUCC_PS)=0 THEN 0 WHEN SUM(TCH_DROP_PS)<=0 THEN 0.01 ELSE ROUND(SUM(TCH_DROP_PS) / SUM(TCH_SETUP_SUCC_PS) * 100, 2) END  as ID31,CASE WHEN SUM(TCH_DROP_PS)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/SUM(TCH_DROP_PS),2) END as ID32,SUM(TCH_SETUP_ATT) as ID33,SUM(TCH_SETUP_SUC) as ID34,SUM(TCH_SETUP_ATT)-SUM(TCH_SETUP_SUC) as ID35,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END  as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID39,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS))=0 THEN 0 ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(nvl(TCH_SETUP_SUCC_PS,0))) /(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100, 4) END  as ID40,SUM(TCH_BLOCK_COUNT)+ (SUM(CALL_ATT_PS)-sum(CALL_SETUP_SUCC_PS)) as ID41,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT)+ (SUM(CALL_ATT_PS)-sum(CALL_SETUP_SUCC_PS)))/SUM(TCH_SETUP_ATT)*100,2) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END  as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0   ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT),4)*100 END as ID52,SUM(TCH_ASSIGN_ATT_HHO_CS) as ID53,SUM(TCH_ASSIGN_SUC_HHO_CS) as ID54,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_CS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_CS)-SUM(TCH_ASSIGN_SUC_HHO_CS))/SUM(TCH_ASSIGN_ATT_HHO_CS) * 100, 2) END as ID55,SUM(TCH_ASSIGN_ATT_SHO_CS) as ID56,SUM(TCH_ASSIGN_SUC_SHO_CS) as ID57,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_CS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_CS)-SUM(TCH_ASSIGN_SUC_SHO_CS))/SUM(TCH_ASSIGN_ATT_SHO_CS) * 100, 2) END as ID58,SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS) as ID59,SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS) as ID60,SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)-(SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS)) as ID61,CASE WHEN (SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS))=0 THEN 0 ELSE ROUND((SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS))/(SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)) * 100, 4) END  as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_SETUP_SUCC_PS,0))/SUM(TCH_ASSIGN_ATT_PS) * 100, 4) END  as ID66,SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)-(SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS)) as ID67,CASE WHEN (SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS))=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)-(SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS)))/(SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)) * 100, 4) END  as ID68,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID69,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID70,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_PS)-SUM(TCH_ASSIGN_SUC_HHO_PS))/SUM(TCH_ASSIGN_ATT_HHO_PS)* 100, 2) END   as ID71,SUM(TCH_ASSIGN_ATT_SHO_PS) as ID72,SUM(TCH_ASSIGN_SUC_SHO_PS) as ID73,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_PS)-SUM(TCH_ASSIGN_SUC_SHO_PS))/SUM(TCH_ASSIGN_ATT_SHO_PS)* 100, 2) END   as ID74,SUM(INNER_BSC_HHO_ATT) + SUM(INNER_BSC_SHO_ATT)  + SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT) as ID75,SUM(INNER_BSC_HHO_SUCC) + SUM(INNER_BSC_SHO_SUCC) + SUM(INTER_BSC_HHO_SUCC) + SUM(INTER_BSC_SHO_SUCC) as ID76,CASE WHEN (SUM(INNER_BSC_HHO_ATT) + SUM(INNER_BSC_SHO_ATT)  + SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC) + SUM(INNER_BSC_SHO_SUCC) + SUM(INTER_BSC_HHO_SUCC) + SUM(INTER_BSC_SHO_SUCC))/(SUM(INNER_BSC_HHO_ATT) + SUM(INNER_BSC_SHO_ATT)  + SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT))*100,2) END as ID77,SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT) as ID78,SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC) as ID79,CASE WHEN (SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)) = 0 THEN 0 ELSE  ROUND( (SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC))/(SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)), 3) * 100 END as ID80,SUM(BSS_HHO_ATT) as ID81,SUM(BSS_HHO_SUC) as ID82,CASE WHEN SUM(BSS_HHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT),4) * 100 END as ID83,SUM(S_SHO_ATT) as ID84,SUM(S_SHO_SUC) as ID85,CASE WHEN (SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)) = 0 THEN 0 ELSE  ROUND((SUM(S_SHO_SUC)-SUM(S_SSHO_SUC))/(SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)),4) * 100 END as ID86,SUM(S_SSHO_ATT) as ID87,SUM(S_SSHO_SUC) as ID88,CASE WHEN SUM(S_SSHO_ATT) = 0 THEN 0 ELSE ROUND(SUM(S_SSHO_SUC) / SUM(S_SSHO_ATT),4)*100 END as ID89,null as ID90,null as ID91,null as ID92,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID93,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID94,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_HHO_PS) / SUM(TCH_ASSIGN_ATT_HHO_PS),4)*100 END as ID95,null as ID96,null as ID97,null as ID98,null as ID99,null as ID100,null as ID101,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INTRA_BS_SSHO_ATT_NUM) as ID102,SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INTRA_BS_SSHO_SUC_NUM) as ID103,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INTRA_BS_SSHO_ATT_NUM))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INTRA_BS_SSHO_SUC_NUM))/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INTRA_BS_SSHO_ATT_NUM))* 100, 4) END  as ID104,SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID105,SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC) as ID106,CASE WHEN (SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC))/(SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))* 100, 4) END as ID107,SUM(INNER_BSC_HHO_ATT) as ID108,SUM(INNER_BSC_HHO_SUCC) as ID109,CASE WHEN SUM(INNER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_HHO_SUCC)/SUM(INNER_BSC_HHO_ATT)* 100, 4) END  as ID110,SUM(INNER_BSC_SHO_ATT) as ID111,SUM(INNER_BSC_SHO_SUCC) as ID112,CASE WHEN SUM(INNER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SHO_SUCC)/SUM(INNER_BSC_SHO_ATT)* 100, 4) END  as ID113,SUM(INTRA_BS_SSHO_ATT_NUM) as ID114,SUM(INTRA_BS_SSHO_SUC_NUM) as ID115,CASE WHEN SUM(INTRA_BS_SSHO_ATT_NUM)=0 THEN 0 ELSE ROUND(SUM(INTRA_BS_SSHO_SUC_NUM)/SUM(INTRA_BS_SSHO_ATT_NUM)* 100, 4) END  as ID116,SUM(INTER_BSC_HHO_ATT) as ID117,SUM(INTER_BSC_HHO_SUCC) as ID118,CASE WHEN SUM(INTER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_HHO_SUCC)/SUM(INTER_BSC_HHO_ATT)* 100, 4) END  as ID119,SUM(INTER_BSC_SHO_ATT) as ID120,SUM(INTER_BSC_SHO_SUCC) as ID121,CASE WHEN SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_SHO_SUCC)/SUM(INTER_BSC_SHO_ATT)* 100, 4) END  as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,SUM(CH_CFG_NUM) as ID128,SUM(CH_RLB_NUM) as ID129,SUM(FWD_CH_MAX_NUM)+SUM(REV_CH_MAX_NUM) as ID130,CASE WHEN SUM(CH_RLB_NUM)=0 THEN 0 ELSE ROUND((SUM(FWD_CH_MAX_NUM) + SUM(REV_CH_MAX_NUM)) / SUM(CH_RLB_NUM) * 100,4) END as ID131,null as ID132,SUM(FWD_CH_RLB_NUM) as ID133,SUM(FWD_CH_MAX_NUM) as ID134,SUM(FWD_TCH_MAX_OCCU_RATE) as ID135,null as ID136,SUM(REV_CH_RLB_NUM) as ID137,SUM(REV_CH_MAX_NUM) as ID138,SUM(REV_TCH_MAX_OCCU_RATE) as ID139,SUM(RETX_FRM_NUM_FWD_1X) as ID140,SUM(FRM_NUM_FWD_1X) as ID141,SUM(DATA_THROUGHPUT_FWD_1X) as ID142,SUM(FTCH_RLP_RETX_BYTE_1X) as ID143,null as ID144,CASE WHEN SUM(DATA_THROUGHPUT_FWD_1X)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_BYTE_1X)/(1024*SUM(DATA_THROUGHPUT_FWD_1X))* 100, 4) END  as ID145,SUM(RETX_FRM_NUM_REV_1X) as ID146,SUM(TX_FRM_NUM_REV_1X) as ID147,SUM(DATA_THROUGHPUT_REV_1X) as ID148,CASE WHEN SUM(TX_FRM_NUM_REV_1X)=0 THEN 0 ELSE ROUND(SUM(RETX_FRM_NUM_REV_1X)/SUM(TX_FRM_NUM_REV_1X)* 100, 4) END  as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,null as ID161,SUM(CH_CFG_NUM) as ID162,null as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT)*100,4) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)) * 100,2) END as ID176,null as ID177,SUM(CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
       and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0808'
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '城市' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
c.CITY_NAME as b2,'广东' as b3,c.CITY_NAME as b4,  
sum(nvl(CALL_ATT,0))+sum(nvl(CALL_ATT_NUM_PS,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(CMO_CALLSUCCNUM_PS,0))+sum(nvl(PAG_SUCC_NUM_PS,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0)))>=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_NUM_PS,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CMO_CALLSUCCNUM_PS,0))+SUM(nvl(PAG_SUCC_NUM_PS,0)))/(SUM(CALL_ATT) + SUM(CALL_ATT_NUM_PS)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))>=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,SUM(CALL_ATT_NUM_PS) as ID7,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS) as ID8,CASE WHEN SUM(CALL_ATT_NUM_PS)=0 THEN 0 WHEN (SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))>=SUM(CALL_ATT_NUM_PS) THEN 99.99ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS))/SUM(CALL_ATT_NUM_PS)* 100, 4) END  as ID9,SUM(SHO_TRAFFIC_CS)+SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(TRAFFIC_CS)+SUM(SFT_HO_TRAFFIC_CS) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(TRAFFIC_PS)+SUM(SHO_TRAFFIC_PS)+SUM(SSHO_TRAFFIC_PS) as ID20,SUM(SHO_TRAFFIC_PS) as ID21,SUM(SSHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_TRAFFIC_PS)/SUM(TRAFFIC_PS)* 100, 4) END  as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATE_DROP_NUM,0)) as ID24,CASE WHEN (SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(DATA_SRLSNUM_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))<=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATE_DROP_NUM,0)))/(SUM(TCH_ASSIGN_SUC) + SUM(DATA_SRLSNUM_PS)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + SUM(DATE_DROP_NUM)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,SUM(DATE_DROP_NUM) as ID30,CASE WHEN SUM(DATA_SRLSNUM_PS)=0 THEN 0 WHEN SUM(DATE_DROP_NUM)<=0 THEN 0.01 ELSE ROUND(SUM(DATE_DROP_NUM)/SUM(DATA_SRLSNUM_PS),4)*100 END as ID31,CASE WHEN SUM(DATE_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/SUM(DATE_DROP_NUM),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID33,SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID34,SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID35,CASE WHEN (SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC)+SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM))/(SUM(TCH_SETUP_ATT)+SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)-(SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)) as ID39,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS))=0 THEN 0 ELSE ROUND(((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_SUC_PS)))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,2) END as ID40,SUM(TCH_BLOCK_COUNT)+ SUM(TCH_BLOCK_NUM_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT) + SUM(TCH_BLOCK_NUM_PS))*100/SUM(TCH_SETUP_ATT),2) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0   ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT),4)*100 END as ID52,SUM(BSS_HHO_ATT) as ID53,SUM(BSS_HHO_SUC) as ID54,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND((SUM(BSS_HHO_ATT) - SUM(BSS_HHO_SUC)) / SUM(BSS_HHO_ATT) * 100,4) END as ID55,SUM(S_SHO_ATT) as ID56,SUM(S_SHO_SUC) as ID57,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(S_SHO_ATT) - SUM(S_SHO_SUC)) / SUM(S_SHO_ATT) * 100,4) END as ID58,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM) as ID59,SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM) as ID60,SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-(SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(DATA_HO_SUCC_NUM)) as ID61,CASE WHEN SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(CMO_CALLSUCCNUM_PS)+SUM(PAG_SUCC_NUM_PS)+SUM(HHO_SUC_NUM_PS) + SUM(SHO_SUC_NUM_PS) +SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(CALL_ATT_NUM_PS)+SUM(HHO_ATT_NUM_PS)+SUM(SHO_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS))*100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(TCH_ASSIGN_SUC_PS) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(TCH_ASSIGN_SUC_PS) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_PS)/SUM(TCH_ASSIGN_ATT_PS) * 100,2) END as ID66,SUM(TCH_BLOCK_NUM_PS) as ID67,CASE WHEN (SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM))=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_NUM_PS)/(SUM(CALL_ATT_NUM_PS)+SUM(DATE_HO_ATT_NUM)) * 100,2) END as ID68,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID69,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID70,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_PS)-SUM(TCH_ASSIGN_SUC_HHO_PS))/SUM(TCH_ASSIGN_ATT_HHO_PS) * 100,2) END as ID71,SUM(TCH_ASSIGN_ATT_SHO_PS) as ID72,SUM(TCH_ASSIGN_SUC_SHO_PS) as ID73,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_PS)-SUM(TCH_ASSIGN_SUC_SHO_PS))/SUM(TCH_ASSIGN_ATT_SHO_PS) * 100,2) END as ID74,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID75,SUM(INNER_BSC_HHO_SUCC)+ SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC) as ID76,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC) + SUM(INNER_BSC_SOFTERHO_SUCC) + SUM(INTER_BSC_HHO_SUCC)+ SUM(INTER_BSC_SHO_SUCC))*100/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)+ SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT)),2) END as ID77,SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT) as ID78,SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC) as ID79,CASE WHEN (SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)) = 0 THEN 0 ELSE  ROUND( (SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC))/(SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)), 3) * 100 END as ID80,SUM(BSS_HHO_ATT) as ID81,SUM(BSS_HHO_SUC) as ID82,CASE WHEN SUM(BSS_HHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT),4) * 100 END as ID83,SUM(S_SHO_ATT)-SUM(S_SSHO_ATT) as ID84,SUM(S_SHO_SUC)-SUM(S_SSHO_SUC) as ID85,CASE WHEN (SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)) = 0 THEN 0 ELSE  ROUND((SUM(S_SHO_SUC)-SUM(S_SSHO_SUC))/(SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)),4) * 100 END as ID86,SUM(S_SSHO_ATT) as ID87,SUM(S_SSHO_SUC) as ID88,CASE WHEN SUM(S_SSHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(S_SSHO_SUC)/SUM(S_SSHO_ATT),4) * 100 END as ID89,SUM(DATE_HO_ATT_NUM) as ID90,SUM(DATA_HO_SUCC_NUM) as ID91,CASE WHEN SUM(DATE_HO_ATT_NUM)=0 THEN 0 ELSE ROUND(SUM(DATA_HO_SUCC_NUM)/SUM(DATE_HO_ATT_NUM) * 100,2) END as ID92,SUM(HHO_ATT_NUM_PS) as ID93,SUM(HHO_SUC_NUM_PS) as ID94,CASE WHEN SUM(HHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(HHO_SUC_NUM_PS)/SUM(HHO_ATT_NUM_PS) * 100,2) END as ID95,SUM(SHO_ATT_NUM_PS) as ID96,SUM(SHO_SUC_NUM_PS) as ID97,CASE WHEN SUM(SHO_ATT_NUM_PS)=0 THEN 0 ELSE ROUND(SUM(SHO_SUC_NUM_PS)/SUM(SHO_ATT_NUM_PS) * 100,2) END as ID98,SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID99,SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS) as ID100,CASE WHEN SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)=0 THEN 0 ELSE ROUND((SUM(DATA_HO_SUCC_NUM)-SUM(HHO_SUC_NUM_PS)-SUM(SHO_SUC_NUM_PS))/(SUM(DATE_HO_ATT_NUM)-SUM(HHO_ATT_NUM_PS)-SUM(SHO_SUC_NUM_PS)) * 100,4) END as ID101,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT) as ID102,SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC) as ID103,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INNER_BSC_SOFTERHO_SUCC))/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INNER_BSC_SOFTERHO_ATT)) * 100,2) END as ID104,SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID105,SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC) as ID106,CASE WHEN SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND((SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC))/(SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT)) * 100,4) END as ID107,SUM(INNER_BSC_HHO_ATT) as ID108,SUM(INNER_BSC_HHO_SUCC) as ID109,CASE WHEN SUM(INNER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_HHO_SUCC) / SUM(INNER_BSC_HHO_ATT) * 100,4) END as ID110,SUM(INNER_BSC_SHO_ATT) as ID111,SUM(INNER_BSC_SHO_SUCC) as ID112,CASE WHEN SUM(INNER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SHO_SUCC) / SUM(INNER_BSC_SHO_ATT) * 100,4) END as ID113,SUM(INNER_BSC_SOFTERHO_ATT) as ID114,SUM(INNER_BSC_SOFTERHO_SUCC) as ID115,CASE WHEN SUM(INNER_BSC_SOFTERHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SOFTERHO_SUCC) / SUM(INNER_BSC_SOFTERHO_ATT) * 100,4) END as ID116,SUM(INTER_BSC_HHO_ATT) as ID117,SUM(INTER_BSC_HHO_SUCC) as ID118,CASE WHEN SUM(INTER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_HHO_SUCC) / SUM(INTER_BSC_HHO_ATT) * 100,4) END as ID119,SUM(INTER_BSC_SHO_ATT) as ID120,SUM(INTER_BSC_SHO_SUCC) as ID121,CASE WHEN SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_SHO_SUCC) / SUM(INTER_BSC_SHO_ATT) * 100,4) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID128,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID129,SUM(FWD_CH_MAX_NUM)+SUM(REV_CH_MAX_NUM) as ID130,CASE WHEN SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND((SUM(FWD_CH_MAX_NUM) + SUM(REV_CH_MAX_NUM))/(SUM(FWD_CH_RLB_NUM) + SUM(REV_CH_RLB_NUM)) * 100,4) END as ID131,SUM(FWD_CH_NUM) as ID132,SUM(FWD_CH_RLB_NUM) as ID133,SUM(FWD_CH_MAX_NUM) as ID134,CASE WHEN SUM(FWD_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(FWD_CH_MAX_NUM) / SUM(FWD_CH_RLB_NUM),4) END as ID135,SUM(REV_CH_NUM) as ID136,SUM(REV_CH_RLB_NUM) as ID137,SUM(REV_CH_MAX_NUM) as ID138,CASE WHEN SUM(REV_CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(REV_CH_MAX_NUM)/SUM(REV_CH_RLB_NUM),4) END as ID139,SUM(RETX_FRM_NUM_FWD_1X) as ID140,SUM(TX_FRM_NUM_FWD_1X) as ID141,null as ID142,null as ID143,null as ID144,null as ID145,SUM(RETX_FRM_NUM_REV_1X) as ID146,SUM(TX_FRM_NUM_REV_1X) as ID147,null as ID148,CASE WHEN SUM(TX_FRM_NUM_REV_1X)=0 THEN 0 ELSE ROUND(SUM(RETX_FRM_NUM_REV_1X)/SUM(TX_FRM_NUM_REV_1X) * 100,2) END as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID160,null as ID161,SUM(FWD_CH_NUM)+SUM(REV_CH_NUM) as ID162,null as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT) * 100,2) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)),2) END as ID176,null as ID177,SUM(FWD_CH_RLB_NUM)+SUM(REV_CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
       and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0804'
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '城市' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
c.CITY_NAME as b2,'广东' as b3,c.CITY_NAME as b4,  
sum(nvl(CALL_ATT,0))+sum(nvl(DATACALLATT3G,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(ESTDATACALLS3G,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) = 0 THEN 0 WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))>=(SUM(nvl(CALL_ATT,0)) + SUM(nvl(DATACALLATT3G,0))) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)))/(SUM(CALL_ATT) + SUM(DATACALLATT3G)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0 WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))>=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,sum(DATACALLATT3G) as ID7,sum(ESTDATACALLS3G) as ID8,CASE WHEN sum(DATACALLATT3G)=0 THEN 0 WHEN sum(ESTDATACALLS3G)>=sum(DATACALLATT3G) THEN 99.99 ELSE ROUND(sum(ESTDATACALLS3G)/sum(DATACALLATT3G) * 100,2) END as ID9,SUM(nvl(SHO_TRAFFIC_CS,0)) + SUM(SHO_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(SHO_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(WALSHCODE_ERL_PS) as ID20,SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS) as ID21,SUM(WALSHCODE_ERL_PS)-SUM(SHO_TRAFFIC_PS) as ID22,CASE WHEN SUM(TRAFFIC_PS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_PS)-SUM(TRAFFIC_PS))/SUM(TRAFFIC_PS) * 100,2) END as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(DATACALLSDROP,0)) as ID24,CASE WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))<=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(DATACALLSDROP,0)))/(SUM(CALL_SETUP_SUCC_CS) + SUM(ESTDATACALLS3G)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + sum(DATACALLSDROP))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + sum(DATACALLSDROP)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,sum(DATACALLSDROP) as ID30,CASE WHEN SUM(nvl(ESTDATACALLS3G,0))=0 THEN 0 WHEN sum(DATACALLSDROP)<=0 THEN 0.01 ELSE ROUND(sum(DATACALLSDROP)/SUM(nvl(ESTDATACALLS3G,0)) * 100,2) END as ID31,CASE WHEN sum(DATACALLSDROP)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/sum(DATACALLSDROP),2) END as ID32,SUM(TCH_SETUP_ATT)+SUM(TCH_ASSIGN_ATT_HO_PS) as ID33,SUM(TCH_SETUP_SUC)+SUM(TCH_ASSIGN_SUC_HO_PS) as ID34,(SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC))+(SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS)) as ID35,CASE WHEN SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_SUC) + SUM(TCH_ASSIGN_SUC_HO_PS)) * 100,4) END as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(ESTDATACALLS3G,0)) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID39,CASE WHEN SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND((SUM(nvl(CALL_SETUP_SUCC_CS, 0))+SUM(nvl(ESTDATACALLS3G, 0)))/(SUM(O_TCH_ASSIGN_ATT) + SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100,4) END as ID40,SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID41,CASE WHEN SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT)+SUM(TCH_ASSIGN_ATT_HO_PS) -SUM(TCH_ASSIGN_SUC_HO_PS))/(SUM(TCH_SETUP_ATT) + SUM(TCH_ASSIGN_ATT_HO_PS)) * 100,4) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC)*100/SUM(TCH_SETUP_ATT),2) END as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)*100/SUM(TCH_SETUP_ATT),2) END as ID52,SUM(VOICECALLHARDHOREQ) as ID53,SUM(VOICECALLHARDHOCOMPLET) as ID54,CASE WHEN SUM(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(VOICECALLHARDHOREQ)-SUM(VOICECALLHARDHOCOMPLET))/SUM(VOICECALLHARDHOREQ) * 100,4) END as ID55,SUM(TCH_SETUP_ATT)-SUM(TCH_ASSIGN_ATT_NUM)-SUM(BSS_HHO_ATT) as ID56,SUM(TCH_SETUP_SUC)-SUM(TCH_ASSIGN_SUC)-SUM(BSS_HHO_SUC) as ID57,CASE WHEN SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(((SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) -(SUM(TCH_SETUP_SUC) - SUM(TCH_ASSIGN_SUC) - SUM(BSS_HHO_SUC))) /(SUM(TCH_SETUP_ATT) - SUM(TCH_ASSIGN_ATT_NUM) - SUM(BSS_HHO_ATT)) * 100,4) END as ID58,SUM(TCH_ASSIGN_ATT_HO_PS) as ID59,SUM(TCH_ASSIGN_SUC_HO_PS) as ID60,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID61,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_HO_PS) / SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(nvl(ESTDATACALLS3G,0)) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(ESTDATACALLS3G,0)) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(nvl(ESTDATACALLS3G, 0)) / SUM(TCH_ASSIGN_ATT_PS) * 100,4) END as ID66,SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS) as ID67,CASE WHEN SUM(TCH_ASSIGN_ATT_HO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HO_PS)-SUM(TCH_ASSIGN_SUC_HO_PS))/SUM(TCH_ASSIGN_ATT_HO_PS) * 100,4) END as ID68,SUM(DATACALLHARDHOREQ) as ID69,SUM(DATACALLHARDHOCOMPLET) as ID70,CASE WHEN SUM(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND((SUM(DATACALLHARDHOREQ)-SUM(DATACALLHARDHOCOMPLET))/SUM(DATACALLHARDHOREQ) * 100,4) END as ID71,SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ) as ID72,SUM(DATACALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTHOCOMPLET) as ID73,CASE WHEN SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(((SUM(DATACALLSOFTERHOREQ)+SUM(DATACALLSOFTHOREQ))-(SUM(DATACALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTHOCOMPLET)))/(SUM(DATACALLSOFTERHOREQ) + SUM(DATACALLSOFTHOREQ))*100,4) END as ID74,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID75,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID76,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID77,sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ) as ID78,sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET) as ID79,CASE WHEN (sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ))=0 THEN 0 ELSE ROUND((sum(VOICECALLHARDHOCOMPLET)+sum(VOICECALLSOFTHOCOMPLET)+sum(VOICECALLSOFTERHOCOMPLET)+sum(DATACALLHOCOMPLET))*100/(sum(VOICECALLHARDHOREQ) + sum(VOICECALLSOFTHOREQ) + sum(VOICECALLSOFTERHOREQ)+SUM(DATACALLHOREQ)),2) END as ID80,sum(VOICECALLHARDHOREQ) as ID81,sum(VOICECALLHARDHOCOMPLET) as ID82,CASE WHEN sum(VOICECALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLHARDHOCOMPLET)*100/sum(VOICECALLHARDHOREQ),2) END as ID83,sum(VOICECALLSOFTHOREQ) as ID84,sum(VOICECALLSOFTHOCOMPLET) as ID85,CASE WHEN sum(VOICECALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTHOCOMPLET)*100/sum(VOICECALLSOFTHOREQ),2) END as ID86,sum(VOICECALLSOFTERHOREQ) as ID87,sum(VOICECALLSOFTERHOCOMPLET) as ID88,CASE WHEN sum(VOICECALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(sum(VOICECALLSOFTERHOCOMPLET)*100/sum(VOICECALLSOFTERHOREQ),2) END as ID89,sum(DATACALLHOREQ) as ID90,sum(DATACALLHOCOMPLET) as ID91,CASE WHEN sum(DATACALLHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHOCOMPLET)/sum(DATACALLHOREQ) * 100,2) END as ID92,sum(DATACALLHARDHOREQ) as ID93,sum(DATACALLHARDHOCOMPLET) as ID94,CASE WHEN sum(DATACALLHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLHARDHOCOMPLET)/sum(DATACALLHARDHOREQ) * 100,2) END as ID95,sum(DATACALLSOFTHOREQ) as ID96,sum(DATACALLSOFTHOCOMPLET) as ID97,CASE WHEN sum(DATACALLSOFTHOREQ)=0 THEN 0 ELSE ROUND(sum(DATACALLSOFTHOCOMPLET)/sum(DATACALLSOFTHOREQ) * 100,2) END as ID98,SUM(DATACALLSOFTERHOREQ) as ID99,SUM(DATACALLSOFTERHOCOMPLET) as ID100,CASE WHEN SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND(SUM(DATACALLSOFTERHOCOMPLET)/SUM(DATACALLSOFTERHOREQ) * 100,2) END as ID101,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID102,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTRAMSCSOFTHOCOMPLET)+SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID103,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ)+SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTRAMSCSOFTHOCOMPLET) +SUM(VOICECALLSOFTERHOCOMPLET) + SUM(DATACALLSOFTERHOCOMPLET)) /(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTRAMSCSOFTHOREQ) +SUM(VOICECALLSOFTERHOREQ) + SUM(DATACALLSOFTERHOREQ)) * 100,4) END as ID104,sum(THEINTERMSCHARDHOREQ)+SUM(THEINTERMSCSOFTHOREQ) as ID105,sum(THEINTERMSCHARDHOCOMPLET)+SUM(THEINTERMSCSOFTHOCOMPLET) as ID106,CASE WHEN sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND((sum(THEINTERMSCHARDHOCOMPLET) + SUM(THEINTERMSCSOFTHOCOMPLET))/(sum(THEINTERMSCHARDHOREQ) + SUM(THEINTERMSCSOFTHOREQ)) * 100,4) END as ID107,sum(THEINTERMSCHARDHOREQ) as ID108,sum(THEINTERMSCHARDHOCOMPLET) as ID109,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID110,SUM(THEINTRAMSCSOFTHOREQ) as ID111,SUM(THEINTRAMSCSOFTHOCOMPLET) as ID112,CASE WHEN SUM(THEINTRAMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTRAMSCSOFTHOCOMPLET)/SUM(THEINTRAMSCSOFTHOREQ) * 100,2) END as ID113,SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ) as ID114,SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET) as ID115,CASE WHEN (SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ))=0 THEN 0 ELSE ROUND((SUM(VOICECALLSOFTERHOCOMPLET)+SUM(DATACALLSOFTERHOCOMPLET))/(SUM(VOICECALLSOFTERHOREQ)+SUM(DATACALLSOFTERHOREQ)) * 100,2) END as ID116,sum(THEINTERMSCHARDHOREQ) as ID117,sum(THEINTERMSCHARDHOCOMPLET) as ID118,CASE WHEN sum(THEINTERMSCHARDHOREQ)=0 THEN 0 ELSE ROUND(sum(THEINTERMSCHARDHOCOMPLET)/sum(THEINTERMSCHARDHOREQ) * 100,2) END as ID119,SUM(THEINTERMSCSOFTHOREQ) as ID120,SUM(THEINTERMSCSOFTHOCOMPLET) as ID121,CASE WHEN SUM(THEINTERMSCSOFTHOREQ)=0 THEN 0 ELSE ROUND(SUM(THEINTERMSCSOFTHOCOMPLET)/SUM(THEINTERMSCSOFTHOREQ) * 100,2) END as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,null as ID128,SUM(CH_RLB_NUM) as ID129,SUM(CH_MAX_NUM) as ID130,CASE WHEN SUM(CH_RLB_NUM)=0 THEN 0 ELSE ROUND(SUM(CH_MAX_NUM)/SUM(CH_RLB_NUM)*100,4) END as ID131,null as ID132,null as ID133,null as ID134,null as ID135,null as ID136,null as ID137,null as ID138,null as ID139,null as ID140,SUM(FWD_RLP_DATA) as ID141,SUM(FTCH_RLP_TX_1X) as ID142,sum(TOTALRLPBYTESRETRFWDTRAFFIC) as ID143,null as ID144,null as ID145,null as ID146,SUM(TOTALFRAMESTRANSRESERVETRAFFIC) as ID147,SUM(RTCH_RLP_TX_1X) as ID148,null as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,null as ID161,null as ID162,null as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT)*100,4) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)) * 100,2) END as ID176,null as ID177,SUM(CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
       and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor = 'ZY0810'
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time,c.CITY_NAME union all select '省' as b1,to_char(start_time, 'YYYY-MM-DD HH24:mi:ss') as start_time,
'广东' as b2,'广东' as b3,'广东' as b4,  
sum(nvl(CALL_ATT_CS,0))+sum(nvl(CALL_ATT_PS,0)) as ID1,sum(nvl(CALL_SETUP_SUCC_CS,0))+sum(nvl(CALL_SETUP_SUCC_PS,0)) as ID2,CASE WHEN (SUM(nvl(CALL_ATT,0)) + SUM(nvl(CALL_ATT_PS,0))) = 0 THEN 0  WHEN (SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CALL_SETUP_SUCC_PS,0)))>=(SUM(CALL_ATT) + SUM(CALL_ATT_PS)) THEN 99.99 ELSE   ROUND((SUM(nvl(CALL_SETUP_SUCC_CS,0)) + SUM(nvl(CALL_SETUP_SUCC_PS,0)))/(SUM(CALL_ATT) + SUM(CALL_ATT_PS)),4) * 100 END as ID3,SUM(nvl(CALL_ATT,0)) as ID4,SUM(nvl(CALL_SETUP_SUCC_CS,0)) as ID5,CASE WHEN SUM(nvl(CALL_ATT,0)) = 0 THEN 0  WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))>=SUM(nvl(CALL_ATT,0)) THEN 99.99 ELSE   ROUND(SUM(nvl(CALL_SETUP_SUCC_CS,0))/SUM(nvl(CALL_ATT,0)),4) * 100 END as ID6,SUM(CALL_ATT_PS) as ID7,SUM(CALL_SETUP_SUCC_PS) as ID8,case when SUM(CALL_ATT_PS) = 0  THEN 0 WHEN (SUM(CALL_SETUP_SUCC_PS))>=SUM(CALL_ATT_PS) THEN 99.99 else     ROUND((SUM(CALL_SETUP_SUCC_PS)) / (SUM(CALL_ATT_PS)) * 100,4)END as ID9,SUM(SHO_TRAFFIC_CS)+SUM(FCH_CE_TRAFFIC_PS) as ID10,SUM(nvl(TRAFFIC_CS,0))+SUM(nvl(TRAFFIC_PS,0)) as ID11,SUM(SHO_TRAFFIC_CS) as ID12,SUM(TRAFFIC_CS) as ID13,SUM(WALSHCODE_ERL) as ID14,SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS) as ID15,SUM(WALSHCODE_ERL)-SUM(SHO_TRAFFIC_CS) as ID16,CASE WHEN SUM(SHO_TRAFFIC_CS)=0 THEN 0 ELSE ROUND((SUM(SHO_TRAFFIC_CS) - SUM(TRAFFIC_CS))*100/SUM(SHO_TRAFFIC_CS),2) END as ID17,SUM(FCH_CE_TRAFFIC_PS) as ID18,SUM(TRAFFIC_PS) as ID19,SUM(FCH_WALSHCODE_TRAFFIC_PS) as ID20,SUM(FCH_CE_TRAFFIC_PS) - SUM(TRAFFIC_PS) as ID21,SUM(FCH_WALSHCODE_TRAFFIC_PS)-SUM(FCH_CE_TRAFFIC_PS) as ID22,case when SUM(TRAFFIC_PS) = 0  THEN 0 else ROUND((SUM(FCH_CE_TRAFFIC_PS) - SUM(TRAFFIC_PS)) / SUM(TRAFFIC_PS)*100,4)END as ID23,SUM(nvl(TCH_DROP_NUM,0))+SUM(nvl(TCH_DROP_PS,0)) as ID24,CASE WHEN (SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(TCH_SETUP_SUCC_PS,0))) = 0 THEN 0 WHEN (SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(TCH_DROP_PS,0)))<=0 THEN 0.01 ELSE   ROUND((SUM(nvl(TCH_DROP_NUM,0)) + SUM(nvl(TCH_DROP_PS,0)))/(SUM(TCH_ASSIGN_SUC) + SUM(TCH_SETUP_SUCC_PS)),4) * 100 END as ID25,CASE WHEN (SUM(TCH_DROP_NUM) + SUM(TCH_DROP_PS))=0 THEN 0 ELSE ROUND((SUM(TRAFFIC_CS)+SUM(TRAFFIC_PS))*60/(SUM(TCH_DROP_NUM) + SUM(TCH_DROP_PS)),2) END as ID26,SUM(TCH_DROP_NUM) as ID27,CASE WHEN SUM(nvl(TCH_ASSIGN_SUC,0)) = 0 THEN 0 WHEN SUM(nvl(TCH_DROP_NUM,0))<=0 THEN 0.01 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(TCH_ASSIGN_SUC),4) * 100 END as ID28,CASE WHEN SUM(TCH_DROP_NUM)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_CS)*60/SUM(TCH_DROP_NUM),2) END as ID29,SUM(TCH_DROP_PS) as ID30,CASE WHEN SUM(TCH_SETUP_SUCC_PS)=0 THEN 0 WHEN SUM(TCH_DROP_PS)<=0 THEN 0.01 ELSE ROUND(SUM(TCH_DROP_PS) / SUM(TCH_SETUP_SUCC_PS) * 100, 2) END  as ID31,CASE WHEN SUM(TCH_DROP_PS)=0 THEN 0 ELSE ROUND(SUM(TRAFFIC_PS)*60/SUM(TCH_DROP_PS),2) END as ID32,SUM(TCH_SETUP_ATT) as ID33,SUM(TCH_SETUP_SUC) as ID34,SUM(TCH_SETUP_ATT)-SUM(TCH_SETUP_SUC) as ID35,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END  as ID36,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS) as ID37,SUM(nvl(TCH_ASSIGN_SUC,0)) + SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID38,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC)+SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID39,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS))=0 THEN 0 ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC)+SUM(nvl(TCH_SETUP_SUCC_PS,0))) /(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT)+SUM(TCH_ASSIGN_ATT_PS)) * 100, 4) END  as ID40,SUM(TCH_BLOCK_COUNT)+ (SUM(CALL_ATT_PS)-sum(CALL_SETUP_SUCC_PS)) as ID41,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND((SUM(TCH_BLOCK_COUNT)+ (SUM(CALL_ATT_PS)-sum(CALL_SETUP_SUCC_PS)))/SUM(TCH_SETUP_ATT)*100,2) END as ID42,SUM(TCH_SETUP_ATT) as ID43,SUM(TCH_SETUP_SUC) as ID44,SUM(TCH_SETUP_ATT) - SUM(TCH_SETUP_SUC) as ID45,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0 ELSE ROUND(SUM(TCH_SETUP_SUC) /SUM(TCH_SETUP_ATT) * 100, 4) END  as ID46,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) as ID47,SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC) as ID48,SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) - SUM(P_TCH_ASSIGN_SUC)-SUM(O_TCH_ASSIGN_SUC) as ID49,CASE WHEN (SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ) = 0 THEN 0   ELSE ROUND((SUM(P_TCH_ASSIGN_SUC)+SUM(O_TCH_ASSIGN_SUC))/(SUM(O_TCH_ASSIGN_ATT)+SUM(P_TCH_ASSIGN_ATT) ), 4)*100 END as ID50,SUM(TCH_BLOCK_COUNT) as ID51,CASE WHEN SUM(TCH_SETUP_ATT) = 0 THEN 0   ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT),4)*100 END as ID52,SUM(TCH_ASSIGN_ATT_HHO_CS) as ID53,SUM(TCH_ASSIGN_SUC_HHO_CS) as ID54,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_CS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_CS)-SUM(TCH_ASSIGN_SUC_HHO_CS))/SUM(TCH_ASSIGN_ATT_HHO_CS) * 100, 2) END as ID55,SUM(TCH_ASSIGN_ATT_SHO_CS) as ID56,SUM(TCH_ASSIGN_SUC_SHO_CS) as ID57,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_CS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_CS)-SUM(TCH_ASSIGN_SUC_SHO_CS))/SUM(TCH_ASSIGN_ATT_SHO_CS) * 100, 2) END as ID58,SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS) as ID59,SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS) as ID60,SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)-(SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS)) as ID61,CASE WHEN (SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS))=0 THEN 0 ELSE ROUND((SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS))/(SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)) * 100, 4) END  as ID62,SUM(TCH_ASSIGN_ATT_PS) as ID63,SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID64,SUM(TCH_ASSIGN_ATT_PS)-SUM(nvl(TCH_SETUP_SUCC_PS,0)) as ID65,CASE WHEN SUM(TCH_ASSIGN_ATT_PS)=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_SETUP_SUCC_PS,0))/SUM(TCH_ASSIGN_ATT_PS) * 100, 4) END  as ID66,SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)-(SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS)) as ID67,CASE WHEN (SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS))=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)-(SUM(nvl(TCH_SETUP_SUCC_PS,0))+SUM(TCH_ASSIGN_SUC_HHO_PS)+SUM(TCH_ASSIGN_SUC_SHO_PS)))/(SUM(TCH_ASSIGN_ATT_PS)+SUM(TCH_ASSIGN_ATT_HHO_PS)+SUM(TCH_ASSIGN_ATT_SHO_PS)) * 100, 4) END  as ID68,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID69,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID70,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_HHO_PS)-SUM(TCH_ASSIGN_SUC_HHO_PS))/SUM(TCH_ASSIGN_ATT_HHO_PS)* 100, 2) END   as ID71,SUM(TCH_ASSIGN_ATT_SHO_PS) as ID72,SUM(TCH_ASSIGN_SUC_SHO_PS) as ID73,CASE WHEN SUM(TCH_ASSIGN_ATT_SHO_PS)=0 THEN 0 ELSE ROUND((SUM(TCH_ASSIGN_ATT_SHO_PS)-SUM(TCH_ASSIGN_SUC_SHO_PS))/SUM(TCH_ASSIGN_ATT_SHO_PS)* 100, 2) END   as ID74,SUM(INNER_BSC_HHO_ATT) + SUM(INNER_BSC_SHO_ATT)  + SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT) as ID75,SUM(INNER_BSC_HHO_SUCC) + SUM(INNER_BSC_SHO_SUCC) + SUM(INTER_BSC_HHO_SUCC) + SUM(INTER_BSC_SHO_SUCC) as ID76,CASE WHEN (SUM(INNER_BSC_HHO_ATT) + SUM(INNER_BSC_SHO_ATT)  + SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC) + SUM(INNER_BSC_SHO_SUCC) + SUM(INTER_BSC_HHO_SUCC) + SUM(INTER_BSC_SHO_SUCC))/(SUM(INNER_BSC_HHO_ATT) + SUM(INNER_BSC_SHO_ATT)  + SUM(INTER_BSC_HHO_ATT) + SUM(INTER_BSC_SHO_ATT))*100,2) END as ID77,SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT) as ID78,SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC) as ID79,CASE WHEN (SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)) = 0 THEN 0 ELSE  ROUND( (SUM(BSS_HHO_SUC)+SUM(S_SHO_SUC))/(SUM(BSS_HHO_ATT)+ SUM(S_SHO_ATT)), 3) * 100 END as ID80,SUM(BSS_HHO_ATT) as ID81,SUM(BSS_HHO_SUC) as ID82,CASE WHEN SUM(BSS_HHO_ATT) = 0 THEN 0 ELSE  ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT),4) * 100 END as ID83,SUM(S_SHO_ATT) as ID84,SUM(S_SHO_SUC) as ID85,CASE WHEN (SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)) = 0 THEN 0 ELSE  ROUND((SUM(S_SHO_SUC)-SUM(S_SSHO_SUC))/(SUM(S_SHO_ATT)-SUM(S_SSHO_ATT)),4) * 100 END as ID86,SUM(S_SSHO_ATT) as ID87,SUM(S_SSHO_SUC) as ID88,CASE WHEN SUM(S_SSHO_ATT) = 0 THEN 0 ELSE ROUND(SUM(S_SSHO_SUC) / SUM(S_SSHO_ATT),4)*100 END as ID89,null as ID90,null as ID91,null as ID92,SUM(TCH_ASSIGN_ATT_HHO_PS) as ID93,SUM(TCH_ASSIGN_SUC_HHO_PS) as ID94,CASE WHEN SUM(TCH_ASSIGN_ATT_HHO_PS)=0 THEN 0 ELSE ROUND(SUM(TCH_ASSIGN_SUC_HHO_PS) / SUM(TCH_ASSIGN_ATT_HHO_PS),4)*100 END as ID95,null as ID96,null as ID97,null as ID98,null as ID99,null as ID100,null as ID101,SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INTRA_BS_SSHO_ATT_NUM) as ID102,SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INTRA_BS_SSHO_SUC_NUM) as ID103,CASE WHEN (SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INTRA_BS_SSHO_ATT_NUM))=0 THEN 0 ELSE ROUND((SUM(INNER_BSC_HHO_SUCC)+SUM(INNER_BSC_SHO_SUCC)+SUM(INTRA_BS_SSHO_SUC_NUM))/(SUM(INNER_BSC_HHO_ATT)+SUM(INNER_BSC_SHO_ATT)+SUM(INTRA_BS_SSHO_ATT_NUM))* 100, 4) END  as ID104,SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT) as ID105,SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC) as ID106,CASE WHEN (SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))=0 THEN 0 ELSE ROUND((SUM(INTER_BSC_HHO_SUCC)+SUM(INTER_BSC_SHO_SUCC))/(SUM(INTER_BSC_HHO_ATT)+SUM(INTER_BSC_SHO_ATT))* 100, 4) END as ID107,SUM(INNER_BSC_HHO_ATT) as ID108,SUM(INNER_BSC_HHO_SUCC) as ID109,CASE WHEN SUM(INNER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_HHO_SUCC)/SUM(INNER_BSC_HHO_ATT)* 100, 4) END  as ID110,SUM(INNER_BSC_SHO_ATT) as ID111,SUM(INNER_BSC_SHO_SUCC) as ID112,CASE WHEN SUM(INNER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INNER_BSC_SHO_SUCC)/SUM(INNER_BSC_SHO_ATT)* 100, 4) END  as ID113,SUM(INTRA_BS_SSHO_ATT_NUM) as ID114,SUM(INTRA_BS_SSHO_SUC_NUM) as ID115,CASE WHEN SUM(INTRA_BS_SSHO_ATT_NUM)=0 THEN 0 ELSE ROUND(SUM(INTRA_BS_SSHO_SUC_NUM)/SUM(INTRA_BS_SSHO_ATT_NUM)* 100, 4) END  as ID116,SUM(INTER_BSC_HHO_ATT) as ID117,SUM(INTER_BSC_HHO_SUCC) as ID118,CASE WHEN SUM(INTER_BSC_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_HHO_SUCC)/SUM(INTER_BSC_HHO_ATT)* 100, 4) END  as ID119,SUM(INTER_BSC_SHO_ATT) as ID120,SUM(INTER_BSC_SHO_SUCC) as ID121,CASE WHEN SUM(INTER_BSC_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(INTER_BSC_SHO_SUCC)/SUM(INTER_BSC_SHO_ATT)* 100, 4) END  as ID122,null as ID123,null as ID124,null as ID125,null as ID126,null as ID127,SUM(CH_CFG_NUM) as ID128,SUM(CH_RLB_NUM) as ID129,SUM(FWD_CH_MAX_NUM)+SUM(REV_CH_MAX_NUM) as ID130,CASE WHEN SUM(CH_RLB_NUM)=0 THEN 0 ELSE ROUND((SUM(FWD_CH_MAX_NUM) + SUM(REV_CH_MAX_NUM)) / SUM(CH_RLB_NUM) * 100,4) END as ID131,null as ID132,SUM(FWD_CH_RLB_NUM) as ID133,SUM(FWD_CH_MAX_NUM) as ID134,SUM(FWD_TCH_MAX_OCCU_RATE) as ID135,null as ID136,SUM(REV_CH_RLB_NUM) as ID137,SUM(REV_CH_MAX_NUM) as ID138,SUM(REV_TCH_MAX_OCCU_RATE) as ID139,SUM(RETX_FRM_NUM_FWD_1X) as ID140,SUM(FRM_NUM_FWD_1X) as ID141,SUM(DATA_THROUGHPUT_FWD_1X) as ID142,SUM(FTCH_RLP_RETX_BYTE_1X) as ID143,null as ID144,CASE WHEN SUM(DATA_THROUGHPUT_FWD_1X)=0 THEN 0 ELSE ROUND(SUM(FTCH_RLP_RETX_BYTE_1X)/(1024*SUM(DATA_THROUGHPUT_FWD_1X))* 100, 4) END  as ID145,SUM(RETX_FRM_NUM_REV_1X) as ID146,SUM(TX_FRM_NUM_REV_1X) as ID147,SUM(DATA_THROUGHPUT_REV_1X) as ID148,CASE WHEN SUM(TX_FRM_NUM_REV_1X)=0 THEN 0 ELSE ROUND(SUM(RETX_FRM_NUM_REV_1X)/SUM(TX_FRM_NUM_REV_1X)* 100, 4) END  as ID149,null as ID150,null as ID151,null as ID152,null as ID153,null as ID154,null as ID155,null as ID156,null as ID157,null as ID158,null as ID159,null as ID160,null as ID161,SUM(CH_CFG_NUM) as ID162,null as ID163,CASE WHEN SUM( nvl(TRAFFIC_CS,0)) = 0 THEN 0 ELSE      ROUND(SUM(nvl(SHO_TRAFFIC_CS,0) - nvl(TRAFFIC_CS,0))/SUM(nvl(TRAFFIC_CS,0)),4) * 100     END  as ID164,null as ID165,CASE WHEN SUM(TCH_SETUP_ATT)=0 THEN 0 ELSE ROUND(SUM(TCH_BLOCK_COUNT)/SUM(TCH_SETUP_ATT)*100,4) END as ID166,null as ID167,null as ID168,null as ID169,null as ID170,null as ID171,CASE WHEN SUM(BSS_HHO_ATT)=0 THEN 0 ELSE ROUND(SUM(BSS_HHO_SUC)/SUM(BSS_HHO_ATT) * 100,2) END as ID172,CASE WHEN SUM(S_SHO_ATT)=0 THEN 0 ELSE ROUND(SUM(S_SHO_SUC)/SUM(S_SHO_ATT) * 100,2) END as ID173,CASE WHEN (SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/(SUM(O_TCH_ASSIGN_SUC)+SUM(P_TCH_ASSIGN_SUC)) * 100,2) END as ID174,CASE WHEN SUM(nvl(CALL_SETUP_SUCC_CS,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TCH_DROP_NUM,0))/SUM(nvl(CALL_SETUP_SUCC_CS,0)) * 100,2) END as ID175,CASE WHEN SUM(nvl(TCH_DROP_NUM,0))=0 THEN 0 ELSE ROUND(SUM(nvl(TRAFFIC_CS,0))*60/SUM(nvl(TCH_DROP_NUM,0)) * 100,2) END as ID176,null as ID177,SUM(CH_RLB_NUM) as ID178,SUM(TCH_BLOCK_COUNT) as ID179,SUM(nvl(SHO_TRAFFIC_CS,0)) as ID180,SUM(nvl(TRAFFIC_CS,0)) as ID181,SUM(WALSHCODE_ERL) as ID182,null as ID183,null as ID184,null as ID185,null as ID186,null as ID187,null as ID188,null as ID189,null as ID190,null as ID191,null as ID192,SUM(O_TCH_ASSIGN_ATT) as ID193,SUM(O_TCH_ASSIGN_SUC) as ID194,SUM(P_TCH_ASSIGN_ATT) as ID195,SUM(P_TCH_ASSIGN_SUC) as ID196,SUM(TCH_ASSIGN_ATT) as ID197,SUM(TCH_ASSIGN_SUC) as ID198,SUM(TCH_SETUP_ATT) as ID199,SUM(TCH_SETUP_SUC) as ID200,SUM(BSS_HHO_ATT) as ID201,SUM(BSS_HHO_SUC) as ID202,SUM(S_SHO_ATT) as ID203,SUM(S_SHO_SUC) as ID204,SUM(nvl(TCH_DROP_NUM,0)) as ID205,SUM(CALL_ATT) as ID206,null as ID207,null as ID208,null as ID209,null as ID210,null as ID211 
from perf_bsc_c c, cfg_bsc_map_city b,cfg_city d
where c.ne_sys_id = b.ne_bsc_id
and start_time >= to_date('2011-05-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
and start_time <= to_date('2011-05-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS') 
and c.vendor in ('ZY0808','ZY0804','ZY0810')
and b.city_id=d.city_id
and c.CITY_ID=d.city_id
group by start_time) where b2 is not null ORDER BY START_TIME, B1

--资源类
  select '城市' as b1,start_time,
                                                  c.CITY_NAME as b2,  
                                                  SUM(BTS_283_NUM) as ID1,SUM(BTS_201_NUM) as ID2,SUM(BTS_242_NUM) as ID3,SUM(BTS_160_NUM) as ID4,SUM(ONEX_CARR_TOTAL_NUM) as ID5,SUM(ONEX_BTS_TOTAL_NUM) as ID6,SUM(ONEX_1CARR_BTS_NUM) as ID7,SUM(ONEX_2CARR_BTS_NUM) as ID8,SUM(ONEX_3CARR_BTS_NUM) as ID9,SUM(ONEX_4CARR_BTS_NUM) as ID10,SUM(ONEX_CELL_TOTAL_NUM) as ID11,SUM(ONEX_1CARR_CELL_NUM) as ID12,SUM(ONEX_2CARR_CELL_NUM) as ID13,SUM(ONEX_3CARR_CELL_NUM) as ID14,SUM(ONEX_4CARR_CELL_NUM) as ID15,SUM(WIRELESS_CAPACITY) as ID16,CASE WHEN SUM(WIRELESS_CAPACITY)=0 THEN 0 ELSE ROUND(SUM(nvl(SHO_TRAFFIC_CS,0))/SUM(WIRELESS_CAPACITY)*100,4) END as ID17,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID18,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(BUSY_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID19,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(IDLE_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID20,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(EX_OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID21,CASE WHEN SUM(ONEX_BTS_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(OVERFLOW_BTS_NUM)/SUM(ONEX_BTS_TOTAL_NUM)*100,4) END as ID22,CASE WHEN SUM(ONEX_CELL_TOTAL_NUM)=0 THEN 0 ELSE ROUND(SUM(ABNORMAL_SECTOR_NUM)/SUM(ONEX_CELL_TOTAL_NUM)*100,4) END as ID23,SUM(TRAFFIC_283) as ID24,SUM(TRAFFIC_201) as ID25,SUM(TRAFFIC_242) as ID26,SUM(TRAFFIC_160) as ID27,SUM(EX_BUSY_SECTOR_NUM) as ID28,SUM(BUSY_SECTOR_NUM) as ID29,SUM(IDLE_SECTOR_NUM) as ID30,SUM(ABNORMAL_SECTOR_NUM) as ID31,SUM(EX_OVERFLOW_BTS_NUM) as ID32,SUM(OVERFLOW_BTS_NUM) as ID33 
                                            from perf_bsc_resource c, cfg_bsc_map_city b,cfg_city d
                                            where c.ne_sys_id = b.ne_bsc_id
                                            and start_time >= to_date('2011-5-19 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                                            and start_time <= to_date('2011-5-19 23:59:59', 'YYYY-MM-DD HH24:MI:SS')                                              
                                            and b.city_id=d.city_id
                                            and c.CITY_ID=d.city_id
                                            group by start_time,c.CITY_NAME
                                            group by start_time,c.CITY_NAME